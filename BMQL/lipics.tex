
\documentclass[a4paper,UKenglish,cleveref, autoref, thm-restate]{lipics-v2021}
%This is a template for producing LIPIcs articles. 
%See lipics-v2021-authors-guidelines.pdf for further information.
%for A4 paper format use option "a4paper", for US-letter use option "letterpaper"
%for british hyphenation rules use option "UKenglish", for american hyphenation rules use option "USenglish"
%for section-numbered lemmas etc., use "numberwithinsect"
%for enabling cleveref support, use "cleveref"
%for enabling autoref support, use "autoref"
%for anonymousing the authors (e.g. for double-blind review), add "anonymous"
%for enabling thm-restate support, use "thm-restate"
%for enabling a two-column layout for the author/affilation part (only applicable for > 6 authors), use "authorcolumns"
%for producing a PDF according the PDF/A standard, add "pdfa"

%\graphicspath{{./graphics/}}%helpful if your graphic files are in another directory

\bibliographystyle{plainurl}% the mandatory bibstyle

%\usepackage{fontspec}  
\usepackage[utf8]{inputenc}
%\usepackage[english]{babel}
%\usepackage[mathcal]{euscript}
\usepackage{mathrsfs}  
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{mathrsfs}  
\usepackage{amssymb}
%\usepackage[left=2cm,right=2cm,top=2cm,bottom=2cm]{geometry}
\usepackage{stmaryrd}
\usepackage{graphicx,float}
\usepackage{mathtools}
\usepackage{pgfplots}
\usepackage{xfrac}
\usepackage{listings}
\usepackage{xcolor}
%\usepackage{lstlinebgrd}
\usepackage{ebproof}
\usepackage{graphicx}
\usepackage{braket}
%\usepackage[colorlinks=true, linkcolor=cyan, urlcolor=cyan, citecolor=cyan]{hyperref}
%\usepackage[shortlabels]{enumitem}
\usepackage{todonotes}
\input{macros}
\usepackage{tcolorbox}
\usepackage{quantikz}
\usepackage{tikz-cd}


\title{On the Additive Structure of Quantalic $\lambda$-Calculus} %TODO Please add

\titlerunning{On the Additive Structure of Quantalic $\lambda$-calculus} %TODO optional, please use if title is longer than one line

\author{Bruna Salgado}{University of Minho and INESC-TEC, Portugal }{johnqpublic@dummyuni.org}{https://orcid.org/0000-0002-1825-0097}{}%TODO mandatory, please use full name; only 1 author per \author macro; first two parameters are mandatory, other parameters can be empty. Please provide at least the name of the affiliation and the country. The full address is optional

\author{Renato Neves}{University of Minho and INESC-TEC, Portugal}{nevrenato@di.uminho.pt}{https://orcid.org/0000-0002-8787-2551}{}

\authorrunning{Bruna Salgado and Renato Neves} %TODO mandatory. First: Use abbreviated first/middle names. Second (only in severe cases): Use first author plus 'et al.'

\Copyright{Bruna Salgado and Renato Neves} %TODO mandatory, please use full first names. LIPIcs license is "CC-BY";  http://creativecommons.org/licenses/by/3.0/

\ccsdesc[500]{Theory of computation~Logic}

\keywords{Categorical logic, $\lambda$-calculus, probabilistic programming} %TODO mandatory; please add comma-separated list of keywords

\category{} %optional, e.g. invited paper

\relatedversion{} %optional, e.g. full version hosted on arXiv, HAL, or other respository/website
%\relatedversiondetails[linktext={opt. text shown instead of the URL}, cite=DBLP:books/mk/GrayR93]{Classification (e.g. Full Version, Extended Version, Previous Version}{URL to related version} %linktext and cite are optional

%\supplement{}%optional, e.g. related research data, source code, ... hosted on a repository like zenodo, figshare, GitHub, ...
%\supplementdetails[linktext={opt. text shown instead of the URL}, cite=DBLP:books/mk/GrayR93, subcategory={Description, Subcategory}, swhid={Software Heritage Identifier}]{General Classification (e.g. Software, Dataset, Model, ...)}{URL to related version} %linktext, cite, and subcategory are optional

\funding{
This work is financed by National Funds through FCT - Fundação para a Ciência e a Tecnologia, I.P. (Portuguese Foundation for Science and Technology) within the project IBEX, with reference 10.54499/PTDC/CCI-COM/4280/2021.
}%optional, to capture a funding statement, which applies to all authors. Please enter author specific funding statements as fifth argument of the \author macro.

%\acknowledgements{I want to thank \dots}%optional

%\nolinenumbers %uncomment to disable line numbering

%\hideLIPIcs  %uncomment to remove references to LIPIcs series (logo, DOI, ...), e.g. when preparing a pre-final version to be uploaded to arXiv or another public repository

%Editor-only macros:: begin (do not touch as author)%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\EventEditors{John Q. Open and Joan R. Access}
\EventNoEds{2}
\EventLongTitle{42nd Conference on Very Important Topics (CVIT 2016)}
\EventShortTitle{CVIT 2016}
\EventAcronym{CVIT}
\EventYear{2016}
\EventDate{December 24--27, 2016}
\EventLocation{Little Whinging, United Kingdom}
\EventLogo{}
\SeriesVolume{42}
\ArticleNo{23}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}

\maketitle

%TODO mandatory: add short abstract of the document
\begin{abstract}

This work aims at extending quantalic linear $\lambda$-calculus with additive
structure. The focus here will be on the additive disjunction operator $\oplus$
for it closes an important gap in previous work: the lack of methods for
reasoning about `case' statements  quantitatively, fundamental across a myriad
of computational paradigms. 

Among other things, we extend the associated quantalic equational system to
encompass the additive operator $\oplus$. We show that the extension is sound
and (approximately) complete. We then briefly illustrate its use in
probabilistic programming.

\end{abstract}

\section{Introduction}
\label{sec:intro}

Previous work~\cite{dahlqvist22,dahlqvist2023syntactic} introduced a quantalic
generalisation of linear $\lambda$-calculus, \ie\ the exponential-free,
\emph{multiplicative} fragment of linear logic. Here we start exploring how to
add \emph{additive} structure to this body of work -- more specifically we will
focus on the additive disjunction operator $\oplus$ which gives rise to `case'
statements (\ie\ conditionals) and it is typically interpreted via coproducts.
Our motivation for it is very practical: in trying to reason quantitatively
about higher-order programs we almost always fell short when these involved
conditionals. Of course applications involving $\oplus$ are broader than this. For
example, the extension here proposed can be used to reason about co-Cartesian
categories enriched over so-called `generalised metric spaces'~\cite{paseka00}.

Remarkably a number of important results already considered additive structure
in the quantalic setting, even if sometimes implicitly. For example
references~\cite{mardare2016quantitative,mardare2017axiomatizability,mio24,jurka24}
are framed in the setting of universal algebra and thus involve additive
conjunction (\ie\ $\&$) which is interpreted via products. In the setting of
$\lambda$-calculus, reference~\cite{lago22} considers the case of additive
conjunction being left adjoint to implication (interpreted via
Cartesian-closedness), with a series of interesting negative results emerging
from this.  Our work is orthogonal to these in that we study the dual of $\&$
(\ie\ $\oplus$) and furthermore we assume the left adjoint of implication
to be multiplicative conjunction (\ie\ $\otimes$) instead of the additive one. This
makes the negative results discussed in~\cite{lago22} disappear.


%However, none of these approaches reason about distances within a quantitative
%equational system. In this regard, our work is more closely related to the
%framework of metric universal algebra developed
%in~\cite{mardare2016quantitative, mardare2017axiomatizability}. More recently,
%\cite{PDFQuantitativeMonoidal2025} proposed a quantitative framework for
%diagrammatic calculi, in which one can axiomatise notions of distance between
%string diagrams using $\mathcal{V}$-quantitative equations.

In this note we extend the quantalic equational system
of~\cite{dahlqvist22,dahlqvist2023syntactic} to encompass the additive operator
$\oplus$. We show that the extension is both sound and complete. We also show
that if the well-known Archimedean rule is dropped one still has approximate
completeness. We then briefly illustrate our extended framework at work in the
setting of probabilistic programming~\cite{dahlqvist19,barthe20}. We will focus
specifically on reasoning about Cauchy sequences of higher-order probabilistic
programs, thus emphasising the recent shift from ``seeing program semantics as
the science of program equivalence''~\cite{lago22} to quantitative
scientific concepts, involving functional analysis and beyond.

%if we drop the well-known work
%of~\cite{dahlqvist2023syntactic} by introducing a metric equation for
%conditionals and proving its soundness and completeness for enriched
%distributive symmetric monoidal (closed) categories over metric spaces. We then
%explore a suitable model for reasoning about approximate equivalence in
%probabilistic computation, showing that it forms an enriched distributive
%symmetric monoidal closed category over metric spaces. 

%%Finally, we
%show that the category $\catQ$, introduced in \cite{selinger04} provides
%denotational semantics for the first-order functional quantum programming
%language QPL, is a suitable candidate.
%%discuss potential models for quantum computation, 


% we explore a couple quanum models a a probabilistic one, proving they are proper models to reason about program equivalence



\section{Quantalic $\lambda$-calculus with additive disjunction }

The extension of linear $\lambda$-calculus
in~\cite{dahlqvist22,dahlqvist2023syntactic} with additive disjunction is quite
simple. The grammar of types is given by,
\begin{equation*} \label{eq:grammartypes}
   \typeA ::= X \in G \mid \typeI \mid \typeA  \otimes \typeA \mid \typeA
   \oplus \typeA \mid \typeA \multimap  \typeA
\end{equation*}
where $G$ is a set of ground types, and the judgement formation rules
concerning $\oplus$ are those in \autoref{fig:typing_rules_cond}. 
\begin{figure}[H]
    \begin{equation*}
            \hspace{60pt}
    \begin{prooftree}
        \hypo{\Gamma \vljud v: \typeA}
        \infer1[(inl)]{\Gamma \vljud \inl_{\typeB}(v): \typeA \oplus \typeB}
    \end{prooftree}
    %
    \hspace{30pt}
    %
    \begin{prooftree}
        \hypo{\Gamma \vljud v: \typeB}
        \infer1[(inr)]{\Gamma \vljud \inr_{\typeA}(v): \typeA \oplus \typeB}
    \end{prooftree} 
    %
    \end{equation*}
    \begin{equation*}
            \hspace{30pt}
    %
    \begin{prooftree}
        \hypo{\Gamma \vljud v: \typeA \oplus \typeB}
        \hypo{\Delta, x: \typeA \vljud w: \typeD}
        \hypo{\Delta, y: \typeB \vljud u: \typeD}
        \hypo{E \in \Shuff(\Gamma; \Delta)}
        \infer4[(case)]{E \vljud \text{case } v\,
        \{\inl_{\typeB}(x) 
            \Rightarrow w ; \,
          \inr_{\typeA}(y) \Rightarrow u
        \}: \typeD}
    \end{prooftree}
    %
    \end{equation*}
    \caption{Judgement formation rules for the additive operator $\oplus$.}
    \label{fig:typing_rules_cond}
\end{figure}
It is laborious but straightforward to prove that the extended calculus
inherits desirable features from the calculus
in~\cite{dahlqvist22,dahlqvist2023syntactic}. Most notably it inherits the
\emph{unique derivation}, \emph{substitution}, and \emph{exchange} properties.
These are key in our framework and rely on a shuffling mechanism whose details
can be consulted in~\cite{dahlqvist22,dahlqvist2023syntactic,shulman19}. This
mechanism can actually be briefly glanced in \autoref{fig:typing_rules_cond},
rule (case), where we stipulate that context $E$ is a \emph{shuffle} (Sf) of
the contexts $\Gamma$ and $\Delta$: \ie\ a permutation of the variables in
$\Gamma,\Delta$ which preserves their relative order in $\Gamma$ and $\Delta$.


Next, in order to extend the quantalic equational system
in~\cite{dahlqvist22,dahlqvist2023syntactic} with additive disjunction let us
introduce notation and some basic properties about quantales.  Let
$\mathcal{V}$ denote a commutative and unital quantale, $\otimes : \mathcal{V}
\times \mathcal{V} \to \mathcal{V}$ the corresponding binary operation, and $k$
the corresponding unit~\cite{paseka00}.  The following (domain-theoretic)
definitions are useful not only for computational reasons, but also for
formulating our `approximate completeness' result.
\begin{definition}
	Consider a complete lattice $L$.  For every $x, y \in L$ we say that
	$y$ is \emph{way-below} $x$ (in symbols, $y \ll x$) if for every
	subset $X \subseteq L$ whenever $x \leq \bigvee X$ there exists a
	\emph{finite} subset $A \subseteq X$ such that $y \leq \bigvee A$.
	The lattice $L$ is called \emph{continuous} iff for every $x \in L$,
	\begin{flalign*}
		x = \bigvee \{ y  \mid y \in L\ \text{and} \ y \ll x \}
	\end{flalign*}
\end{definition}

\begin{definition}
	Let $L$ be a complete lattice. A \emph{basis} $B$ of $L$ is a subset
	$B \subseteq L$ such that for every $x \in L$ the set
	$B \cap \{ y \mid y \in L\ \text{and} \ y \ll x \}$ is directed and
	has $x$ as the least upper bound.
\end{definition}
We assume that the underlying lattice of $\mathcal{V}$ is continuous and has a
basis $B \ni k$ closed under finite joins and the multiplication of the
quantale $\otimes$. As explained in~\cite{dahlqvist22,dahlqvist2023syntactic},
these assumptions allow us to work \emph{only} with a specified subset of the
elements of the quantale which might be easier to handle in specific contexts
for a variety of reasons.  We also assume that $\mathcal{V}$ is
\emph{integral}, \ie\ that the unit $k$ is the top element of $\mathcal{V}$, a
common assumption in quantale theory~\cite{velebil19}. Several examples of
quantales that satisfy these constraints are presented
in~\cite{dahlqvist22,dahlqvist2023syntactic}. Here we mention only the case of
the metric quantale, since we use it in our illustration of probabilistic
programming. Typically the basis $B$ that is chosen for this particular case is
that of rational numbers.  Finaly, our extended quantalic system crucially
relies on the following observation.  Since every quantale $\mathcal{V}$ is a
cocomplete category (specifically a complete sup-lattice) it will be complete
as well~\cite[Section 12]{cats} -- in other words, it has all infima
$\bigwedge$. 

We ready to present our quantalic equational system extended to additive
disjunction $\oplus$.  Recall that in the original system equations are
labelled by elements $q \in B \subseteq \mathcal{V}$ of the quantale, and that
`classical' equations $v = w$ are represented by $v =_k w$ together with $w =_k
v$. The extended system now incorporates the rules presented in
Figure~\ref{fig:equations-in-context-cond}. The equations on top of the dotted
line are those already known for additive disjunction in the classical setting
(see for example~\cite{croleCategoriesTypes1994}). The ones on the bottom are
new and serve as a form of `quantalic congruence'.

  \begin{figure}[h!]
    \begin{equation*}
            \hspace{30pt}
        \begin{split}
          &(\beta_{case}^{inl}) \hspace{3pt} \text{case } 
          \inl_{\typeB}(v)\, \{ \inl_{\typeB} (x) \Rightarrow w 
          ;\, \inr_{\typeA} (y) 
          \Rightarrow u\}= w[v/x]
          %
          \\
          %
          &(\beta_{case}^{inr}) \hspace{3pt} \text{case } 
          \inr_{\typeA}(v)\, \{ \inl_{\typeB} (x) \Rightarrow w 
          ;\, \inr_{\typeA} (y) 
          \Rightarrow u\}= u[v/y]
          %
          \\
          %
          %
          & (\eta_{case}) \hspace{3pt} \text{case } v\, \{\text{inl}_{\typeB} (y) \Rightarrow w [ \text{inl}_{\typeB}(y)/x] ;\, \text{inr}_{\typeA} (z) \Rightarrow w [ \text{inr}_{\typeA}(z)/x]\} = w[v/x] 
        \end{split}
    \end{equation*}
    %
    \noindent\dotfill{}
    %
    \begin{equation*}
            \hspace{75pt}
            \begin{prooftree}
                    \hypo{ v =_q w}
                    \infer1[]{\inl_\typeB(v) =_q \inl_\typeB(w)}
            \end{prooftree}
            \hspace{40pt}
            \begin{prooftree}
                    \hypo{ v =_q w}
                    \infer1[]{\inr_\typeA(v) =_q \inl_\typeA(w)}
            \end{prooftree}
    \end{equation*}
    \begin{equation*}
    \hspace{20pt}
   \begin{prooftree}
      \hypo{ v =_{q} v' }
      \hypo{w=_{r} w'}
      \hypo{u=_{s}u'}
      \infer3[]{\text{ case } v \,   \{\text{inl} (x) \Rightarrow w ; \, \text{inr} (y) \Rightarrow u\} =_{q\otimes(r \wedge s)} \text{ case } v' \,  \{\text{inl} (x) \Rightarrow w' ; \,\text{inr} (y) \Rightarrow u'\} }
  \end{prooftree}
    \end{equation*}
    \caption{Quantalic equational system for additive disjunction.}
    \label{fig:equations-in-context-cond}
    \end{figure}
\section{Categorical semantics}
\begin{definition}
 A category $\catC$ is $\catMet$\emph{-enriched} (or simply a $\catMet$-category) if for each pair of objects $A$ and $B$ in $\catC$, the hom-set $\catC(A, B)$ is a metric space and if the composition of $\catC$-morphisms,
 $$(\comp): \catC(A, B) \otimes \catC(B, C) \rightarrow \catC(A, C)$$
 is a functor in the category of metric spaces. 
 Given two $\catMet$-enriched categories $\catC$ and $\catD$ and a functor $F : \catC\to \catD$, we call 
$F$ a \emph{$\catMet$-enriched functor} (or simply, a \emph{$\catMet$-functor}) if for all objects $A, B$ in $\catC$, 
the map $F_{A,B} : \catC(A,B) \to \catC(FA, FB)$ is a $\catMet$-functor. 
An adjunction $\catC : F \dashv G : \catD$ is called \emph{$\catMet$-enriched} if for all objects $A \in |\catC|$ 
and $B \in |\catD|$ there exists a $\catMet$-isomorphism
$\catD(FA, B) \cong \catC(A, GB)$
natural in $A$ and $B$.
\end{definition}


\begin{definition}
A \emph{$\catMet$-enriched symmetric monoidal category} $\catC$ is a category that is both symmetric monoidal and $\catMet$-enriched, such that the bifunctor
$\otimes : \catC \times \catC \to \catC$
is a $\catMet$-functor. 

A  \emph{$\catMet$-enriched distributive symmetric monoidal category} $\catC$, is a category that is both distributive symmetric monoidal and a $\catMet$-enriched monoidal category, such that for all $f  \in \catC(X,Z)  $ and $g  \in \catC(Y,Z) $, $ [f,g]:\catC(X,Z)  \otimes \catC(Y,Z) \rightarrow \catC(X \oplus Y,Z) $ is a $\catMet$-functor.

A \emph{$\catMet$-enriched distributive symmetric monoidal closed category} $\catC$ is a category that is both symmetric monoidal closed and a $\catMet$-enriched distributive monoidal category, such that the adjunction
$(- \otimes A) \dashv (A \multimap -)$
is a $\catMet$-adjunction.
\end{definition}

Consider a distributive symmetric monoidal closed category $\catMet$-enriched $\catC$. A metric equation $\Gamma \vljud v =_{q} w : \typeA $ is satisfied by the interpretation in \autoref{fig:denotational_sem cond} if $q \leq d( \llbracket \Gamma  \vljud v : \typeA \rrbracket, \llbracket\Gamma \vljud w : \typeA \rrbracket)$ where $d : \catC(\llbracket \Gamma \rrbracket, \llbracket \typeA \rrbracket) \times \catC(\llbracket \Gamma \rrbracket, \llbracket \typeA \rrbracket) \rightarrow \mathbb{Q}_0^+$ is the underlying function of the $\catMet$-enriched category   $\catC(\llbracket \Gamma \rrbracket, \llbracket \typeA \rrbracket)$.


    The $\lambda$-terms are interpreted in a distributive symmetric
monoidal (closed) category~\cite{maclane13}. In more detail, 
\begin{definition}
        A monoidal category $\catC$ with coproducts is called
        distributive if for every object $A$ in $\catC$ the
        functor $- \otimes A$ preserves coproducts. Explicitly
        this means that the morphism,
        \[
                [\inl \otimes \id, \inr \otimes \id] : B \otimes A \oplus C \otimes                     A \to (B \oplus C) \otimes A
        \]
        is actually an isomorphism. We will denote the respective inverse
        by $\dist$. Note that if $\catC$ is monoidal closed then it is automatically
        distributive as left adjoints preserve all colimits.
\end{definition}

The proof of soundness and completeness for $\lambda$-calculus with conditionals, along with some other properties of the calculus seem to be missing in literature, as a result they can be found in \autoref{appendix:sound_comp_cond}

We now present the interpretation of $\lambda$-calculus with conditionals.
First the new type $A \oplus B$ is interpreted as $\sem{A \oplus B} = [\![A
]\!] \oplus [\![ B ]\!]$. As for the new terms, the corresponding
interpretation is defined inductively in \autoref{fig:denotational_sem cond}.

\begin{figure}[H]
\small
  \begin{equation*}
  \begin{aligned}
  &\hspace{10pt}
  %
  \begin{prooftree}
      \hypo{ [\![\Gamma \vljud v: \typeA]\!] = m }
      \infer1[]{ [\![ \Gamma \vljud \text{inl}_{\typeB} (v):  \typeA \oplus \typeB  ]\!] = \inl  \comp m}
  \end{prooftree}
  %
  \hspace{120pt}
  %
  \begin{prooftree}
    \hypo{ [\![\Gamma \vljud v: \typeB]\!] = m }
    \infer1[]{ [\![ \Gamma \vljud \text{inr}_{\typeA} (v):  \typeA \oplus \typeB  ]\!] = \inr  \comp m}
\end{prooftree}
  %
  \\[20pt]
  &\hspace{-20pt}
  %
  \begin{prooftree}
      \hypo{[\![\Gamma\vljud v: \typeA \oplus \typeB ]\!] = b}
      \hypo{[\![\Delta, x:\typeA \vljud w: \typeD ]\!] = p}
      \hypo{ [\![\Delta,y:\typeB \vljud u: \typeD ]\!] = q }
      \hypo{E \in \Shuff(\Gamma; \Delta)}
      \infer4[]{ [\![E \vljud \text{case } v\,  \{\text{inl}_{\typeB} (x) \Rightarrow w ;\, \text{inr}_{\typeA} (y) \Rightarrow u\}: \typeD ]\!] =   [p,q] \comp (\text{jn}_{\Delta;\typeA}\comp \sw \oplus \text{jn}_{\Delta;\typeB}\comp \sw) \comp \dist \comp (b \otimes \text{id}) \comp \text{sp}_{\Gamma;\Delta} \comp \text{sh}_{E}}
  \end{prooftree}
  %
  \\[10pt]
  \end{aligned}
  \end{equation*}
  \caption{Judgment interpretation for conditionals}
\label{fig:denotational_sem cond}
\end{figure}


\begin{theorem}
  The rules in Figures \ref{fig:equations-in-context-cond} and \ref{fig:metric conditionals} are sound for a  distributive symmetric monoidal closed category $\catMet$-enriched $\catC$ over metric spaces. Specifically, if $\Gamma \vljud v =_{q} w : \typeA $ results from the rules in Figures \ref{fig:equations-in-context-cond} and \ref{fig:metric conditionals} then $q \geq d( \llbracket \Gamma  \vljud v : \typeA \rrbracket, \llbracket\Gamma \vljud w : \typeA \rrbracket)$.
\end{theorem}

%\begin{proof}
%  Regarding the rules in Figure \ref{fig:equations-in-context-cond}, attending to the fact that an equation $\Gamma \vljud v=w: \typeA$ abbreviates the metric equation $\Gamma \vljud v =_0 w: \typeA$, and given that the rules in Figure \ref{fig:equations-in-context-cond} are sound for distributive symmetric monoidal closed categories, we have that $0 \leq d( \llbracket \Gamma \vljud v : \typeA \rrbracket, \llbracket\Gamma \vljud w : \typeA \rrbracket)$. 
%
% Regarding the rule in Figure \ref{fig:metric conditionals}, it follows from the fact that $\catC$ is  $\catMet$-enriched and $\otimes$ and $[ \cdot , \cdot ]$ are $\catMet$-functors. We reason as follows:
%  \begin{align*}
%    & d( \llbracket  \text{ case } v \, \{\text{inl}_{\typeB}  (x) \Rightarrow w ; \, \text{inr}_{\typeA} (y) \Rightarrow u\}  \rrbracket, \llbracket \text{ case } v' \, \{\text{inl}_{\typeB}  (x) \Rightarrow w' ; \, \text{inr}_{\typeA} (y) \Rightarrow u'\} \rrbracket)  \\
%    & = d( [\llbracket w\rrbracket ,\llbracket u\rrbracket] \comp (\text{jn}_{\Delta;\typeA}\comp \sw \oplus \text{jn}_{\Delta;\typeB}\comp \sw) \comp \dist \comp (\llbracket v\rrbracket \otimes \text{id}) \comp \text{sp}_{\Gamma;\Delta} \comp \text{sh}_{E}, \\
%    & \hspace{10pt} [\llbracket w'\rrbracket ,\llbracket u'\rrbracket] \comp (\text{jn}_{\Delta;\typeA}\comp \sw \oplus \text{jn}_{\Delta;\typeB}\comp \sw) \comp \dist \comp (\llbracket v'\rrbracket \otimes \text{id}) \comp \text{sp}_{\Gamma;\Delta} \comp \text{sh}_{E})\\
%    & \leq d( [\llbracket w\rrbracket ,\llbracket u\rrbracket] \comp (\text{jn}_{\Delta;\typeA}\comp \sw \oplus \text{jn}_{\Delta;\typeB}\comp \sw) \comp \dist \comp (\llbracket v\rrbracket \otimes \text{id}),  [\llbracket w'\rrbracket ,\llbracket u'\rrbracket] \comp (\text{jn}_{\Delta;\typeA}\comp \sw \, \oplus \\
%    & \hspace{10pt} \text{jn}_{\Delta;\typeB}\comp \sw) \comp \dist \comp (\llbracket v'\rrbracket \otimes \text{id}) )\\
%    & \leq d(\llbracket v\rrbracket \otimes \text{id}, \llbracket v'\rrbracket \otimes \text{id}) +  d( [\llbracket w\rrbracket ,\llbracket u\rrbracket] \comp (\text{jn}_{\Delta;\typeA}\comp \sw \oplus \text{jn}_{\Delta;\typeB}\comp \sw) \comp \dist,  [\llbracket w'\rrbracket ,\llbracket u'\rrbracket] \\
%    & \hspace{10pt} \comp (\text{jn}_{\Delta;\typeA}\comp \sw \oplus \text{jn}_{\Delta;\typeB}\comp \sw) \comp \dist) \\
%    & \leq q +  d( [\llbracket w\rrbracket ,\llbracket u\rrbracket] \comp (\text{jn}_{\Delta;\typeA}\comp \sw \oplus \text{jn}_{\Delta;\typeB}\comp \sw) \comp \dist,  [\llbracket w'\rrbracket ,\llbracket u'\rrbracket] \comp (\text{jn}_{\Delta;\typeA}\comp \sw \oplus \text{jn}_{\Delta;\typeB}\comp \sw)  \\
%    & \hspace{10pt} \comp \dist)\\
%    & \leq q +  d( [\llbracket w\rrbracket ,\llbracket u\rrbracket],  [\llbracket w'\rrbracket ,\llbracket u'\rrbracket]) \\
%    & \leq q + \sup(d( \llbracket w\rrbracket , \llbracket w' \rrbracket), d( \llbracket u\rrbracket , \llbracket u' \rrbracket)) \\
%    & \leq q + \sup(r, s) \\
%  \end{align*}
%  The second step follows from the fact that $\text{sp}_{\Gamma;\Delta} \comp \text{sh}_{E}$  is a morphism in $\catC$  and that $\catC$ is $\catMet$-enriched.  The third and fifth step follow from an analogous reasoning. The fourth step follows from the premises of the rule in question and from the metric equation regarding tensors. The sixth step follows from the fact that $[ \cdot , \cdot ]$ is a $\catMet$-functor and $\catC$  is $\catMet$-enriched. Finally, the last step follows from the premise of the rule in question.
%
%\end{proof}

\begin{definition}
Consider a tuple $(G,\Sigma)$ consisting of a class $G$ of ground
 types and a class of sorted operation symbols $f : \typeA_1,...,\typeA_n \rightarrow \typeA$ with $n \geq 1$. A \emph{linear metric $\lambda$-theory} $((G,\Sigma),\textit{Ax})$ is a tuple such that \textit{Ax} is a class of metric equations-in-context over linear $\lambda$-terms built from $(G,\Sigma)$.
\end{definition}

\begin{definition}
  Consider a linear metric $\lambda$-theory $((G,\Sigma),\textit{Ax})$ and a distributive symmetric monoidal closed category $\catMet$-enriched $\catC$. Suppose that for each $X \in G$ we have an interpretation $\llbracket X \rrbracket$ as a $\catC$-object and analogously for the operation symbols. This interpretation structure is a model of the theory if all axioms in \textit{Ax} are satisfied by the interpretation.
\end{definition}


For two types $\typeA$ and $\typeB$ of a metric $\lambda$-theory $\mathscr{T}$ , consider the class \textbf{Values}$(\typeA,\typeB)$ of values $v$ such that $x : \typeA \vljud v : \typeB$. We equip $\textbf{Values}(\typeA,\typeB)$ with the function $d :\textbf{Values}(\typeA,\typeB) \times \textbf{Values}(\typeA,\typeB) \rightarrow \mathbb{Q}^{+}_0$ defined by,
$$d(v,w)=\inf{\{q \, \vert \, v=_q w \text{ is a theorem of } \mathscr{T} \}}$$

It is easy to see that \textbf{Values}$((\typeA,\typeB),d)$ is a (possibly large)  $\catMet$-enriched category. We then quotient this  $\catMet$-enriched category into a separated  $\catMet$-enriched category which we denote by (\textbf{Values}$(\typeA,\typeB),d)$/$\sim$. We call  $\mathscr{T} $\emph{varietal} if (\textbf{Values}$(\typeA,\typeB),d)$/$\sim$ is a small  $\catMet$-enriched category for all types $\typeA$ and $\typeB$. For the rest of this work, we will focus exclusively on varietal theories and locally small categories.

\begin{theorem} (Completeness)
  Consider a varietal metric $\lambda-theory$. A metric equation
in-context $\Gamma \vljud v =_q w : A$ is a theorem iff it holds in all models of the theory.
\end{theorem}
\begin{proof}


  Completeness arises from constructing the syntactic category $\catSyn(\mathscr{T})$ of a $\lambda$-theory $\mathscr{T}$ (also known as term model)  and taking advantage of the quotienting of a  $\catMet$-enriched category into a separated  $\catMet$-enriched category. Note that the quotienting process identifies all terms $x : \typeA \triangleright v : \typeB$ and $x : \typeA \triangleright w : \typeB$ such that $v =_0 w$ and $w =_0 v$. This relation includes the equations-in-context from \autoref{fig:equations-in-context-cond} and, moreover, it is straightforward to verify that it is compatible with the term formation rules of the linear $\lambda$-calculus \autoref{fig:typing_rules_cond}. Thus, we obtain a category $\catSyn(\mathscr{T})$ whose objects are the types of the language and whose hom-sets are the underlying sets of the  $\catMet$-enriched categories (\textbf{Values}$(\typeA,\typeB),d)$/$\sim$.

  We start by showing that the map $\text{Syn}(\mathscr{T})(\typeA,\typeC) \otimes \text{Syn}(\mathscr{T})(\typeB,\typeC) \rightarrow
  \text{Syn}(\mathscr{T})(\typeA \otimes \typeB ,\typeC)$ is a functor in the category of metric spaces:

  \begin{align*}
    & d(([w], [v]), ([w'], [v']))  \\
    & = \sup{\{d([v],[w]),d([v'],[w']) \}}  \\
    & = \sup{\{d(v,w),d(v',w') \}} \\
    & = \sup {\{ \inf{\{q \, \vert \, v=_q v'\}},\inf{\{r \, \vert \, w=_r w'\}}  \}} \\
    & = \inf{\{ \sup \{ q, r \} \vert \, v=_q v', w=_r w' \}} &  \\
    & \geq  \inf{ \{ q  \,\vert \, \text{ case } z \,   \{\text{inl} (x) \Rightarrow v ; \, \text{inr} (y) \Rightarrow w\} =_{q} \text{ case } z \,  \{\text{inl} (x) \Rightarrow v' ; \,\text{inr} (y) \Rightarrow w'\} \} } &  \\ 
    & = d(\text{case } z \,   \{\text{inl} (x) \Rightarrow v ; \, \text{inr} (y) \Rightarrow w\}, \text{case } z \,  \{\text{inl} (x) \Rightarrow v' ; \,\text{inr} (y) \Rightarrow w'\}) \\
    & = d([\text{case } z \,   \{\text{inl} (x) \Rightarrow v ; \, \text{inr} (y) \Rightarrow w\}], [\text{case } z \,  \{\text{inl} (x) \Rightarrow v' ; \,\text{inr} (y) \Rightarrow w'\}]) \\
    & = d([[v],[v']],[[w],[w']])  
  \end{align*}
   The fourth step follows from the distributive law for lattices, and the fifth step follows from the fact that for any sets $A$ and $B$, if $A \subseteq B$, then $\inf\{A\} \geq \inf\{B\}$.

  The next step is to show that if an equation $\Gamma \vljud v =_q v' : \typeA$ with $q \in \mathbb{Q}^{+}_0$ is satisfied by Syn$(\mathscr{T})$ then it is a theorem of the linear metric $\lambda$-theory. By assumption $d([v],[v']) = d(v,v') =  \inf{ \{r \, \vert \, v =_r v'\}} \leq q$. It follows from the definition of the way-below relation that for all
 $x \in \mathbb{Q}^{+}_0$ with $x>q$ there exists a finite set $A \subseteq \{r \, \vert \, v =_r v'\}$ such that $x \geq \inf{A}$. Then by an
 application of rule (join) (\cite[Figure 4]{dahlqvist2023syntactic}) we obtain $v =_{\inf{A}} v'$, and consequently, rule (weak) (\cite[Figure 4]{dahlqvist2023syntactic}) provides $v =_x v'$ for all $x > q$. Finally, by an application of rule (arch) (\cite[Figure 4]{dahlqvist2023syntactic}) we deduce that $v =_q v'$ is part of the theory.

  Moreover, let us consider the following diagram:

  \vspace{10pt}

  \begin{tikzpicture}
    \matrix (m) [matrix of math nodes, row sep=4em, column sep=7em, minimum width=2em]
    {
      X \times X  &  X /{\sim} \times X /{\sim}  \\
      Y  \\
    };
    \path[-stealth]
      (m-1-1) edge node [left] {$f$} (m-2-1)
      (m-1-1) edge node [above] {} (m-1-2)
      (m-1-2) edge node [above] {$\hat{f}$} (m-2-1)
      ;
  \end{tikzpicture}


It is necessary to prove that when $\hat{f}$ is defined as $\hat{f}([x],[y]) = [f(x,y)]$, $\hat{f}$ is a well-defined function. This is the case because if $[x] = [x']$ and $[y] = [y']$ then $x =_0 x'$ and $y =_0 y'$, and consequently applying rule  (refl) we obtain that $f(x,y) =_0 f(x',y')$.
\end{proof} 


\section{A brief illustration with probabilistic programming}

We now briefly illustrate the case of probabilistic computation, using as basic
examples two main topics in probability theory~\cite{dudley18} -- probabilistic
predicates and random walks on the real line.  Our illustration will be
grounded on a standard probabilistic model, namely the category $\Ban$ of
Banach spaces and linear contractions~\cite{dahlqvist19}. As discussed
in~\cite{dahlqvist2023syntactic} this category has a $\Met$-enriched
monoidal-closed structure and it is well-known that it has binary coproducts
given by the direct sum equipped with the $\ell_1$ norm. Thus in order to fit
$\Ban$ in our framework we only need to show that its binary coproduct
structure is $\Met$-enriched as well. We prove this next. 

Let us start with some preliminaries. The $\Met$-enriched structure of $\Ban$
is induced by the \emph{operator norm}. Specifically given a linear map 
$T : V \to W$ between Banach spaces we have,
\[
        \norm{T} = \sup \{ \norm{T(v)} \mid v \in V, \norm{v} = 1 \}
\]
Linear contractions will be precisely those linear maps $T$ such that $\norm{T}
\leq 1$, and the distance between two contractions $T$ and $S$ is set as
$\norm{ T - S}$. Given $T : V \to W$ and $S : U \to W$ their co-pairing $[T,S]
: V \oplus U \to W$ is defined by $[T,S](v,u) = T(v) + S(u)$. The fact that the
operator $[T,S]$ is contractive follows from the inequation $\norm{[T,S]} \leq
\max \{ \norm{T}, \norm{S} \}$ -- which is straightforward to prove when
one notices that every unitary vector $(v,u) \in V \oplus U$ can be rewritten
as,
\[
        \left (\norm{v} \frac{1}{\norm{v}} v, \norm{u} \frac{1}{\norm{u}} u \right )
        \hspace{1cm}
        \norm{v} + \norm{u} = 1
\]
The fact that the coproduct structure of $\Ban$ is $\Met$-enriched then follows
rather directly,
\begin{align*}
        d([T,S] , [T',S']) 
        & = 
        \norm{ [T,S] - [T',S'] }
        \\
        & = 
        \norm{ [T - T', S - S'] }
        \\
        & \leq
        \max \{ \norm{T - T'}, \norm{S - S'} \}
        \\
        & =
        \max \{ d(T,T'), d(S,S') \}
\end{align*}
Next, we will involve the notion of a measure (see \eg\ \cite[Chapter
10]{aliprantis06} or \cite[Chapter 2]{panangaden09}).

\begin{definition} For a measurable space $(X,\Sigma_X)$ a measure is a
        function $\mu : \Sigma_X \to \Reals$ such that $\mu(\emptyset) = 0$ and
        moreover it is $\sigma$-additive, \ie\ 
        \[
        \mu \left (\bigcup_{i =1}^{\infty} U_i \right ) = \sum_{i = 1}^{\infty}
        \mu(U_i) 
        \] 
where $(U_i)_{i \in \omega}$ is any family of pairwise disjoint measurable
sets.  A measure $\mu$ is called positive if $\mu(U) \geq 0$ for all measurable
sets $U$.  
\end{definition}

For a measurable space $X$ the set of measures $\Measu(X)$ forms a vector space
via pointwise extension. It also forms a Banach space when equipped with the
total variation norm,
\[
        \lVert \mu \rVert = 
        \sup \left \{ \sum_{i = 1}^n \, \lVert \mu(U_i) \rVert \mid
             \{ U_1, \dots, U_n \} \text{ is a measurable partition }
        \right \}
\]
An extremely useful fact is that $\norm{\mu} = \mu^{+}(X) + \mu^{-}(X)$ where
$\mu^{+}$ and $\mu^{-}$ are the positive and negative parts of $\mu$
respectively (see details in~\cite[Section 8.2. and Section
10.10]{aliprantis06}).

We proceed by presenting a simple a metric $\lambda$-theory on which to reason
about predicates and random walks, as previously discussed. Our (only) ground
type will be $\mathtt{real}$ to represent measures over real numbers, \ie\ we
set $\sem{\mathtt{real}} = \Measu(\Reals)$.  Concerning operations we take a
pre-determined set of predicates $p : \mathtt{real} \to \typeI \oplus \typeI$,
whose interpretation takes the form $\sem{p}(\mu) = (\mu(U),
\mu(\overline{U}))$ for some measurable subset of $U \subseteq \Reals$. In
other words $U \subseteq \Reals$ corresponds to the subspace in which the
predicate is supposed to hold. We also take a pre-determined set of actions $a
: \typeI \to (\typeA \multimap \typeA)$ and a pre-determined set of measures $m
: \typeI \to \mathtt{real}$, whose interpretation takes no particular form.
Finally we consider an addition operation $+ : \mathtt{real},\mathtt{real} \to
\mathtt{real}$ whose interpretation is given by $\mu \otimes \nu \mapsto
+_\ast(\mu \otimes \nu)$ where $+_\ast$ is the pushforward measure construction
w.r.t. the measurable map $+ : \Reals \times \Reals \to \Reals$.  Now, given a
measure $m$ and actions $a,b$ consider the following 'abstract' Bernoulli
trial,
\[
        p : \mathtt{real} \multimap \typeI \oplus \typeI
        \vljud \underbrace{ \text{case } p(m) \text{ of } \inl(x) \Rightarrow a(x) ; 
        \inr(y) \Rightarrow b(y)}_{\mathtt{bern}(p)} : \typeA \multimap \typeA
\]
Note that if $p_1(x) =_\epsilon p_2(x)$ then  $\mathtt{bern}(\lambda x. p_1(x))
=_\epsilon \mathtt{bern}(\lambda x. \, p_2(x))$ holds, as per our equational
system. Such is useful to approximate Bernoulli trials that are hard to compute
as the following example illustrates.
\begin{example}[Predicates as limits of Cauchy sequences]
        Consider the predicate,
        \[
                x : \mathtt{real} \vljud
                p_{\frac{1}{2}\sqrt{2}}(x) : \typeI \oplus \typeI
        \]
        that returns true if $x < \frac{1}{2}\sqrt{2}$ and false otherwise.
        Given the irrationality of $\frac{1}{2}\sqrt{2}$ it is natural to
        consider successive approximations $p_{q_n}(x) :  \typeI \oplus \typeI$
        $(n \in \Nats)$ of this predicate in which the condition $x <
        \frac{\sqrt{2}}{2}$ is replaced by $x < q_n$ for $q_n$ a rational
        number. We show next how our framework makes this idea precise. Take
        the sequence of rational numbers $(q_n)_{n \in \Nats}$ defined by,
       which corresponds to Heron's method for approximating $\sqrt{2}$ (\ie\
        $\lim_{n \to \infty} q_n = \sqrt{2}$). We then postulate as axioms in
        our deductive system that $(p_{\frac{1}{2} q_n}(x))_{n \in \Nats}$ is a
        Cauchy sequence and furthermore that it converges to $p_{\frac{1}{2}
        \sqrt{2}}(x)$.  Such is asserted explicitly by setting,
        \begin{equation}
                \label{eq:sound}
                \begin{cases}
                \forall \epsilon > 0. \, \exists m \in \Nats.
                \, \forall n \geq m. \, p_{\frac{1}{2}q_n}(x) =_\epsilon p_{\frac{1}{2}q_{n+1}} (x)
                & \text{(Cauchy sequence)}
                \\
                \forall \epsilon > 0. \, \exists m \in \Nats.
                \, \forall n \geq m. \, p_{\frac{1}{2}q_n}(x) 
                =_\epsilon p_{\frac{1}{2} \sqrt{2}} (x)
                & \text{(Convergence)}
                \end{cases}
        \end{equation}
        for appropriate choices of $m$ (which in our context is irrelevant to
        detail). Then note that according to our deductive system we have that
        $\mathtt{bern}(\lambda x. \, p_{\frac{1}{2} q_n}(x))_{n \in \Nats}$ is
        a Cauchy sequence that furthermore converges to $\mathtt{bern}(\lambda
        x. \, p_{\frac{1}{2} \sqrt{2}}(x))$. Then next step is to prove
        that our axiomatics is sound.
        \begin{align*}
                \sem{p_{\frac{1}{2} \sqrt{2}}(x)}(\mu)
                & = \left (\mu \left (-\infty, \frac{1}{2} \sqrt{2} \right ), 
                \mu(X) - \mu \left (-\infty, \frac{1}{2}\sqrt{2} \right ) \right )
                &
                \\
                & = \left (\mu \left (\bigcup_{n \in \Nats} 
                        \left (-\infty, \frac{1}{2} q_n \right )\right ), 
                \mu(X) - \mu \left (-\infty, \frac{1}{2}\sqrt{2} \right ) \right )
                & 
                \left \{(\frac{1}{2}q_n)_{n \in \Nats} 
                \nearrow \frac{1}{2}\sqrt{2} \right \}
                \\
                & = \left (\sup_{n \in \Nats} \mu \left ( 
                        \left (-\infty, \frac{1}{2} q_n \right )\right ), 
                \mu(X) - \mu \left (-\infty, \frac{1}{2}\sqrt{2} \right ) \right )
                & 
                \left \{ \text{Measure properties} \right \}
                \\
                & = \left (\lim_{n \to \infty} \mu \left ( 
                        \left (-\infty, \frac{1}{2} q_n \right )\right ), 
                \mu(X) - \mu \left (-\infty, \frac{1}{2}\sqrt{2} \right ) \right )
                & 
                \left \{ \text{Limits coincide with sup. of inc. seq.} \right \}                         \\
                & = \left (\lim_{n \to \infty} \mu \left ( 
                        \left (-\infty, \frac{1}{2} q_n \right )\right ), 
                \lim_{n \to \infty}
                \mu \overline{\left (-\infty, \frac{1}{2}q_n \right )} \right )
                & 
                \left \{ \text{Measure properties} \right \}
                \\
                & = \lim_{n \to \infty} \left (\mu \left ( 
                        \left (-\infty, \frac{1}{2} q_n \right )\right ), 
                \mu \overline{\left (-\infty, \frac{1}{2}q_n \right )} \right )
                & 
                \\
                & = \lim_{n \to \infty}
                \sem{p_{\frac{1}{2}q_n}(x)}(\mu)
                &
        \end{align*}
\end{example}

\begin{example}[From predicates approximation to random walk approximation] 
        Let us now capitalise on the previous example to reason about
        approximations of random walks. First consider the term,
        \[
                (-) \vljud \underbrace{\lambda x_1. \, \dots \, x_k. \, y. \,
                x_1 (\dots (x_k(y)) \dots)}_{\mathtt{sequence_k}}
        \]
        which sequences $k$ terms given as input. Then take the $\lambda$-term
        $\mathtt{sequence_k} \> \mathtt{bern}(\lambda x. \, p(x)) \dots \,
        \mathtt{bern}(\lambda x. \, p(x)) : \typeA \to \typeA$ which
        intuitively represents an abstract random walk of $k$-steps. In order
        to keep our notation simple we will abbreviate this last $\lambda$-term to
        $\mathtt{rwalk}(\lambda x. \, p(x))$.  It follows from our system that
        if $p_1(x) =_\epsilon p_2(x)$ then,
        \[
                \mathtt{rwalk}(\lambda x. p_1(x)) =_{n \cdot \epsilon}
                \mathtt{rwalk}(\lambda x. p_2(x)) 
        \]
        In particular from the previous example we can deduce that
        $\mathtt{rwalk}\left (\lambda x. \, p_{\frac{1}{2} q_n} (x) \right )$
        is a Cauchy sequence that converges to $\mathtt{rwalk}\left (\lambda x.
        \, p_{\frac{1}{2} \sqrt{2}} (x) \right )$.

        As a final illustration of the synergy between syntax and semantics
        that our framework provides, suppose now that the actions $a,b : \typeI
        \to \typeA \multimap \typeA$ involved in $\mathtt{bern}(\lambda x. \,
        p(x))$ are concrete jumps on the real line. To this effect we set the
        interpretations of $a$ and $b$ to be,
        \[
                        \sem{a}(1)(\mu) = +_\ast(\mu \otimes \mathtt{unif}(0,1))
                        \hspace{2cm}
                        \sem{b}(1)(\mu) = +_\ast(\mu \otimes \mathtt{unif}(-1,0))
        \]
        where $\mathtt{unif}(0,1)$ is the uniform distribution on the interval
        $[0,1]$ and analogously for $\mathtt{unif}(-1,0)$.  Operationally $a$
        corresponds to a jump to the right with magnitude between $0$ and $1$,
        and analogously for $b$. Suppose we have another action $c : \typeI \to
        (\typeA \multimap \typeA)$ whose interpretation is that of $a$ except
        for the fact that $\mathtt{unif}(0,1)$ is replaced by
        $\mathtt{unif}(0,1+\delta)$. What will be the effect on the random walk
        when replacing $a$ by $c$? 

        Our approach for answering the previous question starts by
        `decomposing' the actions $a$ and $c$, via the axioms,
        \[
                a(\ast) =_0 \lambda z. \, +(z, \mathtt{unif}(0,1)(\ast))
                \hspace{1cm}
                c(\ast) =_0 \lambda z. \, +(z, \mathtt{unif}(0,1 + \delta)(\ast))
        \]
        whose soundness is straightforward to prove. Note that we are slightly
        abusing notation by using $\mathtt{unif}(0,1)$ (resp.
        $\mathtt{unif}(0,1+\delta)$) both as syntactic and semantic objects.
        The next step is to observe that  one can put an upper bound between
        $a(\ast)$ and $c(\ast)$ via the previous axioms and an upper bound
        between the $\lambda$-terms $\mathtt{unif}(0,1)(\ast)$ and
        $\mathtt{unif}(0,1+\delta)(\ast)$. The latter upper bound can be
        obtained semantically, by computing $\norm{ \mathtt{unif}(0,1) -
        \mathtt{unif}(0,1+\delta) }$ as follows:
        \begin{align*}
        & \norm{ \mathtt{unif}(0,1) - \mathtt{unif}(0,1+\delta) }
        \\
        & =
        \norm { \mathtt{unif}(0,1) - \mathtt{unif}(0,1+\delta) }^+ (\Reals)
        +
        \norm { \mathtt{unif}(0,1) - \mathtt{unif}(0,1+\delta) }^- (\Reals)
        \end{align*}
        and we proceed by computing the left-hand side of the addition,
        \begin{align*} 
        & \norm { \mathtt{unif}(0,1) - \mathtt{unif}(0,1+\delta) }^+ (\Reals)
        \\
        &  = 
        \sup \{ \mathtt{unif}(0,1)(U) - \mathtt{unif}(0,1 + \delta)(U)
        \mid U \subseteq \Reals \}
        \\
        & 
        =
        \sup \{ \mathtt{unif}(0,1)(U \cap [0,1]) 
        - \mathtt{unif}(0,1 + \delta)(U \cap [0,1]) 
        - \mathtt{unif}(0,1 + \delta)(U \cap (1,1 + \delta]) 
        \mid U \subseteq \Reals \}
        \\
        &
        = \sup \left \{ \left (1 - \frac{1}{1+\delta} \right ) 
                \mathtt{unif}(0,1)(U \cap [0,1]) 
        - \mathtt{unif}(0,1 + \delta)(U \cap (1,1 + \delta]) 
        \mid U \subseteq \Reals \right \}
        \\
        & = 1 - \frac{1}{1+\delta} 
        \end{align*}
        Via an analogous reasoning one shows that the right-hand side of the
        addition is equal to $\frac{\delta}{1 + \delta}$ and then proceeds
        syntactically in the following manner.
        \begin{align*}
               \text{case } p(m) \text{ of } \inl(x) \Rightarrow a(x) ; 
               \inr(y) \Rightarrow b(y)
               & =_0
               \text{case } p(m) \text{ of } \inl(x) \Rightarrow x \text{ to} 
               \ast. \, a(\ast) 
               ; 
               \inr(y) \Rightarrow b(y)
               \\
               & =_{2 \cdot {\frac{\delta}{1 + \delta}}}
               \text{case } p(m) \text{ of } \inl(x) \Rightarrow x \text{ to} 
               \ast. \, c(\ast) 
               ; 
               \inr(y) \Rightarrow b(y)
               \\
               & =_0
               \text{case } p(m) \text{ of } \inl(x) \Rightarrow c(x) 
               ; 
               \inr(y) \Rightarrow b(y)
        \end{align*}
        Thus if $\mathtt{rwalk}(\lambda x. p(x))$ is the random walk that
        involves action $a$ and $\mathtt{rwalk'}(\lambda x. p(x))$ the random
        walk that involves action $c$ we deduce from the framework the metric
        equation,
        \[
                \mathtt{rwalk}(\lambda x. p(x)) =_{2n \cdot \frac{\delta}{1 + \delta}}
                \mathtt{rwalk'}(\lambda x. p(x)) 
        \]
        which will tend converge to $0$ as $\delta$ tends to $0$.
\end{example}



%\subsection{Probabilistic computation}
%
%The category $\catBan$ of Banach spaces and and short operators is a suitable model for the interpreation of metric $\lambda$-theories
%  concerning probabilistic computation without condicionals, as shown in \cite{dahlqvist2023syntactic}. 
%
%  $\catBan$ admits coproducts. Given two Banach spaces  $V$ e $W$, their coproduct is the direct sum $V \oplus W$, equipped with the norm $\norm{(v,w)} = \norm{v}+\norm{w}$
%  for all  $v \in V$, $w \in W$.
%
%  Recall (\cite{guide2006infinite}) that every operator \( T: V \to U \) between Banach spaces \( V \) and \( U \) is equipped with a  norm \( \norm{T} \), called the \emph{operator norm}, defined by
%  $\norm{T} = \sup \{ \norm{Tv} \mid \norm{v} = 1 \}$. 
%  This norm induces a metric \( d \) on the hom-set \( \catBan(V, W) \), given by
%  $d(S, T) = \norm{S - T},$
%  for any \( S, T \in \catBan(V, W) \).
%
%  \begin{lemma} \label{lem_op_max_trace}
%  Let $V$, $W$ and $U$ be Banach spaces. Let $ T: V \to U$ and $ S: W \to U$ be short maps. Then, it holds that 
%  $$ \opnorm{[T, S]}= \sup \{T,S\}$$
%\end{lemma}
%
%\begin{proof}
%
%We start by proving the inequality $\opnorm{[T, S]} \leq \sup \{[\opnorm{T}, \opnorm{S}]\}$. We calculate,
%
%\begin{align*} 
%  & \opnorm{[T, S]} \leq \sup \{[\opnorm{T}, \opnorm{S}]\} \\
%  &\Leftrightarrow \sup{\{ \norm{[T, S] (A)}  \hspace{2pt} |  \hspace{2pt}  \norm{A} = 1  \}}  
%  \leq \sup \{ \sup\{ \norm{T (A)} \hspace{2pt} |  \hspace{2pt}  \norm{A} = 1 \}, \sup\{ \norm{S (B)} \hspace{2pt} |  \hspace{2pt}  \norm{B} = 1 \}\} \\
%  &\Leftrightarrow  \text{sup}{\{ \norm{[T, S] (A_1, A_2)}   \hspace{2pt} |  \hspace{2pt}  \norm{(A_1, A_2 )} = 1  \}}  
%  \leq   \sup \left\{  \norm{T (A)} ,   \norm{S (B)}  \, \vert \,   \norm{A} = 1, \norm{B} = 1 \right\}  \\
%  & \Leftrightarrow \sup \left\{  \norm{T (A_1) + S (A_2)}  \, \vert \, \norm{A_1} + \norm{A_2}= 1 \right\}  
%  \leq \sup \left\{  \norm{T (A)},   \norm{S (B)}  \, \vert \,   \norm{A} = 1, \norm{B} = 1 \right\}  \\
%\end{align*}
%By the triangle inequality, proving the inequality bellow suffices to establish the inequality at hand.
%\begin{align*}
%  &\sup \left\{  \norm{T (A_1)} +   \norm{S (A_2)}  \, \vert \, \norm{T(A_1)} + \norm{S(A_2)}= 1 \right\}  \\
%  \leq & \sup \left\{  \norm{T (A)},   \norm{S (B)}  \, \vert \,   \norm{A} = 1, \norm{B} = 1 \right\} 
%\end{align*}
%Taking $A_1$ and $A_2$ as the operators that maximize $\norm{T (A_1)} + \norm{T (A_2)}$, it follows that if the inequality bellow is proven so is the  previous inequality:
%\begin{align*}
%  &  \lVert A_{1} \rVert+ \lVert A_{2} \rVert=1  \wedge  \norm{T (A_1)} +   \norm{S (A_2)}   
%  \leq   \max \left\{  \norm{T (A_{1} / \lVert A_{1} \rVert ) \rVert_{L^1},   \lVert S (A_{2} / \lVert A_{2} \rVert ) }  \right\}  
%\end{align*}
%Proving the inequality above is equivalent to demonstrating that for all $a+b=1$,
% \begin{align*} 
%     x + y  \leq  \max \left\{   \dfrac{1}{a}x  ,   \dfrac{1}{b} y   \right\} \\
% \end{align*}
% This is done by arguing by \textit{reductio ad absurdum}, \textit{i.e.}, supposing otherwise leads to a contradiction:
% \begin{align*} 
%     &
%      x + y  >  \max \left\{   \dfrac{1}{a}x  ,   \dfrac{1}{b} y   \right\} \\
%     & \Rightarrow  x + y > \dfrac{1}{a}x  \wedge x + y > \dfrac{1}{b}y \\
%     & \Rightarrow  a (x + y) > x  \wedge b (x + y)> y \\
%     & \Rightarrow  a x + a y > x  \wedge b x + by > y \\
%     & \Rightarrow  a x + a y > x  \wedge (1-a) x + (1-a)y > y\\
%     & \Rightarrow  a x + a y > x  \wedge x-ax + y -ay > y\\
%     & \Rightarrow  x < a x + a y   \wedge x > a x + a y  \\
% \end{align*}
%It remains to prove the reverse inequality. The validity of this inequality stems from the observation that
%\begin{align*}
%  & \left\{ \sup  \{\norm{T (A)},   \norm{S (B)}  \, \vert \,   \norm{A} = 1, \norm{B} = 1 \}\right\}   \subseteq
% \left\{  \norm{T (A)} + \norm{S (B)}  \, \vert \,   \norm{A} + \norm{B} = 1 \right\}.
%\end{align*}
%This inclusion holds because the first set considers only the special case where one component of the sum has an input with norm equal to one, while the input of the other component has zero norm, meaning it act acts as a null superoperator. Consequently,
%\begin{align*}
%  & \sup \left\{  \norm{T (A)},   \norm{S (B)}  \, \vert \,   \norm{A} = 1, \norm{B} = 1 \right\}   \leq
% \sup \left\{  \norm{T (A)} + \norm{S (B)}  \, \vert \,   \norm{A} + \norm{B} = 1 \right\},
%\end{align*}
%and the equality is proven.
%
%\end{proof}
%
%  \begin{proposition} \label{prop:met_cond_pp}
%    For all $T, T' \in \catBan(V,U)  $ and $S, S' \in \catBan(W,U) $, $[T-T',S-S']:\catBan(V,U) \otimes \catBan(W,U) \rightarrow \catBan(V \oplus W,U) $ is a functor in the category of metric spaces.
%  \end{proposition}
%
%  \begin{proof}
%    We deduce by unfolding the respective definitions that we need to prove that for all short operators $T, T' \in \catBan(V,U)  $ and $S, S' \in \catBan(W,U) $ the inequation $\norm{[T-T', S-S']} \leq  \sup \left\{ \norm{T-T'}, \norm{S-S'} \right\}$ holds. This inequality follows directly from \autoref{lem_op_max_trace}.
%  \end{proof}
%
%  \begin{theorem}
%      The category $\catBan$ is a $\catMet$-enriched distributive symmetric monoidal category.
%  \end{theorem}
%
%\begin{proof}
%    This follows directly from \autoref{prop:met_cond_pp} and \cite[Theorem 4.3]{dahlqvist2023syntactic}.
%\end{proof}
%
%
%
%\subsection{Quantum Computation}
%
%\todo[inline]{Adicionar os preliminares de computação quantica: ops pos, cp, trace-nonincreasing,  quantum operations +  cenas de algebra linear: traço e normas}
%
%We begin by recalling/introducing a few concepts from quantum computation/linear algebra, assuming some familiarity with linear algebra. To simplify the presentation, we use the notation $\mathbb{C}^\Sigma$ to denote both the space $\mathbb{C}^n$ and the direct sum $\mathbb{C}^{n_1} \oplus \ldots \oplus \mathbb{C}^{n_s}$, and similarly, we write $\mathbb{C}^{\Sigma \times \Sigma}$ to denote both $\mathbb{C}^{n \times n}$ and $\mathbb{C}^{n_1 \times n_1} \oplus \ldots \oplus \mathbb{C}^{n_s \times n_s}$, where $n, n_1, \ldots, n_s \in \mathbb{N}$.
%An operator $A \in \mathbb{C}^{\Sigma \times \Sigma}$ is \emph{positive},  if $\langle v, Av \rangle \geq 0$ for all $v \in \mathbb{C}^{\Sigma}$. 
%We designate maps $\Phi: \mathbb{C}^{\Sigma_1 \times \Sigma_1} \to \mathbb{C}^{\Sigma_2 \times \Sigma_2}$ by \emph{super-operators}.   A super-operator $\Phi$ is called \emph{positive} if it sends positive (direct sums of) matrices to positive (direct sums of) matrices, \textit{i.e.} $A \geq 0 \Rightarrow{} \Phi (A) \geq 0$. A super-operator $\Phi:\mathbb{C}^{\Sigma_1 \times \Sigma_1} \to \mathbb{C}^{\Sigma_2 \times \Sigma_2}$ is said to be \emph{completely positive} if for all $\Sigma$, $\Phi \otimes I_{\mathbb{C}^{\Sigma \times \Sigma}}$ is positive.  
%The \emph{Euclidean norm} of a vector \( v \in \mathbb{C}^\Sigma\) is defined as $\|v\|_2 = \sqrt{\langle v, v \rangle}$. The \emph{trace} of $A \in \mathbb{C}^{\Sigma \times \Sigma}$
%$\text{Tr}(A) := \sum_i \langle A  v_i, v_i \rangle \in [0, \infty],$
%where $\{v_i\}$ is an orthonormal basis for $\mathbb{C}^{\Sigma}$.
%The \emph{trace norm}, of an operator $A \in \mathbb{C}^{\Sigma \times \Sigma}$ is defined as
%$\lVert A \rVert_{1} = \text{tr} \sqrt{A^{\dagger}A}$. The trace norm of a super-operator $\Phi: \mathbb{C}^{\Sigma_1 \times \Sigma_1} \xrightarrow{} \mathbb{C}^{\Sigma_2 \times \Sigma_2}$ is defined by 
%$\lVert \Phi \rVert_{1} =  \max\{\lVert \Phi \hspace{1pt} A \rVert_{1}   \mid  \lVert A \rVert_{1}=1\}.$
%
%In \cite{selinger04}, Selinger presents the category $\catQ$ as the model of the language QPL. 
%\begin{definition} \label{def:catQ}
%Let $\catCP$ be the category whose objects are natural numbers $n \geq 1$ and morphisms $n \rightarrow m$ are completely positive maps $C^{n \times n} \rightarrow C^{m\times m}$. Let  $\mathcal{M}_n$ denote the set of complex $n\times n$ matrices.
%  The category $\catQ$ is defined as the the finite biproduct completion of $\catCP$ (which extends $\catCPTP$ to include all completely positive maps),  further restricted to trace-nonincreasing morphisms. Let  $\mathcal{M}_n$ denote the set of complex $n\times n$ matrices.
%  \begin{itemize}
%    \item An object is a signature $\sigma= n_1, \ldots, n_s$. We denote these signatures by the Greek letters $\sigma, \tau$ and $\mu$.
%    \item A morphism $\Phi \in \sigma \to \tau $ is a matrix
%    $$\begin{pmatrix}
%      \Phi_{11} & \ldots & \Phi_{s1}, \\
%      \vdots & \ddots  & \vdots \\
%      \Phi_{1t} & \ldots & \Phi_{ts} \\
%    \end{pmatrix}$$
%    of arrows $\Phi_{ij}: \mathcal{M}_{n_i} \rightarrow \mathcal{M}_{m_j}$ in $\catCPS$ which is trace-nonincreasing, \ie, the following condition holds:
%    $$ \sum_j \sum_i \tr \left(\Phi_{ij} (A_i)\right)   \leq  \sum_i \tr \left(A_i\right) $$
%   for all positive $A_i \in \mathcal{M}_{n_i}$.
%
%    More concretely, $ij$-component of $\Phi$ is given by the function $\Phi_{ij} = \pi_{j} \comp \Phi \comp \mathrm{in}_{i} : \mathcal{M}_{n_i} \rightarrow \mathcal{M}_{n_j} $, where $\mathrm{in}_{i}$ is the injection of  $\mathcal{M}_{n_i}$ into the input space of $\Phi$ and  $\pi_{j}$ is the projection onto the $j$-th component.
%  \end{itemize}
%\end{definition}
%
%
% Every signature $\sigma$, is associated to  a complex vector space   
%$\mathcal{M}_\sigma = \mathbb{C}^{n_1 \times n_1} \oplus \cdots \oplus \mathbb{C}^{n_s \times n_s}$. This space consists of matrix vectors 
%where the signature $\sigma$ specifies both the number of matrices, $s$,  and their respective dimensions, $n_i \times n_i$. 
% 
%
%
%\begin{comment}
%\begin{definition} \label{def:tensor} \emph{Tensor Product }
%  For signatures $\sigma = n_1, \ldots, n_s $ and $\tau= m_1, \ldots, m_t $, the tensor product of $\sigma$ and $\tau$ is defined as $\sigma \otimes \tau = n_1 m_1, \ldots ,n_1 m_t, \ldots, n_s m_1,...,n_s m_t$. 
%  The morphism part of the tensor product follows the definition in the category of vector spaces. If $\Phi: \sigma \rightarrow \tau$ and $\Psi: \sigma' \rightarrow  \tau'$, then their tensor product $\Psi \otimes \Phi: \sigma \otimes \sigma' \rightarrow  \tau \otimes \tau' $ is defined on a basis element $A \otimes B$ by  
%$$
%(\Phi \otimes \Psi)(A \otimes B) = F(A) \otimes G(B),
%$$
%and extends to arbitrary elements by linearity.
%\end{definition}
%
%\begin{definition} \label{def:biproduct} \emph{Product and Coproduct}
%  The biproduct is given by the direct sum $\oplus$. Consequently, $\sigma \oplus \sigma'$ represents the concatenation of signatures. The co-pairing map $[\Phi, \Psi]: \sigma \oplus \sigma' \to \tau$ is defined as  $[\Phi, \Psi](A, B) = \Phi(A) + \Psi(B)$, and the pairing map $\langle \Phi, \Psi \rangle: \sigma \to \tau \oplus \tau'$ is given by  $\langle \Phi, \Psi \rangle(A) = (\Phi(A), \Psi(A))$.
%\end{definition}
%\end{comment}
%
%The category $\catQ$ is a distributive symmetric monoidal category with (bi)products (which are important to express the measurement operation) with $\dist = \id$, for further details see \cite[Section 6.2]{selinger04}. Unfortunately, it is not closed \cite{selinger2004towards}.
%
%Now, we must prove that $\catQ$ is a $\catMet$-enriched  distributive symmetric monoidal category. We consider the diamond norm on superoperators $\Phi: \mathcal{M}_\sigma \rightarrow \mathcal{M}_\mu$, given by $\diamondnorm{\Phi} = \tracenorm{ \Phi \otimes \id_{\mathcal{M}_{\sigma}}}.$ This norm induces a metric $d$ on the hom-set \(\mathbf{Q}(\sigma, \tau)\),  which is defined by
%$d(\Phi, \Psi) = \diamondnorm{\Phi, \Psi}$,
%for \( \Phi, \Psi \in \mathbf{Q}(\sigma, \tau) \).
%
%
%
%
%\begin{proposition} \label{prop:met_cond}
%  For all $\Phi, \Phi' \in \catQ(\sigma,\mu)  $ and $\Psi, \Psi' \in \catQ(\tau,\mu) $, $[\Phi-\Phi',\Psi-\Psi']:\catQ(\sigma,\mu) \otimes \catQ(\tau,\mu) \rightarrow \catQ(\sigma \oplus \tau,\mu) $ is a functor in the category of metric spaces.
%\end{proposition}
%\begin{proof}
%  We deduce by unfolding the respective definitions that we need to prove that for all short operators $\Phi, \Phi' \in \catQ(\sigma,\mu)  $ and $\Psi, \Psi' \in \catQ(\tau,\mu) $ the inequation $\diamondnorm{[\Phi-\Phi', \Psi - \Psi']} \leq  \sup \left\{ \diamondnorm{\Phi-\Phi'}, \diamondnorm{\Psi-\Psi'} \right\}$ holds. Using the fact that $\dist = \mathrm{id}$ and applying \autoref{lem_op_max_trace}, we obtain:
%    \begin{align*}
%      & \gendiamondnorm{[\Phi, \Psi]} 
%      = \tracenorm{[\Phi, \Psi] \otimes \id_{\mathcal{M}_\sigma\oplus\mathcal{M}_\tau}} 
%      =  \tracenorm{[\Phi \otimes \id_{\mathcal{M}_\sigma}, \Psi \otimes \id_{\mathcal{M}_\tau}]}\\
%      & =  \sup \{ \tracenorm{\Phi \otimes \id_{\mathcal{M}_\sigma}}, \tracenorm{\Psi \otimes \id_{\mathcal{M}_\sigma}} \}
%      = \sup \left\{ \diamondnorm{\Phi}, \diamondnorm{\Psi} \right\}
%    \end{align*}
%\end{proof}
%
%\todo[inline]{Podemos só dizer algo do género the following is a corollary of \cite[Theorem 3.39]{watrous2018theory}?}
%
%\begin{corollary} \label{cor:gen_diamond_cptp_norm}
%    Let $\sigma: n_1, \ldots, n_s$ and  $\tau: m_1, \ldots, m_t$  be signatures. Let  $\Phi: \mathcal{M}_\sigma  \rightarrow \mathcal{M}_\tau$ be a  completely positive trace-nonincreasing super-operator. It holds that $\diamondnorm{\Phi}=1$
%  \end{corollary}
%
%
%  \begin{proof}
%    Given that $\Phi$ is a  completely positive trace-nonincreasing super-operator, if follows that $ \Phi \otimes \id_{\sigma}$ is a positive trace-nonincreasing super-operator. Let $\Psi = \Phi \otimes \id$, it holds that,
%    \begin{align*}
%      \diamondnorm{\Phi}& =\tracenorm{\Psi}\\
%       &= \max \left\{\tr \left( \Psi (u u^\dag)\right) \, \vert \, \euclideannorm{u}=1 \right\}  & \left(\text{\cite[Theorem 3.39]{watrous2018theory}}\right)\\
%      & = \max \left\{ \sum_i \sum_j \tr \left( \Psi_{ij} (u_i u_i^\dag)\right) \Bigm|  \euclideannorm{\begin{pmatrix} u_1, \ldots, u_s^2 \end{pmatrix}^T}=1 \right\} \\
%      & \leq \max \left\{ \sum_i \tr \left( u_i u_i^\dag \right) \Biggm| \sqrt{\sum_i \euclideannorm{u_i}^2}=1 \right\}   & (\Psi \text{ is trace-nonincreasing}) \\
%      & = 1
%    \end{align*}
%    
%    % isto é verdade porque tr(u_iu_i^\dag ) =  \\ u_i\\^2 . consideremos u_i= (a_1,...,a_n), tr(u_iu_i^\dag )= |a_1|^2+...+ |a_n|^2 e \\ u_i\\ = \sqrt(|a_1|^2+...+ |a_n|^2)
%    
%  \end{proof}
%
%  
%
%\begin{proposition}
%  The category $\catQ$ is $\catMet$-enriched and the bifunctor $\otimes : \catQ \otimes \catQ \to \catQ$ is $\mathsf{Met}$-enriched as well.
%\end{proposition}
%
%
%
%\begin{proof}
%
%  First, we establish that $\catQ$ is $\catMet$-enriched. By unpacking the relevant definitions, this reduces to proving the following: for all short operators $\Phi, \Phi' : \sigma \to \tau$ and $\Psi, \Psi' : \tau \to \mu$ the inequation $\diamondnorm{\Phi-\Phi'} + \diamondnorm{\Psi-\Psi'} \geq \diamondnorm{\Psi\Phi-\Psi'\Phi'} $ holds. This follows directly from \cite[Proposition 3.38 (second statement)]{watrous2018theory}
%
%  Next, regarding $\otimes$ we can also deduce by unfolding the respective definitions that we need to prove $ \diamondnorm{\Phi - \Phi'} + \diamondnorm{\Psi - \Psi'} \geq \diamondnorm{\Psi \otimes \Phi - \Psi' \otimes \Phi'}$. 
%  For this case,  by \cite[Corollary 3.47]{watrous2018theory} and \cite[Proposition 3.44]{watrous2018theory} , we have the inequalities  
%  \[
%  \| \Phi \|_\diamond \geq \| \Phi \otimes \mathrm{id} \|_\diamond
%  \quad \text{and} \quad  
%  \| \Phi \|_\diamond \geq \| \mathrm{id} \otimes \Phi \|_\diamond
%  \]  
%  for any super-operator \( \Phi \). Attending to \cite[ Proof of proposition 4.1]{dahlqvist2023syntactic} these conditions are sufficient to establish that the bifunctor $\otimes : \catQ \otimes \catQ \to \catQ$ is $\mathsf{Met}$-enriched.
%\end{proof}
%
%

 \section{Future work}

We introduced a metric equation for the conditional construct and proved its soundness and completeness. We then showed that, in the context of probabilistic programming, the category of Banach spaces and short maps, $\catBan$, serves as a suitable model for reasoning about approximate equivalence. Similarly, the category $\catQ$, introduced in \cite{selinger04} to provide a denotational semantics for the first-order functional quantum programming language QPL, also appears to be a suitable candidate—though it is not a closed category.


In \cite{dahlqvist2023syntactic}, the authors used general results from category theory to address a similar issue in the category $\catCPTP$ of completely positive trace-preserving maps, which is also not closed. A natural next step would be to extend such a construction for completely positive trace-nonincreasing maps and explore the biproduct completion of such a category. A more ambitious direction would involve introducing a metric equation for recursion and proving its soundness and completeness.

\bibliography{lipics}

\appendix

\section{Properties, soundness and completeness of  the lambda calculus with conditionals}\label{appendix:sound_comp_cond}
The rules presented in Figure \ref{fig:typing_rules_cond} enjoy the following
properties.

\begin{theorem} \label {theorem:unique_der}
   Lambda calculus with conditionals has the following properties:
   \begin{enumerate}
     \item\label{perm} for all judgements $\Gamma \vljud v$ and $\Gamma'
             \vljud v$, te($\Gamma$) $\simeq_{\pi}$  te($\Gamma'$); 
     %
     \item\label{type} additionally if $\Gamma \vljud v: \typeA,
       \Gamma' \vljud v: \typeA'$, and $\Gamma \simeq_{\pi}
       \Gamma'$, then $\typeA$ must be equal to $\typeA'$;
     %
     \item\label{der} all judgements $\Gamma \vljud v:\typeA$ have a unique derivation.
\end{enumerate}
\end{theorem}
%
\begin{proof}
It follows in all three cases from induction over the length of derivation
trees. 

Let us focus first on Property~\eqref{perm}. The case of the rules concerning
injections is direct. As for rule~$\rulename{cond}$ take two contexts $E$ and
$E'$ for the same conditional. According to this rule we obtain contexts
$\Gamma$, $\Gamma'$, $\Delta$, $\Delta'$ such that $E \in
\Shuff(\Gamma;\Delta)$ and $E' \in \Shuff(\Gamma';\Delta')$. It follows from
induction that  $\Gamma \simeq_\pi \Gamma'$ and $\Delta \simeq_\pi \Delta'$,
and the proof is then obtained from the sequence of equivalences,
\begin{align*}
        \text{te}(E) & \simeq_\pi \text{te}(\Gamma, \Delta) 
        \\
        & \simeq_\pi \text{te}(\Gamma', \Delta')
        \\
        & \simeq_\pi \text{te}(E')
\end{align*}
Concerning Property~\eqref{type}, the case of the rules concerning injections
is direct and the case of rule~$\rulename{cond}$ is a corollary of
Property~\eqref{perm}. Finally let us consider Property~\eqref{der}. Again the
case concerning injections is direct and we thus focus only on
rule~$\rulename{cond}$. According to this rule we obtain contexts $\Gamma$,
$\Gamma'$, $\Delta$, $\Delta'$ such that $E \in \Shuff(\Gamma;\Delta)$ and $E
\in \Shuff(\Gamma';\Delta')$. By an appeal to Property~\eqref{perm} we also
obtain $\Gamma \simeq_\pi \Gamma'$ and $\Delta \simeq_\pi \Delta'$, and thus
since shuffling preserves relative orders we obtain $\Gamma = \Gamma'$ and
$\Delta = \Delta'$. The proof then follows by induction.
\end{proof}

\begin{lemma}[Exchange and Subsitution]
\label{lem:exh_and_sub} 
For every judgement $\Gamma,x: \typeA, y: \typeB, \Delta \vljud v: \typeD$ the
judgement $\Gamma, y:\typeB, x:\typeA, \Delta \vljud v:
\typeD$ is derivable. Not only this, given judgements  $\Gamma,x:\typeA \vljud
v: \typeB$ and $\Delta \vljud w: \typeA$ the judgement $\Gamma, \Delta \vljud
v[w/x]: \typeB$ is also derivable.
\end{lemma}


\begin{proof}
We start with the exchange property which follows by induction over the length
of derivation trees. The rules that involve injections are direct.  The rule
$\rulename{case}$ calls for case distinction, more specifically we  distinguish
between the cases in which both variables ($x : \typeA$ and $y : \typeB$) are
in $\Gamma$, both are in $\Delta$, and otherwise. The first two cases follow
straightforwardly by induction and the definition of a shuffle. For the third
case consider a judgement $E_1,x : \typeA, y : \typeB, E_2 \vljud \text{case }
v\, \{\inl_{\typeF}(a) \Rightarrow w ; \, \inr_{\typeE}(b) \Rightarrow u \}:
\typeD$, and assume with no loss of generality that $\Gamma$ is of the form
$\Gamma_1, x : \typeA, \Gamma_2$ and $\Delta$ of the form $\Delta_1, y :
\typeB, \Delta_2$. The proof now follows directly from the implication,
\begin{align*}
        & E_1, x : \typeA, y : \typeB, E_2 \in \Shuff(\Gamma_1, x : \typeA, \Gamma_2 ; \,
        \Delta_1, y : \typeB, \Delta_2)
        \Longrightarrow \\
        &E_1, y : \typeB, x : \typeA, E_2 \in \Shuff(\Gamma_1, x : \typeA, \Gamma_2 ; \,
        \Delta_1, y : \typeB, \Delta_2)
\end{align*}
(which holds by the definition of a shuffle).

Finally we now focus on the substitution rule which also follows by induction over the
length of derivation trees. Again the cases involving the injections are direct,
and we thus only detail the proof of rule $\rulename{case}$. Consider then
judgements $E,x : \typeA \vljud \text{case } v\, \{\inl_{\typeD}(a) \Rightarrow
w ; \, \inr_{\typeE}(b) \Rightarrow u \}: \typeB$ and
$Z \vljud t : \typeA$ with $E \in \Shuff(\Gamma; \Delta)$. According to the definition
of a shuffle either $\Gamma$ is of the form $\Gamma_1, x: \typeA$ or $\Delta$ is
of the form $\Delta_1, x : \typeA$. The first case follows directly and the second case
is a corollary of the exchange rule.
\end{proof}

The next step is to demonstrate that the equations in Figure \ref{fig:equations-in-context-cond} are valid under the given interpretation. To achieve this, we first establish the following lemma.

\todo[inline]{Colocar formatação direita se as coisas se mantiverem}

\begin{lemma}[Exchange and Substitution]
\label{lem_interpret_exch:sub} 
For all judgements $\Gamma,x:\typeA, y:\typeB, \Delta \vljud v: \typeD, \> $
$\Gamma,x:\typeA \vljud v: \typeB$ and $\Delta \vljud w: \typeA$  the following
equations hold: 
  \begin{equation*}
\begin{split}
  [\![\Gamma,x:\typeA, y:\typeB, \Delta \vljud v: \typeD]\!] = [\![\Gamma,y:\typeB,x:\typeA,  \Delta \vljud v: \typeD]\! ] \comp \text{exch}_{\Gamma, \underline{ \typeA, \typeB} ,\Delta} \\
  [\![\Gamma, \Delta \vljud v[w/x]: \typeB]\!] = [\![\Gamma, x:\typeA \vljud v: \typeB]\!]\comp \text{jn}_{\Gamma;\typeA} \comp (\text{id} \otimes [\![ \Delta  \vljud w: \typeA]\!] ) \comp \text{sp}_{\Gamma;\Delta} 
\end{split}
  \end{equation*}
\end{lemma}

\begin{proof}
  We begin with the exchange property. The rules involving injections are
  straightforward. As for the rule~$\rulename{case}$, we distinguish between
  the scenarios where both variables ($x : \typeA$ and $y : \typeB$) are in
  $\Gamma$, both are in $\Delta$, or they are distributed across $\Gamma$ and
  $\Delta$. We begin with the first case. 
  \begin{align*}
    & \sem{\Gamma,x, y, \Delta \vljud \text{case }  v\,  \{\text{inl}_{\typeD} (a) \Rightarrow w ;\, \text{inr}_{\typeE} (b) \Rightarrow u\}} \\ 
    &\triangleq   [\sem{w}  , \sem{u}] \comp (\text{jn}_{E;\typeD}
    \comp \sw \oplus \text{jn}_{E;\typeE } \comp \sw) 
    \comp (\sem{ v} \otimes \id)  
    \comp \text{sp}_{\Gamma_{1},\typeA, \typeB,\Gamma_{2};E} 
    \comp \text{sh}_{\Gamma,\typeA, \typeB,\Delta}
    & \\
    & =  [\sem{w},\sem{u}] \comp (\text{jn}_{E;\typeD}
    \comp \sw \oplus \text{jn}_{E;\typeE } \comp \sw) 
    \comp (\sem{v} \comp\, \text{exch}_{\Gamma_{1}, \underline{\typeA,\typeB},\Gamma_{2}} 
    \otimes \id) \comp \text{sp}_{\Gamma_{1},\typeA, \typeB,\Gamma_{2};E} 
    \comp \text{sh}_{\Gamma,\typeA, \typeB,\Delta}
    & \text{(Induction)}\\
    &  =  \dots  \comp (\sem{v} \otimes \id) 
          \comp (\text{exch}_{\Gamma_1, \underline{\typeA, \typeB}, \Gamma_2} \otimes \text{id}) \comp \text{sp}_{\Gamma_{1},\typeA,\typeB, \Gamma_{2};E} \comp  \text{sh}_{\Gamma,\typeA, \typeB,\Delta} & {}\\
    & = \dots \comp (\sem{v} \otimes \id) \comp \text{sp}_{\Gamma_{1},\typeB,\typeA, \Gamma_{2};E} 
          \comp \text{sh}_{\Gamma,\typeB, \typeA,\Delta}  
          \comp \text{exch}_{\Gamma,  \underline{\typeA,\typeB}, \Delta} 
    & {\text{(Coherence)}} \\
    & \triangleq \sem{\Gamma,y, x, \Delta \vljud \text{case } v\,  \{\text{inl}_{\typeE} (a) \Rightarrow w ;\, \text{inr}_{\typeD} (b) \Rightarrow u\}} 
    \comp \text{exch}_{\Gamma,  \underline{\typeA, \typeB}, \Delta}
  \end{align*}
Let us now focus on the second case, \ie\ both variables live in $\Delta$.
\begin{align*}
  & \sem{\Gamma,x, y, \Delta \vljud \text{case } \, v\, \{\text{inl} (a) \Rightarrow w ;\, \text{inr} (b) \Rightarrow u\}} \\
  & \triangleq  [\sem{w} ,\sem{u}]\comp (\text{jn}
  \comp \sw \oplus \text{jn} \comp \sw) 
  \comp \dist \comp (\sem{v} \otimes \id) \comp 
  \text{sp}_{} 
  \comp \text{sh}_{}  \\
  & = [\sem{ w }  \comp \text{exch}, \sem{u}\comp \text{exch}] \comp (\text{jn}\comp \sw \oplus \text{jn} \comp \sw) \comp \dist \comp (\sem{v} \otimes \id) \comp\text{sp} \comp \text{sh}
  & \text{(Induction)}\\
  & = [\sem{ w }, \sem{u}] 
  \comp (\text{exch} \oplus \text{exch}) 
  \comp (\text{jn}\comp \sw \oplus \text{jn} \comp \sw) 
  \comp \dist \comp (\sem{v} \otimes \id) \comp\text{sp} \comp \text{sh} 
  & \text{(Coproduct laws)}
  \\
  & = [\sem{ w }, \sem{u}] 
  \comp (\text{jn}\comp \sw \oplus \text{jn} \comp \sw) 
  \comp (\id \otimes \text{exch} \oplus \id \otimes \text{exch})
  \comp \dist \comp (\sem{v} \otimes \id) \comp\text{sp} \comp \text{sh} 
  & \text{(Coherence)}
  \\
  & = [\sem{ w }, \sem{u}] 
  \comp (\text{jn}\comp \sw \oplus \text{jn} \comp \sw) 
  \comp \dist 
  \comp (\id \otimes \text{exch}) \comp (\sem{v} \otimes \id) \comp\text{sp} \comp \text{sh} 
  & \text{(Naturality)}
  \\
  & = [\sem{ w }, \sem{u}] 
  \comp (\text{jn}\comp \sw \oplus \text{jn} \comp \sw) 
  \comp \dist 
  \comp (\sem{v} \otimes \id) \comp\text{sp} \comp \text{sh} 
  \comp \text{exch}
  & \text{(Coherence)}
  \\
  & \triangleq \sem{\Gamma,y, x, \Delta \vljud \text{case } v\,  \{\text{inl} (a) \Rightarrow w ;\, \text{inr} (b) \Rightarrow u\}} 
  \comp \text{exch}_{}
  \end{align*}
The proof the for the third case follows directly from the coherence theorem
for symmetric monoidal categories.

Regarding the substitution rule, once again the cases involving the injections follow directly by induction on the derivation tree. For the rule (case), we distinguish between the scenarios where the variable $x$ is in $\Gamma$ or in $\Delta$. The first case follows from induction, the bifunctoriality of the tensor product, and the naturality of $\alpha$, $\lambda$, $\rho$, $\sw$, their inverses, and their respective compositions.
\begin{align*}
  &[\![E, Z \vljud \text{case } v \,  \{\text{inl} (a) \Rightarrow w ;\, \text{inr} (b) \Rightarrow u\} [t/x]]\!] \\
  & \triangleq \left[[\![ w ]\!] ,[\![ u ]\!]\right] \comp (\text{jn}\comp \sw \oplus \text{jn} \comp \sw) \comp \dist \comp  ([\![ v [t/x] ]\!]   \otimes \text{id})  \comp \text{sp} \comp \text{sh} \\
  & = \left[[\![ w ]\!] ,[\![ u ]\!]\right] \comp (\text{jn} \comp \sw \oplus \text{jn} \comp \sw)  \comp \dist \comp (([\![ v]\!]  \comp \text{jn} \comp (\text{id} \otimes [\![  t ]\!] ) \comp \text{sp} )\otimes \text{id})  \comp \text{sp} \comp \text{sh} & {\text{(Induction)}} \\
  & =  \left[[\![ w ]\!] ,[\![ u ]\!]\right] \comp (\text{jn} \comp \sw \oplus \text{jn} \comp \sw)  \comp \dist  \comp ([\![ v]\!] \otimes \text{id}) \comp (\text{jn} \comp (\text{id} \otimes [\![  t ]\!] ) \comp \text{sp} \otimes \text{id})  \comp \text{sp}\comp \text{sh}\\
  & = \left[[\![ w ]\!] ,[\![ u ]\!]\right] \comp (\text{jn} \comp \sw \oplus \text{jn} \comp \sw)  \comp \dist  \comp ([\![ v]\!] \otimes \text{id})  \comp (\text{jn} \comp (\text{id} \otimes [\![  t ]\!] ) \comp \text{sp} \otimes \text{id})  \comp \text{sp} \comp \text{sh} \comp \text{jn} \comp \text{sp} & {(\text{Coherence})} \\
  & = \left[[\![ w ]\!] ,[\![ u ]\!]\right] \comp (\text{jn} \comp \sw \oplus \text{jn} \comp \sw)  \comp \dist  \comp ([\![ v]\!] \otimes \text{id}) \comp (\text{jn}\comp \text{sp} \otimes   \id) \comp \text{sp}   \comp \text{sh} \comp \text{jn}\comp (\text{id} \otimes [\![ t ]\!] ) \comp \text{sp}  & {(\text{Naturality})}   \\
  & = \left[[\![ w ]\!] ,[\![ u ]\!]\right] \comp (\text{jn} \comp \sw \oplus \text{jn}\comp \sw)  \comp \dist  \comp ([\![ v]\!] \otimes \text{id}) \comp \text{sp}  \comp \text{sh}  \comp  \text{jn} \comp (\text{id} \otimes [\![ t ]\!] ) \comp \text{sp}  & {(\text{Coherence})}   \\
  & \triangleq \, [\![E,  x \vljud \text{case } v\,  \{\text{inl} (x) \Rightarrow w ;\, \text{inr} (y) \Rightarrow u\}]\!]  \comp  \text{jn} \comp (\text{id} \otimes [\![ t ]\!] ) \comp \text{sp}
\end{align*}
The second case follows from induction, the exchange rule, the universal property of the coproduct,  the bifunctoriality of the tensor product, and the naturality of $\alpha$, $\lambda$, $\rho$, and $\sw$, along with their inverses and respective compositions.
\begin{align*}
  &[\![E, Z \vljud \text{case } v \,  \{\text{inl} (a) \Rightarrow w ;\, \text{inr} (b) \Rightarrow u\} [t/x]]\!] \\
  & \triangleq \left[[\![ \Delta  , Z ,  a:\typeD \vljud w[t/x] ]\!] ,[\![ \Delta, Z, b:\typeE \vljud u[t/x]  ]\!] \right] \comp (\text{jn}\comp \sw \oplus \text{jn} \comp \sw) \comp \dist  \comp ([\![ v ]\!]   \otimes \text{id})    \comp \text{sp} \comp \text{sh} \hspace{10pt} \\
  & =  \left[[\![ \Delta  ,   a:\typeD, Z \vljud w[t/x] ]\!] ,[\![ \Delta, b:\typeE, Z \vljud u[t/x]  ]\!] \right] \comp ( \text{exch}_{\Delta,Z,\typeD} \comp \text{jn}\comp \sw \oplus  \text{exch} \comp \text{jn} \comp \sw)   \comp \dist   & {(\text{Exchange and}} \\
  &  \hspace{10pt} \comp \sw  \comp ([\![v]\!] \otimes \text{id})  \comp \text{sp} \comp \text{sh} & { \text{coproduct laws})}   \\
  & =   \left[[\![w ]\!] ,[\![ u]\!] \right] \comp ( \text{jn} \comp (\text{id} \otimes [\![t]\!] ) \comp \text{sp} \comp  \text{exch} \comp \text{jn} \comp \sw  \oplus  \text{jn} \comp (\text{id} \otimes [\![ t]\!] ) \comp \text{sp}  \comp \text{exch} \comp\text{jn} \comp \sw ) \comp \dist & {\text{(Induction)}}  \\
  & \hspace{10pt}     \comp ([\![v]\!] \otimes \text{id})  \comp \text{sp} \comp \text{sh} \\
  & =  \left[[\![w ]\!] ,[\![ u]\!] \right] \comp (\text{exch} \comp \text{jn} \comp \sw \comp (\text{id} \otimes  \text{jn} ) \comp (\text{id} \otimes [\![t]\!]) \comp  (\text{id} \otimes \text{sp} ) \oplus \text{exch} \comp \text{jn} \comp \sw \comp (\text{id} \otimes  \text{jn} )   & {(\text{Naturality and }} \\
  & \hspace{10pt} \comp (\text{id} \otimes [\![t]\!]) \comp  (\text{id} \otimes \text{sp} ) )\comp \dist \comp ([\![v]\!] \otimes \text{id})  \comp \text{sp} \comp \text{sh} & {\text{coproduct laws})} \\
  & =  \left[[\![w]\!] ,[\![u]\!] \right] \comp (\text{exch} \comp \text{jn} \comp \sw \comp (\text{id} \otimes  (\text{jn} \comp \text{id} \otimes [\![t]\!] \comp \text{sp}) ) \oplus  \text{exch} \comp \text{jn} \comp \sw  &  \\
  & \hspace{10pt}  \comp (\text{id} \otimes  (\text{jn}\comp \text{id} \otimes [\![t]\!] \comp \text{sp}) ))\comp \dist \comp ([\![v]\!] \otimes \text{id}) \comp \text{sp}\comp \text{sh}  \\
  & = [[\![ \Delta  , x:\typeA ,  a:\typeD \vljud w]\!] , [\![ \Delta  , x:\typeA ,  b:\typeE \vljud u]\!]]  \comp (  \text{jn} \comp \sw \comp (\text{id} \otimes  (\text{jn} \comp \id \otimes [\![t]\!]  \comp \text{sp})  \oplus \text{jn} \comp  \sw      & {(\text{Exchange and }}  \\
  & \hspace{10pt} \comp (\text{id} \otimes  (\text{jn} \comp \text{id} \otimes [\![t]\!] \comp \text{sp}) )  ) \comp \dist \comp ([\![v]\!] \otimes \text{id})   \comp \text{sp}\comp \text{sh}  & { \text{coproduct laws})}\\
  &= \left[[\![w ]\!] ,[\![ u]\!] \right] \comp  (\text{jn} \comp \sw \oplus \text{jn} \comp \sw)  \comp \dist \comp ( \text{id} \otimes (\text{jn} \cdot (\text{id} \otimes [\![t]\!]) \cdot \text{sp} ) ) \comp ([\![v]\!] \otimes \text{id}) \comp \text{sp} \comp \text{sh} & {(\text{Coproduct laws}}  \\
  & & {\text{and naturality}}) \\
  & =  \left[[\![w ]\!] ,[\![ u]\!] \right] \comp  (\text{jn} \comp \sw \oplus \text{jn}\comp \sw)  \comp \dist \comp  ([\![v]\!] \otimes \text{id}) \comp \text{sp} \comp ( \text{id} \otimes (\text{jn} \comp  (\text{id} \otimes [\![t]\!]) \cdot \text{sp} ) ) \comp \text{sp}\comp \text{sh}     & {(\text{Coherence})} \\
  &  \hspace{10pt}  \comp \text{jn}  \comp \text{sp} & \\
  & = \left[[\![w ]\!] ,[\![ u]\!] \right] \comp  (\text{jn} \comp \sw \oplus \text{jn} \comp \sw)  \comp \dist \comp  ([\![v]\!] \otimes \text{id})  \comp ( \id \otimes \text{jn} \comp \text{sp}) \comp \text{sp}  \comp \text{sh}    \comp \text{jn} \comp (\text{id} \otimes [\![ t ]\!] ) \comp \text{sp} & {(\text{Naturality})}   \\
  & =  [[\![w]\!], [\![u]\!]] \comp (\text{jn} \comp \sw \oplus \text{jn} \comp \sw)  \comp \dist   \comp ([\![v  ]\!] \otimes \text{id}) \comp \text{sp} \comp \text{sh} \comp \text{jn} \comp (\text{id} \otimes [\![ t ]\!] ) \comp \text{sp}  & {(\text{Coherence})}     \\ 
  & \triangleq  [\![E,  x\vljud \text{case } v\,  \{\text{inl} (a) \Rightarrow w ;\, \text{inr} (b) \Rightarrow u\}]\!] \comp \text{jn} \comp (\text{id} \otimes [\![ t ]\!] ) \comp \text{sp}
\end{align*}
\end{proof}

\begin{theorem} \label {theorem:eq_in_context}
  The equations presented in Figure \ref{fig:equations-in-context-cond} are sound w.r.t. judgement interpretation. More specifically if $ \Gamma \vljud v = w: \typeA$ is one of the equations in Figure \ref{fig:equations-in-context-cond} then $[\![ \Gamma \vljud v: \typeA ]\!] = [\![ \Gamma \vljud w: \typeA ]\!]$.
\end{theorem}

\begin{proof}
  Follows from Lemma \autoref{lem_interpret_exch:sub}, the coherence theorem for symmetric monoidal categories, naturality,  the bifunctoriality of the tensor product, and the universal property of the coproduct.   
  We will provide a complete proof for the first and third equations, noting that the proof for the second equation follows analogously from the first.
  \begin{align*}
    &\llbracket \Delta,\Gamma \vljud  \text{case }  \text{inl}(v)\, \{\text{inl} (x) \Rightarrow w ;\, \text{inr}_{\typeA} (y) \Rightarrow u\} \rrbracket \\
    & \triangleq  [\llbracket w\rrbracket,\llbracket u \rrbracket] \comp (\text{jn} \comp \sw \oplus \text{jn} \comp \sw  ) \comp \dist \comp \sw \comp (\inl \comp \llbracket  v \rrbracket \otimes \text{id}) \comp \text{sp} \comp \text{sh} \\
    & =  [\llbracket w\rrbracket,\llbracket u \rrbracket] \comp (\text{jn} \comp \sw \oplus \text{jn} \comp \sw ) \comp \dist \comp (\inl \otimes \text{id}  ) \comp ( \llbracket  v \rrbracket \otimes \text{id}) \comp \text{sp} \comp \text{sh}  \\
    & =  [\llbracket w\rrbracket,\llbracket u \rrbracket] \comp (\text{jn} \comp \sw \oplus \text{jn} \comp \sw ) \comp \dist \comp [\inl \otimes \id, \inr \otimes \id] \comp \inl  \comp ( \llbracket  v \rrbracket \otimes \text{id}) \comp \text{sp} \comp \text{sh}  &(\text{Coproduct laws})\\
    & =  [\llbracket w\rrbracket,\llbracket u \rrbracket] \comp (\text{jn} \comp \sw \oplus \text{jn} \comp \sw )  \comp \inl  \comp ( \llbracket  v \rrbracket \otimes \text{id}) \comp \text{sp} \comp \text{sh} \\
    & = \llbracket  w \rrbracket\comp \text{jn} \comp   \sw \comp(\llbracket v \rrbracket \otimes  \text{id}) \comp \text{sp} \comp \text{sh} & {\text{(Coproduct laws)}} \\
    &=  \llbracket  w \rrbracket\comp \text{jn} \comp(  \text{id}\otimes \llbracket v \rrbracket ) \comp   \sw \comp \text{sp} \comp \text{sh} & {\text{(Naturality)}} \\
    &= \llbracket w \rrbracket \comp \text{jn} \comp( \text{id} \otimes \llbracket v \rrbracket) \comp \text{sp} & {\text{(Coherence)}}\\
    & = \llbracket w[v/x]  \rrbracket  & {\text{(Lemma \ref{lem_interpret_exch:sub})}}
\end{align*}

Regarding the third equation, we have that
\begin{align*}
  & \llbracket \Delta,\Gamma \vljud \text{case } v\, \{\text{inl}_{\typeB} (y) \Rightarrow w [ \text{inl}_{\typeB}(y)/x] ;\, \text{inr}_{\typeA} (z) \Rightarrow w [ \text{inr}_{\typeA}(z)/x]\}: \typeD\rrbracket \\
  & \triangleq  [\llbracket  w [ \text{inl}_{\typeB}(y)/x] \rrbracket, \llbracket  w [ \text{inr}_{\typeA}(z)/x] \rrbracket] \comp (\text{jn}_{\Delta;\typeA} \comp \sw \oplus \text{jn} \comp \sw  ) \comp \dist \comp (\llbracket v\rrbracket \otimes \text{id}) \comp  \text{sp} \comp \text{sh} \\
  & = \llbracket w \rrbracket \comp [\text{jn} \comp (\text{id} \otimes\inl \comp  \llbracket y:\typeA \vljud y:\typeA  \rrbracket) \comp \text{sp} \comp \text{jn} \comp \sw , 
   \text{jn}\comp (\text{id} \otimes\inr  \comp \llbracket z:\typeB \vljud z:\typeB  \rrbracket)   & {\text{(Lemma \ref{lem_interpret_exch:sub} and}} \\
  &  \hspace{10pt}\comp \text{sp} \comp \text{jn} \comp \sw  ] \comp \dist \comp (\llbracket v\rrbracket \otimes \text{id}) \comp  \text{sp} \comp \text{sh} & {\text{coproduct laws)}}  \\
  & =  \llbracket w \rrbracket \comp \text{jn} \comp [ (\text{id} \otimes\inl)  \comp \sw  ,     \comp (\text{id} \otimes\inr) \comp \sw  ] \comp \dist  \comp (\llbracket v \oplus \typeB\rrbracket \otimes \text{id})  \comp  \text{sp} \comp \text{sh}  & {\text{(Coherence and}}   \\
  & \hspace{10pt} & {\text{coproduct laws)}}   \\
  & = \llbracket w \rrbracket \comp \text{jn} \comp   \sw \comp  [\inl \otimes \text{id} , \inr \otimes \text{id}] \comp \dist   \comp (\llbracket v \oplus \typeB\rrbracket \otimes \text{id})  \comp  \text{sp}\comp \text{sh}  & {\text{(Naturality and}}  \\
  & \hspace{10pt} & {\text{coproduct laws})}   \\
  %& = \llbracket w \rrbracket \comp \text{jn}_{\Delta;\typeA \oplus \typeB} \comp \comp \sw \text{id}   \comp (\llbracket v \oplus \typeB\rrbracket \otimes \text{id})  \comp  \text{sp}_{\Gamma;\Delta} \comp \text{sh}_{\Delta;\Gamma}  \\
  & = \llbracket w \rrbracket \comp \text{jn} \comp ( \text{id} \otimes \llbracket v \oplus \typeB\rrbracket )  \comp  \sw  \comp  \text{sp} \comp \text{sh} & {\text{(Naturality)}}\\
  &  = \llbracket w \rrbracket \comp \text{jn} \comp ( \text{id} \otimes \llbracket v \oplus \typeB\rrbracket )  \comp  \text{sp} & {\text{(Coherence)}}\\
  & \triangleq \llbracket w[v/x] : \typeD \rrbracket & {\text{(Lemma \ref{lem_interpret_exch:sub})}}
\end{align*}
\end{proof}

\begin{definition}
  Consider a tuple $(G, \Sigma)$ consisting of a class $G$ of ground types and a class $\Sigma$ of sorted operation symbols. A \emph{linear} $\lambda$-\emph{theory} $((G, \Sigma), \textit{Ax})$ is a triple such that \emph{Ax} is a class of equations-in-context over linear $\lambda$-terms built from $(G, \Sigma)$.
\end{definition}

The elements of \emph{Ax} are called the axioms of the theory. Let \emph{Th(Ax)}  be the smallest congruence that contains \emph{Ax}, the equations-in-context, and that is closed under exchange
and substitution. We call the elements of  \emph{Th(Ax)} the \emph{theorems} of the theory.

\begin{definition}
  Consider a linear $\lambda$-theory $((\lambda, \Sigma), \emph{Ax})$ and
  also a distributive symmetric monoidal closed category $\catC$. Suppose that for each $X \in G$ we have an interpretation $\llbracket X \rrbracket$
  that is a $\catC$-object and analogously for the operation symbols. This interpretation structure
  is a \emph{model} of the theory if all axioms are satisfied by the interpretation.
\end{definition}

\begin{theorem} \label {theorem:comp_eq_in_context}
  The equations presented in Figure \ref{fig:equations-in-context-cond} are complete w.r.t. judgment interpretation. More specifically, by combining these equations with the remaining equations from the linear lambda calculus, it becomes possible to derive the properties that must necessarily hold in every model.
\end{theorem}

\begin{proof}
  Completeness arises from constructing the syntactic category $\catSyn(\mathscr{T})$ of a $\lambda$-theory $\mathscr{T}$ (also known as term model). By employing the equations in Figure \ref{fig:equations-in-context-cond}, we show that both the universal property of the coproduct and the distributive property are satisfied in $\catSyn(\mathscr{T})$. The syntactic category of $\mathscr{T}$ has as objects the types of $\mathscr{T}$ and as morphisms $A \rightarrow B$ the equivalence classes (w.r.t. provability) of terms $v$ for which we can derive $x : \typeA \vljud v : \typeB$.

  In the syntactic category, the coproduct $[ p ,  q]$ can be seen as the equivalence
  class 
  $$\left[z:\typeA \oplus\typeB \vljud \text{case } z\,\{\inl_{\typeB}(x) \Rightarrow p ; \, \inr_{\typeA}(y) \Rightarrow q\}: \typeD\right],$$ 
  the distributive property, $\dist$, corresponds to the class 
  \begin{align*}
    \big[z:(\typeA \otimes \mathbb{\typeB}) \otimes \mathbb{\typeD} \vljud \text{pm } z \text{ to } a \otimes b. \text{ case } a\,\{ &\inl_{\typeB}(x) \Rightarrow \inl_{\typeB \otimes \typeD}(x \otimes b); \\
    & \inr_{\typeA}(y) \Rightarrow \inr_{\typeA \otimes \typeD} (y \otimes b)\}: (\typeA \otimes \typeD) \oplus (\typeB \otimes \typeD)\big],
  \end{align*}
and its inverse, $[\inl \otimes \id, \inr \otimes \id]$, to the class
\begin{align*}
  \big[z: (\typeA \otimes \typeD) \oplus (\typeB \otimes \typeD) \vljud  \text{ case } z \,\{ &\inl_{\typeB}(x) \Rightarrow \text{pm } x \text{ to } a \otimes b. \, \inl_{\typeB}(a) \otimes b; \\
  & \inr_{\typeA}(y) \Rightarrow \text{pm } y \text{ to } a' \otimes b'. \, \inr_{\typeA}(a') \otimes b'\}: (\typeA \otimes \mathbb{\typeB}) \otimes \mathbb{\typeD}\big].
\end{align*}


The proof of the coproduct diagram comutes follow directly from the $\beta$-equations in Figure \ref{fig:equations-in-context-cond}, $\alpha$-equivalence, and Lemma \ref{lem:exh_and_sub}. Specifically, for the left triangle in the coproduct diagram, we have that:
  \begin{align*}
    & \left[z:\typeA \oplus \typeB  \vljud \text{case } v\,\{\inl_{\typeB}(x) \Rightarrow p ; \, \inr_{\typeA}(y) \Rightarrow q\}: \typeD\right] \comp \left[ x: \typeA\vljud \inl_{\typeB}(x): \typeA \oplus \typeB \right]  \\
    =& \left(z:\typeA \oplus \typeB  \vljud \text{case } v\,\{\inl_{\typeB}(x) \Rightarrow p ; \, \inr_{\typeA}(y) \Rightarrow q\}: \typeD\right) \comp \left( x: \typeA\vljud \inl_{\typeB}(x): \typeA \oplus \typeB \right) 
   \\
    =& z:\typeA \oplus \typeB  \vljud \text{case } v\,\{\inl_{\typeB}(x') \Rightarrow p[x'/ x] ; \, \inr_{\typeA}(y) \Rightarrow q\}: \typeD \comp  x: \typeA\vljud \inl_{\typeB}(x): \typeA \oplus \typeB & (\alpha)\\
    = & x:\typeA \vljud \text{case } \inl(x) \,\{\inl_{\typeB}(x') \Rightarrow p[x'/ x] ; \, \inr_{\typeA}(y) \Rightarrow q\}: \typeD & (\text{Lemma } \ref{lem:exh_and_sub})  \\
    = &  x:\typeA \vljud p[x'/x][x/x']: \typeD & (\beta_{\text{case}}^{\text{inl}}) \\
    = & x:\typeA \vljud p: \typeD \\
    = &  \left[x:\typeA \vljud p: \typeD\right]  \\
  \end{align*}
  The proof for the right triangle in the coproduct diagram is analogous.
 
  Regarding the unicity of the coproduct, the key aspect of the proof lies in proving that the following equality holds: 
  $$\left[z:\typeA \oplus \typeB  \vljud \text{case } z \,\{\inl_{\typeB}(x) \Rightarrow m[\inl_{\typeB}(x)/ z] ; \, \inr_{\typeA}(y) \Rightarrow m[\inr_{\typeA}(x)/ z]\}: \typeD\right] = [z:\typeA \oplus \typeB \vljud m: \typeD].$$ 
  This equality follows direct from the $\eta$-equation in Figure \ref{fig:equations-in-context-cond}. Now, considering any morphism $m'$ from $\typeA \oplus \typeB$ to $\typeD$ and the coproduct diagram, we have that 
  %$$\left[z:\typeA \oplus \typeB  \vljud m': \typeD\right] \comp \left[ x: \typeA\vljud \inl_{\typeB}(x): \typeA \oplus \typeB \right] = \left[x: \typeA  \vljud p: \typeD\right]  $$ 
  $$\left[ x: \typeA \vljud m'[ \inl_{\typeB}(x)/z]: \typeD\right]  = \left[x: \typeA  \vljud p: \typeD\right]  $$ 
  and
  $$\left[ y: \typeB  \vljud m'[\inr_{\typeA}(y)/z]: \typeD\right] = \left[y: \typeB  \vljud q: \typeD\right].$$
  As a result, if follows from the equalities above that 
  \begin{align*}
    \left[z:\typeA \oplus \typeB  \vljud m': \typeD\right]& =\left[z:\typeA \oplus \typeB  \vljud \text{case } z \,\{\inl_{\typeB}(x) \Rightarrow m'[\inl_{\typeB}(x)/ z] ; \, \inr_{\typeA}(y) \Rightarrow m'[\inr_{\typeA}(x)/ z]\}: \typeD\right]\\
    & = \left[z:\typeA \oplus \typeB  \vljud \text{case } z \,\{\inl_{\typeB}(x) \Rightarrow p ; \, \inr_{\typeA}(y) \Rightarrow q\}: \typeD\right]. 
  \end{align*}
 
 
  To prove that the distributive property is an isomorphism syntactically, we first establish that the following equality, known  as the \emph{syntactic fusion law}, holds:
  \begin{equation*}
    \left[v\left[ \left(\text{case } a \,\{\inl_{\typeB}(x) \Rightarrow w ; \, \inr_{\typeA}(y) \Rightarrow u\}\right)  / z \right]\right] =   \left[\text{case } a \,\{\inl_{\typeB}(x) \Rightarrow v[w/z] ; \, \inr_{\typeA}(y) \Rightarrow v[u/z]\} \right].
  \end{equation*}
It should be noted that this equality corresponds semantically to the property  $ \llbracket v \rrbracket \comp [ \llbracket w \rrbracket,  \llbracket u \rrbracket] = [ \llbracket v \rrbracket \comp \llbracket w \rrbracket,\llbracket v \rrbracket \comp \llbracket u \rrbracket ] $.
This equality follows from the $\alpha$-equivalence and the equations in Figure \ref{fig:equations-in-context-cond}. 
\begin{align*}
  &\left[v\left[ \left(\text{case } a \,\{\inl_{\typeB}(x) \Rightarrow w ; \, \inr_{\typeA}(y) \Rightarrow u\}\right)  / z \right]\right] & \\
  &  = v \left[ \left(\text{case } a \,\{\inl_{\typeB}(x) \Rightarrow w ; \, \inr_{\typeA}(y) \Rightarrow u\}\right)  / z \right] & \\
  & =v  \left[ \left(\text{case } a \,\{\inl_{\typeB}(x') \Rightarrow w[x'/x] ; \, \inr_{\typeA}(y') \Rightarrow u[y'/y]\}\right)  / z \right] & (\alpha) \\
  & = \big[ \text{case } a \,\{\inl_{\typeB}(x) \Rightarrow v[\text{case } \inl_{\typeB}(x) \,\{\inl_{\typeB}(x') \Rightarrow w[x'/x] ; \, \inr_{\typeA}(y) \Rightarrow u[y'/y]\}/z] ; \, & (\eta_{\text{case}}) \ \\
   & \hspace{50pt} \inr_{\typeA}(y) \Rightarrow  v[\text{case } \inr_{\typeA}(y) \,\{\inl_{\typeB}(x') \Rightarrow w[x'/x] ; \, \inr_{\typeA}(y) \Rightarrow u[y'/y]\}/z]\}\big]  \\
   & = \text{case } a \,\{\inl_{\typeB}(x) \Rightarrow v[w[x'/x][x/x']/z] ; \, \inr_{\typeA}(y) \Rightarrow v[u[y'/y][y/y']/z]\}   & (\beta_{\text{case}}^{\text{inl}} \text{ and } \beta_{\text{case}}^{\text{inr}}  ) \\
   & =  \text{case } a \,\{\inl_{\typeB}(x) \Rightarrow v[w/z] ; \, \inr_{\typeA}(y) \Rightarrow v[u/z]\}  \\
   & = \left[ \text{case } a \,\{\inl_{\typeB}(x) \Rightarrow v[w/z] ; \, \inr_{\typeA}(y) \Rightarrow v[u/z]\}\right] 
\end{align*}
The proof that the distributive property is an isomorphism follows from the syntactic fusion law, the equations in Figure \ref{fig:equations-in-context-cond}, the equations $\beta_{\otimes_{e}}$ and $\eta_{\otimes_{e}}$, the $\alpha$-equivalence, and Lemma \ref{lem:exh_and_sub}. 
\begin{align*}
  &\left[ \text{pm } z \text{ to } a \otimes b. \text{ case } a\, \left\{ \begin{aligned}
    &\inl_{\typeB}(x) \Rightarrow \inl_{\typeB \otimes \typeD}(x \otimes b);\\
    &\inr_{\typeA}(y) \Rightarrow \inr_{\typeA \otimes \typeD} (y \otimes b)
\end{aligned} \right\} \right] \\
 \cdot &   \left[ \text{case } z' \,  \left\{\begin{aligned} 
  &\inl_{\typeB}(x') \Rightarrow \text{pm } x' \text{ to } a' \otimes b'. \, \inl_{\typeB}(a') \otimes b';\\
  &\inr_{\typeA}(y') \Rightarrow \text{pm } y' \text{ to } a'' \otimes b''. \, \inr_{\typeA}(a'') \otimes b'' 
\end{aligned}  \right\}\right] \\
& =  \text{pm } z \text{ to } a \otimes b. \text{ case } a\, \left\{ \begin{aligned}
  &\inl_{\typeB}(x) \Rightarrow \inl_{\typeB \otimes \typeD}(x \otimes b);\\
  &\inr_{\typeA}(y) \Rightarrow \inr_{\typeA \otimes \typeD} (y \otimes b)
\end{aligned} \right\}  \\
& \hspace{10pt} \cdot    \text{case } z' \,  \left\{\begin{aligned} 
&\inl_{\typeB}(x') \Rightarrow \text{pm } x' \text{ to } a' \otimes b'. \, \inl_{\typeB}(a') \otimes b';\\
&\inr_{\typeA}(y') \Rightarrow \text{pm } y' \text{ to } a'' \otimes b''. \, \inr_{\typeA}(a'') \otimes b'' 
\end{aligned}  \right\} \\
& =   \text{case } z' \,  
\left\{
  \begin{aligned} 
  &\inl_{\typeB}(x') \Rightarrow \text{pm }  (\text{pm } x' \text{ to } a' \otimes b'. \, \inl_{\typeB}(a') \otimes b')  \text{ to } a \otimes b . \\  
  & \hspace{10pt}\text{ case } a\, \Bigg\{ 
    \begin{aligned}
    & \inl_{\typeB}(x) \Rightarrow \inl_{\typeB \otimes \typeD}(x \otimes b);\\
    & \inr_{\typeA}(y) \Rightarrow \inr_{\typeA \otimes \typeD} (y \otimes b)
    \end{aligned} \Bigg\} \\
  &\inr_{\typeA}(y') \Rightarrow \text{pm }  (\text{pm } y' \text{ to } a'' \otimes b''. \, \inl_{\typeB}(a'') \otimes b'')  \text{ to } a \otimes b . \\ 
  & \hspace{10pt}\text{ case } a\, \Bigg\{ 
    \begin{aligned}
    & \inl_{\typeB}(x) \Rightarrow \inl_{\typeB \otimes \typeD}(x \otimes b);\\
    & \inr_{\typeA}(y) \Rightarrow \inr_{\typeA \otimes \typeD} (y \otimes b)
    \end{aligned} \Bigg\} \\ 
\end{aligned}  
\right\} & (\text{fusion law}) \\
& =  \text{case } z' \,  
\left\{
  \begin{aligned} 
  &\inl_{\typeB}(x') \Rightarrow \text{pm }  \inl_{\typeB}(a') \otimes b' [x'/a' \otimes b']  \text{ to } a \otimes b . \\  
  & \hspace{10pt}\text{ case } a\, \Bigg\{ 
    \begin{aligned}
    & \inl_{\typeB}(x) \Rightarrow \inl_{\typeB \otimes \typeD}(x \otimes b);\\
    & \inr_{\typeA}(y) \Rightarrow \inr_{\typeA \otimes \typeD} (y \otimes b)
    \end{aligned} \Bigg\} \\
  &\inr_{\typeA}(y') \Rightarrow \text{pm }  \inl_{\typeB}(a'') \otimes b'' [y'/ a'' \otimes y'']  \text{ to } a \otimes b . \\ 
  & \hspace{10pt}\text{ case } a\, \Bigg\{ 
    \begin{aligned}
    & \inl_{\typeB}(x) \Rightarrow \inl_{\typeB \otimes \typeD}(x \otimes b);\\
    & \inr_{\typeA}(y) \Rightarrow \inr_{\typeA \otimes \typeD} (y \otimes b)
    \end{aligned} \Bigg\}  \\ 
\end{aligned}  
\right\}  & (\eta_{\otimes_{e}}) \\
& =   \text{case } z' \,  
\left\{
  \begin{aligned} 
  &\inl_{\typeB}(x') \Rightarrow \text{ case } \inl_{\typeB}(a')\, \Bigg\{ 
    \begin{aligned}
    & \inl_{\typeB}(x) \Rightarrow \inl_{\typeB \otimes \typeD}(x \otimes b');\\
    & \inr_{\typeA}(y) \Rightarrow \inr_{\typeA \otimes \typeD} (y \otimes b')
    \end{aligned} \Bigg\} [x'/a' \otimes b'] \\
  &\inr_{\typeA}(y') \Rightarrow \text{ case } \inl_{\typeA}(a'')\, \Bigg\{ 
    \begin{aligned}
    & \inl_{\typeB}(x) \Rightarrow \inl_{\typeB \otimes \typeD}(x \otimes b');\\
    & \inr_{\typeA}(y) \Rightarrow \inr_{\typeA \otimes \typeD} (y \otimes b')
    \end{aligned} \Bigg\} [y'/a'' \otimes b'']  \\ 
\end{aligned}  
\right\}  &  (\beta_{\otimes_{e}}) \\
& =  \text{case } z' \,  
\left\{
  \begin{aligned} 
  &\inl_{\typeB}(x') \Rightarrow \inl_{\typeB \otimes \typeD}(x \otimes b') [x'/a' \otimes b'] [a'/x]; \\
  &\inr_{\typeA}(y') \Rightarrow  \inl_{\typeB \otimes \typeD}(x \otimes b') [y'/a'' \otimes b''] [a''/y']  
  \end{aligned}  
\right\}  &  (\beta_{\text{case}}^{\text{inl}} \text{ and } \beta_{\text{case}}^{\text{inr}}  )  \\
& =  \text{case } z' \,
\left\{
  \begin{aligned} 
  &\inl_{\typeB}(x') \Rightarrow \inl_{\typeB \otimes \typeD}(x'); \\
  &\inr_{\typeA}(y') \Rightarrow  \inl_{\typeB \otimes \typeD}(y') 
  \end{aligned}
\right\}  & \\
& =  \text{case } z' \,
\left\{
  \begin{aligned} 
  &\inl_{\typeB}(x') \Rightarrow c[\inl_{\typeB \otimes \typeD}(x')/c]; \\
  &\inr_{\typeA}(y') \Rightarrow  c[\inl_{\typeB \otimes \typeD}(y')/c] 
  \end{aligned}
\right\}  & (\alpha) \\
& =  z' = [z'] & (\eta_{\text{case}}) 
\end{align*}

\begin{align*}
&   \left[ \text{case } z' \,  \left\{
  \begin{aligned} 
  &\inl_{\typeB}(x') \Rightarrow \text{pm } x' \text{ to } a' \otimes b'. \, \inl_{\typeB}(a') \otimes b';\\
  &\inr_{\typeA}(y') \Rightarrow \text{pm } y' \text{ to } a'' \otimes b''. \, \inr_{\typeA}(a'') \otimes b'' 
  \end{aligned}  \right\}\right] \\
\comp & \left[ \text{pm } z \text{ to } a \otimes b. \text{ case } a\, \left\{ 
  \begin{aligned}
    &\inl_{\typeB}(x) \Rightarrow \inl_{\typeB \otimes \typeD}(x \otimes b);\\
    &\inr_{\typeA}(y) \Rightarrow \inr_{\typeA \otimes \typeD} (y \otimes b)
  \end{aligned} \right\} \right] \\
& =  \text{case } z' \,  \left\{
  \begin{aligned} 
  &\inl_{\typeB}(x') \Rightarrow \text{pm } x' \text{ to } a' \otimes b'. \, \inl_{\typeB}(a') \otimes b';\\
  &\inr_{\typeA}(y') \Rightarrow \text{pm } y' \text{ to } a'' \otimes b''. \, \inr_{\typeA}(a'') \otimes b'' 
  \end{aligned}  \right\} \\
& \hspace{10pt}\comp   \text{pm } z \text{ to } a \otimes b. \text{ case } a\, \left\{ 
  \begin{aligned}
    &\inl_{\typeB}(x) \Rightarrow \inl_{\typeB \otimes \typeD}(x \otimes b);\\
    &\inr_{\typeA}(y) \Rightarrow \inr_{\typeA \otimes \typeD} (y \otimes b)
  \end{aligned} \right\} \\
& =  \text{case } 
  \left( \text{pm } z \text{ to } a \otimes b. \text{ case } a\, \left\{ 
  \begin{aligned}
    &\inl_{\typeB}(x) \Rightarrow \inl_{\typeB \otimes \typeD}(x \otimes b);\\
    &\inr_{\typeA}(y) \Rightarrow \inr_{\typeA \otimes \typeD} (y \otimes b)
  \end{aligned} \right\} \right) \\
   & \hspace{40pt} \left\{
  \begin{aligned} 
  &\inl_{\typeB}(x') \Rightarrow \text{pm } x' \text{ to } a' \otimes b'. \, \inl_{\typeB}(a') \otimes b';\\
  &\inr_{\typeA}(y') \Rightarrow \text{pm } y' \text{ to } a'' \otimes b''. \, \inr_{\typeA}(a'') \otimes b'' 
  \end{aligned}  \right\} & (\text{Lemma } \ref{lem:exh_and_sub})
\\
  & =    \text{case } 
    \left( \text{case } a\, \left\{ 
    \begin{aligned}
      &\inl_{\typeB}(x) \Rightarrow \inl_{\typeB \otimes \typeD}(x \otimes b);\\
      &\inr_{\typeA}(y) \Rightarrow \inr_{\typeA \otimes \typeD} (y \otimes b)
    \end{aligned} \right\} [z/ a \otimes b] \right) \\
    & \hspace{40pt}  \left\{
    \begin{aligned} 
    &\inl_{\typeB}(x') \Rightarrow  \inl_{\typeB}(a') \otimes b' \, [x'/a' \otimes b'];\\
    &\inr_{\typeA}(y') \Rightarrow  \inr_{\typeA}(a'') \otimes b''\, [y'/a'' \otimes b'']
    \end{aligned}  \right\} &  (\eta_{\otimes_{e}}) \\
  & =   \text{case } a\, \left\{ 
    \begin{aligned}
      &\inl_{\typeB}(x) \Rightarrow \text{case } \left(\inl_{\typeB \otimes \typeD}(x \otimes b)\right) \Bigg\{ 
        \begin{aligned} 
        &\inl_{\typeB}(x') \Rightarrow  \inl_{\typeB}(a') \otimes b';\\
        &\inr_{\typeA}(y') \Rightarrow  \inr_{\typeA}(a'') \otimes b'' 
        \end{aligned} \Bigg\} \\  & [z/ a \otimes b] [x'/a'\otimes b'];\\
      &\inr_{\typeA}(y) \Rightarrow \text{case } \left(\inr_{\typeA \otimes \typeD} (y \otimes b)\right) \Bigg\{ 
        \begin{aligned} 
        &\inl_{\typeB}(x') \Rightarrow \inl_{\typeB}(a') \otimes b';\\
        &\inr_{\typeA}(y') \Rightarrow  \inr_{\typeA}(a'') \otimes b'' 
        \end{aligned} \Bigg\} \\&[z/ a \otimes b] [y'/a''\otimes b'']
    \end{aligned}  \right\}  & (\text{fusion law})\\
  & = \text{ case } a\, \left\{ 
    \begin{aligned}
      &\inl_{\typeB}(x) \Rightarrow  \inl_{\typeB}(a') \otimes b' [z/ a \otimes b] [x'/a'\otimes b'] [x \otimes b/ x'];\\
      &\inr_{\typeA}(y) \Rightarrow  \inr_{\typeA}(a'') \otimes b'' [z/ a \otimes b] [y'/a''\otimes b''] [x \otimes b/ y']
    \end{aligned} \right\}  & (\beta_{\text{case}}^{\text{inl}} \text{ and } \beta_{\text{case}}^{\text{inr}}) \\
  & = \text{ case } a\, \left\{ 
    \begin{aligned}
        &\inl_{\typeB}(x) \Rightarrow  \inl_{\typeB}(a') \otimes b' [z/ a \otimes b] [x \otimes b/a'\otimes b'];\\
        &\inr_{\typeA}(y) \Rightarrow  \inr_{\typeA}(a'') \otimes b'' [z/ a \otimes b] [x \otimes b/a''\otimes b''] 
    \end{aligned} \right\}  &  \\
  & = \text{ case } a\, \left\{
    \begin{aligned}
      &\inl_{\typeB}(x) \Rightarrow  \inl_{\typeB}(x) \otimes b;\\
      &\inr_{\typeA}(y) \Rightarrow  \inr_{\typeA}(x) \otimes b
    \end{aligned} \right\}  [z/ a \otimes b]  & (\beta_{\otimes_{e}}) \\
  & = a \otimes b [z/ a \otimes b] = z = [z] & (\eta_{\text{case}})
\end{align*} 

\end{proof}


\begin{comment}
\section{Typesetting instructions -- Summary}
\label{sec:typesetting-summary}


LIPIcs is a series of open access high-quality conference proceedings across all fields in informatics established in cooperation with Schloss Dagstuhl. 
In order to do justice to the high scientific quality of the conferences that publish their proceedings in the LIPIcs series, which is ensured by the thorough review process of the respective events, we believe that LIPIcs proceedings must have an attractive and consistent layout matching the standard of the series.
Moreover, the quality of the metadata, the typesetting and the layout must also meet the requirements of other external parties such as indexing service, DOI registry, funding agencies, among others. The guidelines contained in this document serve as the baseline for the authors, editors, and the publisher to create documents that meet as many different requirements as possible. 

Please comply with the following instructions when preparing your article for a LIPIcs proceedings volume. 
\paragraph*{Minimum requirements}

\begin{itemize}
\item Use pdflatex and an up-to-date \LaTeX{} system.
\item Use further \LaTeX{} packages and custom made macros carefully and only if required.
\item Use the provided sectioning macros: \verb+\section+, \verb+\subsection+, \verb+\subsubsection+, \linebreak \verb+\paragraph+, \verb+\paragraph*+, and \verb+\subparagraph*+.
\item Provide suitable graphics of at least 300dpi (preferably in PDF format).
\item Use BibTeX and keep the standard style (\verb+plainurl+) for the bibliography.
\item Please try to keep the warnings log as small as possible. Avoid overfull \verb+\hboxes+ and any kind of warnings/errors with the referenced BibTeX entries.
\item Use a spellchecker to correct typos.
\end{itemize}

\paragraph*{Mandatory metadata macros}
Please set the values of the metadata macros carefully since the information parsed from these macros will be passed to publication servers, catalogues and search engines.
Avoid placing macros inside the metadata macros. The following metadata macros/environments are mandatory:
\begin{itemize}
\item \verb+\title+ and, in case of long titles, \verb+\titlerunning+.
\item \verb+\author+, one for each author, even if two or more authors have the same affiliation.
\item \verb+\authorrunning+ and \verb+\Copyright+ (concatenated author names)\\
The \verb+\author+ macros and the \verb+\Copyright+ macro should contain full author names (especially with regard to the first name), while \verb+\authorrunning+ should contain abbreviated first names.
\item \verb+\ccsdesc+ (ACM classification, see \url{https://www.acm.org/publications/class-2012}).
\item \verb+\keywords+ (a comma-separated list of keywords).
\item \verb+\relatedversion+ (if there is a related version, typically the ``full version''); please make sure to provide a persistent URL, e.\,g., at arXiv.
\item \verb+\begin{abstract}...\end{abstract}+ .
\end{itemize}

\paragraph*{Please do not \ldots} %Do not override the \texttt{\seriesstyle}-defaults}
Generally speaking, please do not override the \texttt{lipics-v2021}-style defaults. To be more specific, a short checklist also used by Dagstuhl Publishing during the final typesetting is given below.
In case of \textbf{non-compliance} with these rules Dagstuhl Publishing will remove the corresponding parts of \LaTeX{} code and \textbf{replace it with the \texttt{lipics-v2021} defaults}. In serious cases, we may reject the LaTeX-source and expect the corresponding author to revise the relevant parts.
\begin{itemize}
\item Do not use a different main font. (For example, the \texttt{times} package is forbidden.)
\item Do not alter the spacing of the \texttt{lipics-v2021.cls} style file.
\item Do not use \verb+enumitem+ and \verb+paralist+. (The \texttt{enumerate} package is preloaded, so you can use
 \verb+\begin{enumerate}[(a)]+ or the like.)
\item Do not use ``self-made'' sectioning commands (e.\,g., \verb+\noindent{\bf My+ \verb+Paragraph}+).
\item Do not hide large text blocks using comments or \verb+\iffalse+ $\ldots$ \verb+\fi+ constructions. 
\item Do not use conditional structures to include/exclude content. Instead, please provide only the content that should be published -- in one file -- and nothing else.
\item Do not wrap figures and tables with text. In particular, the package \texttt{wrapfig} is not supported.
\item Do not change the bibliography style. In particular, do not use author-year citations. (The
\texttt{natbib} package is not supported.)
\end{itemize}

\enlargethispage{\baselineskip}

This is only a summary containing the most relevant details. Please read the complete document ``LIPIcs: Instructions for Authors and the \texttt{lipics-v2021} Class'' for all details and don't hesitate to contact Dagstuhl Publishing (\url{mailto:publishing@dagstuhl.de}) in case of questions or comments:
\href{http://drops.dagstuhl.de/styles/lipics-v2021/lipics-v2021-authors/lipics-v2021-authors-guidelines.pdf}{\texttt{http://drops.dagstuhl.de/styles/lipics-v2021/\newline lipics-v2021-authors/lipics-v2021-authors-guidelines.pdf}}

\section{Lorem ipsum dolor sit amet}

Lorem ipsum dolor sit amet, consectetur adipiscing elit \cite{DBLP:journals/cacm/Knuth74}. Praesent convallis orci arcu, eu mollis dolor. Aliquam eleifend suscipit lacinia. Maecenas quam mi, porta ut lacinia sed, convallis ac dui. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse potenti. Donec eget odio et magna ullamcorper vehicula ut vitae libero. Maecenas lectus nulla, auctor nec varius ac, ultricies et turpis. Pellentesque id ante erat. In hac habitasse platea dictumst. Curabitur a scelerisque odio. Pellentesque elit risus, posuere quis elementum at, pellentesque ut diam. Quisque aliquam libero id mi imperdiet quis convallis turpis eleifend. 

\begin{lemma}[Lorem ipsum]
\label{lemma:lorem}
Vestibulum sodales dolor et dui cursus iaculis. Nullam ullamcorper purus vel turpis lobortis eu tempus lorem semper. Proin facilisis gravida rutrum. Etiam sed sollicitudin lorem. Proin pellentesque risus at elit hendrerit pharetra. Integer at turpis varius libero rhoncus fermentum vitae vitae metus.
\end{lemma}

\begin{proof}
Cras purus lorem, pulvinar et fermentum sagittis, suscipit quis magna.


\proofsubparagraph*{Just some paragraph within the proof.}
Nam liber tempor cum soluta nobis eleifend option congue nihil imperdiet doming id quod mazim placerat facer possim assum. Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.
\begin{claim}
content...
\end{claim}
\begin{claimproof}
content...
    \begin{enumerate}
        \item abc abc abc \claimqedhere{}
    \end{enumerate}
\end{claimproof}

\end{proof}

\begin{corollary}[Curabitur pulvinar, \cite{DBLP:books/mk/GrayR93}]
\label{lemma:curabitur}
Nam liber tempor cum soluta nobis eleifend option congue nihil imperdiet doming id quod mazim placerat facer possim assum. Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.
\end{corollary}

\begin{proposition}\label{prop1}
This is a proposition
\end{proposition}

\autoref{prop1} and \cref{prop1} \ldots

\subsection{Curabitur dictum felis id sapien}

Curabitur dictum \cref{lemma:curabitur} felis id sapien \autoref{lemma:curabitur} mollis ut venenatis tortor feugiat. Curabitur sed velit diam. Integer aliquam, nunc ac egestas lacinia, nibh est vehicula nibh, ac auctor velit tellus non arcu. Vestibulum lacinia ipsum vitae nisi ultrices eget gravida turpis laoreet. Duis rutrum dapibus ornare. Nulla vehicula vulputate iaculis. Proin a consequat neque. Donec ut rutrum urna. Morbi scelerisque turpis sed elit sagittis eu scelerisque quam condimentum. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Aenean nec faucibus leo. Cras ut nisl odio, non tincidunt lorem. Integer purus ligula, venenatis et convallis lacinia, scelerisque at erat. Fusce risus libero, convallis at fermentum in, dignissim sed sem. Ut dapibus orci vitae nisl viverra nec adipiscing tortor condimentum \cite{DBLP:journals/cacm/Dijkstra68a}. Donec non suscipit lorem. Nam sit amet enim vitae nisl accumsan pretium. 

\begin{lstlisting}[caption={Useless code.},label=list:8-6,captionpos=t,float,abovecaptionskip=-\medskipamount]
for i:=maxint to 0 do 
begin 
    j:=square(root(i));
end;
\end{lstlisting}

\subsection{Proin ac fermentum augue}

Proin ac fermentum augue. Nullam bibendum enim sollicitudin tellus egestas lacinia euismod orci mollis. Nulla facilisi. Vivamus volutpat venenatis sapien, vitae feugiat arcu fringilla ac. Mauris sapien tortor, sagittis eget auctor at, vulputate pharetra magna. Sed congue, dui nec vulputate convallis, sem nunc adipiscing dui, vel venenatis mauris sem in dui. Praesent a pretium quam. Mauris non mauris sit amet eros rutrum aliquam id ut sapien. Nulla aliquet fringilla sagittis. Pellentesque eu metus posuere nunc tincidunt dignissim in tempor dolor. Nulla cursus aliquet enim. Cras sapien risus, accumsan eu cursus ut, commodo vel velit. Praesent aliquet consectetur ligula, vitae iaculis ligula interdum vel. Integer faucibus faucibus felis. 

\begin{itemize}
\item Ut vitae diam augue. 
\item Integer lacus ante, pellentesque sed sollicitudin et, pulvinar adipiscing sem. 
\item Maecenas facilisis, leo quis tincidunt egestas, magna ipsum condimentum orci, vitae facilisis nibh turpis et elit. 
\end{itemize}

\begin{remark}
content...
\end{remark}

\section{Pellentesque quis tortor}

Nec urna malesuada sollicitudin. Nulla facilisi. Vivamus aliquam tempus ligula eget ornare. Praesent eget magna ut turpis mattis cursus. Aliquam vel condimentum orci. Nunc congue, libero in gravida convallis \cite{DBLP:conf/focs/HopcroftPV75}, orci nibh sodales quam, id egestas felis mi nec nisi. Suspendisse tincidunt, est ac vestibulum posuere, justo odio bibendum urna, rutrum bibendum dolor sem nec tellus. 

\begin{lemma} [Quisque blandit tempus nunc]
Sed interdum nisl pretium non. Mauris sodales consequat risus vel consectetur. Aliquam erat volutpat. Nunc sed sapien ligula. Proin faucibus sapien luctus nisl feugiat convallis faucibus elit cursus. Nunc vestibulum nunc ac massa pretium pharetra. Nulla facilisis turpis id augue venenatis blandit. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus.
\end{lemma}

Fusce eu leo nisi. Cras eget orci neque, eleifend dapibus felis. Duis et leo dui. Nam vulputate, velit et laoreet porttitor, quam arcu facilisis dui, sed malesuada risus massa sit amet neque.

\section{Morbi eros magna}

Morbi eros magna, vestibulum non posuere non, porta eu quam. Maecenas vitae orci risus, eget imperdiet mauris. Donec massa mauris, pellentesque vel lobortis eu, molestie ac turpis. Sed condimentum convallis dolor, a dignissim est ultrices eu. Donec consectetur volutpat eros, et ornare dui ultricies id. Vivamus eu augue eget dolor euismod ultrices et sit amet nisi. Vivamus malesuada leo ac leo ullamcorper tempor. Donec justo mi, tempor vitae aliquet non, faucibus eu lacus. Donec dictum gravida neque, non porta turpis imperdiet eget. Curabitur quis euismod ligula. 


%%
%% Bibliography
%%

%% Please use bibtex, 

\bibliography{lipics-v2021-sample-article}

\appendix

\section{Styles of lists, enumerations, and descriptions}\label{sec:itemStyles}

List of different predefined enumeration styles:

\begin{itemize}
\item \verb|\begin{itemize}...\end{itemize}|
\item \dots
\item \dots
%\item \dots
\end{itemize}

\begin{enumerate}
\item \verb|\begin{enumerate}...\end{enumerate}|
\item \dots
\item \dots
%\item \dots
\end{enumerate}

\begin{alphaenumerate}
\item \verb|\begin{alphaenumerate}...\end{alphaenumerate}|
\item \dots
\item \dots
%\item \dots
\end{alphaenumerate}

\begin{romanenumerate}
\item \verb|\begin{romanenumerate}...\end{romanenumerate}|
\item \dots
\item \dots
%\item \dots
\end{romanenumerate}

\begin{bracketenumerate}
\item \verb|\begin{bracketenumerate}...\end{bracketenumerate}|
\item \dots
\item \dots
%\item \dots
\end{bracketenumerate}

\begin{description}
\item[Description 1] \verb|\begin{description} \item[Description 1]  ...\end{description}|
\item[Description 2] Fusce eu leo nisi. Cras eget orci neque, eleifend dapibus felis. Duis et leo dui. Nam vulputate, velit et laoreet porttitor, quam arcu facilisis dui, sed malesuada risus massa sit amet neque.
\item[Description 3]  \dots
%\item \dots
\end{description}

\cref{testenv-proposition} and \autoref{testenv-proposition} ...

\section{Theorem-like environments}\label{sec:theorem-environments}

List of different predefined enumeration styles:

\begin{theorem}\label{testenv-theorem}
Fusce eu leo nisi. Cras eget orci neque, eleifend dapibus felis. Duis et leo dui. Nam vulputate, velit et laoreet porttitor, quam arcu facilisis dui, sed malesuada risus massa sit amet neque.
\end{theorem}

\begin{lemma}\label{testenv-lemma}
Fusce eu leo nisi. Cras eget orci neque, eleifend dapibus felis. Duis et leo dui. Nam vulputate, velit et laoreet porttitor, quam arcu facilisis dui, sed malesuada risus massa sit amet neque.
\end{lemma}

\begin{corollary}\label{testenv-corollary}
Fusce eu leo nisi. Cras eget orci neque, eleifend dapibus felis. Duis et leo dui. Nam vulputate, velit et laoreet porttitor, quam arcu facilisis dui, sed malesuada risus massa sit amet neque.
\end{corollary}

\begin{proposition}\label{testenv-proposition}
Fusce eu leo nisi. Cras eget orci neque, eleifend dapibus felis. Duis et leo dui. Nam vulputate, velit et laoreet porttitor, quam arcu facilisis dui, sed malesuada risus massa sit amet neque.
\end{proposition}

\begin{conjecture}\label{testenv-conjecture}
Fusce eu leo nisi. Cras eget orci neque, eleifend dapibus felis. Duis et leo dui. Nam vulputate, velit et laoreet porttitor, quam arcu facilisis dui, sed malesuada risus massa sit amet neque.
\end{conjecture}

\begin{observation}\label{testenv-observation}
Fusce eu leo nisi. Cras eget orci neque, eleifend dapibus felis. Duis et leo dui. Nam vulputate, velit et laoreet porttitor, quam arcu facilisis dui, sed malesuada risus massa sit amet neque.
\end{observation}

\begin{exercise}\label{testenv-exercise}
Fusce eu leo nisi. Cras eget orci neque, eleifend dapibus felis. Duis et leo dui. Nam vulputate, velit et laoreet porttitor, quam arcu facilisis dui, sed malesuada risus massa sit amet neque.
\end{exercise}

\begin{definition}\label{testenv-definition}
Fusce eu leo nisi. Cras eget orci neque, eleifend dapibus felis. Duis et leo dui. Nam vulputate, velit et laoreet porttitor, quam arcu facilisis dui, sed malesuada risus massa sit amet neque.
\end{definition}

\begin{example}\label{testenv-example}
Fusce eu leo nisi. Cras eget orci neque, eleifend dapibus felis. Duis et leo dui. Nam vulputate, velit et laoreet porttitor, quam arcu facilisis dui, sed malesuada risus massa sit amet neque.
\end{example}

\begin{note}\label{testenv-note}
Fusce eu leo nisi. Cras eget orci neque, eleifend dapibus felis. Duis et leo dui. Nam vulputate, velit et laoreet porttitor, quam arcu facilisis dui, sed malesuada risus massa sit amet neque.
\end{note}

\begin{note*}
Fusce eu leo nisi. Cras eget orci neque, eleifend dapibus felis. Duis et leo dui. Nam vulputate, velit et laoreet porttitor, quam arcu facilisis dui, sed malesuada risus massa sit amet neque.
\end{note*}

\begin{remark}\label{testenv-remark}
Fusce eu leo nisi. Cras eget orci neque, eleifend dapibus felis. Duis et leo dui. Nam vulputate, velit et laoreet porttitor, quam arcu facilisis dui, sed malesuada risus massa sit amet neque.
\end{remark}

\begin{remark*}
Fusce eu leo nisi. Cras eget orci neque, eleifend dapibus felis. Duis et leo dui. Nam vulputate, velit et laoreet porttitor, quam arcu facilisis dui, sed malesuada risus massa sit amet neque.
\end{remark*}

\begin{claim}\label{testenv-claim}
Fusce eu leo nisi. Cras eget orci neque, eleifend dapibus felis. Duis et leo dui. Nam vulputate, velit et laoreet porttitor, quam arcu facilisis dui, sed malesuada risus massa sit amet neque.
\end{claim}

\begin{claim*}\label{testenv-claim2}
Fusce eu leo nisi. Cras eget orci neque, eleifend dapibus felis. Duis et leo dui. Nam vulputate, velit et laoreet porttitor, quam arcu facilisis dui, sed malesuada risus massa sit amet neque.
\end{claim*}

\begin{proof}
Fusce eu leo nisi. Cras eget orci neque, eleifend dapibus felis. Duis et leo dui. Nam vulputate, velit et laoreet porttitor, quam arcu facilisis dui, sed malesuada risus massa sit amet neque.
\end{proof}

\begin{claimproof}
Fusce eu leo nisi. Cras eget orci neque, eleifend dapibus felis. Duis et leo dui. Nam vulputate, velit et laoreet porttitor, quam arcu facilisis dui, sed malesuada risus massa sit amet neque.
\end{claimproof}
\end{comment}


\end{document}
