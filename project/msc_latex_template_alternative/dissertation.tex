\documentclass[12pt,a4paper,fleqn,twoside,openright]{report}
\usepackage{dissertation}
\usepackage{mathrsfs}
\usepackage{accents}
%\usepackage{bussproofs}
\usepackage{tikz-cd} % Useless, but might be handy to draw fancier lines.
\usepackage{amssymb} % To provide the \varnothing symbol
\usepackage{amsmath}
\usepackage{quantikz}
\usepackage{mathtools}
\usepackage{stmaryrd}
\usepackage{hyperref}
\usepackage{aliascnt}
\usepackage{amsthm}
\usepackage{ebproof}
\usepackage{hyperref}
\usepackage[utf8]{inputenc} % Specify input encoding
\usepackage{textcomp} % For additional text symbols
\usepackage{xargs}                      % Use more than one optional parameter in a new commands
\usepackage[pdftex,dvipsnames]{xcolor}  % Coloured text etc.
\usepackage[colorinlistoftodos,prependcaption,textsize=tiny]{todonotes}
\input{macros}
\newcommandx{\unsure}[2][1=]{\todo[linecolor=red,backgroundcolor=red!25,bordercolor=red,#1]{#2}}
\newcommandx{\change}[2][1=]{\todo[linecolor=blue,backgroundcolor=blue!25,bordercolor=blue,#1]{#2}}
\newcommandx{\info}[2][1=]{\todo[linecolor=OliveGreen,backgroundcolor=OliveGreen!25,bordercolor=OliveGreen,#1]{#2}}
\newcommandx{\improvement}[2][1=]{\todo[linecolor=Plum,backgroundcolor=Plum!25,bordercolor=Plum,#1]{#2}}
\newcommandx{\thiswillnotshow}[2][1=]{\todo[disable,#1]{#2}}

% Theorem-like environments
\newtheorem{theorem}{Theorem}[section]
% Use aliascnt to create new counters that share numbering but have their own names
\newaliascnt{lemma}{theorem}
\newtheorem{lemma}[lemma]{Lemma}
\aliascntresetthe{lemma}
\providecommand*{\lemmaautorefname}{Lemma}


\newaliascnt{proposition}{theorem}
\newtheorem{proposition}[proposition]{Proposition}
\aliascntresetthe{proposition}
\providecommand*{\propositionautorefname}{Proposition}

\newaliascnt{corollary}{theorem}
\newtheorem{corollary}[corollary]{Corollary}
\aliascntresetthe{corollary}
\providecommand*{\corollaryautorefname}{Corollary}

\theoremstyle{definition}
\newaliascnt{definition}{theorem}
\newtheorem{definition}[definition]{Definition}
\aliascntresetthe{definition}
\providecommand*{\definitionautorefname}{Definition}


\newaliascnt{example}{theorem}
\newtheorem{example}[example]{Example}
\aliascntresetthe{example}
\providecommand*{\exampleautorefname}{Example}


\newaliascnt{convention}{theorem}
\newtheorem{convention}[convention]{Convention}
\aliascntresetthe{convention}
\providecommand*{\conventionautorefname}{Convention}



\makenoidxglossaries 
\makeindex
\allowdisplaybreaks[1]

\newacronym{nisq}{NISQ}{Noisy Intermediate-Scale Quantum}
\newacronym{bnf}{BNF}{Backus-Naur Form}
\newacronym{cptp}{CPTP}{Completely Positive Trace-Preserving}
\newacronym{osr}{OSR}{Operator Sum Representation}
\newglossaryentry{ket}
{
    name=$\ket{\psi}$,
    description={Quantum state. Also known as ket.}
}
\newglossaryentry{bra}
{
    name={$\bra{\psi}$},
    description={$\ket{\psi}^{\dag}$. Also known as bra.}
}
\newglossaryentry{innerproduct}
{
    name={$\langle \psi|\phi \rangle$},
    description={Inner product between states $\ket{\psi}$ and $\ket{\phi}$.}
}
\newglossaryentry{typingcontexts}
{
    name={$\Gamma, \Delta, E$},
    description={Typical names for typing contexts.}
}
\newglossaryentry{judgement}
{
    name={$\Gamma \hspace{1pt} \triangleright \hspace{1pt}v: \mathbb{A}$},
    description={ Typing judgement.}
}
\newglossaryentry{fv}
{
    name={$FV (v)$},
    description={Set of free variables of a term $v$.}
}
\newglossaryentry{vectorspaces}
{
    name={$R,V, W$},
    description={Typical names for vector spaces.}
}
\newglossaryentry{equation-in-context}
{
    name={$\Gamma \hspace{1pt} \triangleright \hspace{1pt} v = w : \mathbb {A}$},
    description={Equation-in-context.}
}
\newglossaryentry{metric-equation}
{
    name={$ t =_{\epsilon} s$},
    description={Metric equation.}
}

\newglossaryentry{typed-term}
{
    name={$v:\mathbb{A}$},
    description={Typed term.}
}
\newglossaryentry{substitution}
{
    name={$v[w/x]$},
    description={Substitution of a variable $x$ for a term $w$ in a term $v$.}
}
\newglossaryentry{n-complex-space}
{
    name={ $\mathbb{C}^{n}$},
    description={n-dimensional complex space.}
}
\newglossaryentry{matrix-complex-space}
{
    name={ $\mathbb{C}^{n \times m}$},
    description={Space of complex matrices of dimension $n \times m$.}
}
\newglossaryentry{inner-product}
{
    name={ $\langle \cdot, \cdot \rangle$},
    description={Inner product.}
}
\newglossaryentry{dag}
{
    name={ $(-)^{\dag}$},
    description={Adjoint operation.}
}
\newglossaryentry{conj}
{
    name={ $\overline{(-)}$},
    description={Complex conjugate operation.}
}
\newglossaryentry{unitary}
{
    name={ $U$},
    description={ Typical name for a unitary operator.}
}
\newglossaryentry{density-matrix}
{
    name={ $\rho$},
    description={ Typical designation for a density matrix.}
}
\newglossaryentry{norm}
{
    name={$\|\cdot\|$},
    description={Norm of an arbitrary vector.}
}
\newglossaryentry{euclidean-norm}
{
    name={$\|\cdot\|_2$},
    description={Euclidean norm.}
}
\newglossaryentry{trace-norm}
{
    name={$\|\cdot\|_1$},
    description={Trace norm.}
}
\newglossaryentry{op-norm}
{
    name={$\|\cdot\|_{\text{op}}$},
    description={Operator norm.}
}
\newglossaryentry{n-fold-tensor}
{
    name={ $(-)^{\otimes n}$},
    description={N-fold tensor product.}
}
\newglossaryentry{states-otimes}
{
    name={$\ket{\psi} \otimes \ket{\phi}$},
    description={Tensor product of states $\ket{\psi}$ and $\ket{\phi}$.}
}
\newglossaryentry{states-no-otimes}
{
    name={$\ket{\psi}\ket{\phi}$},
    description={Tensor product of states $\ket{\psi}$ and $\ket{\phi}$.}
}
\newglossaryentry{states-2gether}
{
    name={$\ket{\psi\phi}$},
    description={Tensor product of states $\ket{\psi}$ and $\ket{\phi}$.}
}
\newglossaryentry{x}
{
    name={$X$},
    description={Pauli operator $\sigma_x$.}
}
\newglossaryentry{z}
{
    name={$Z$},
    description={Pauli operator $\sigma_z$.}
}
\newglossaryentry{h}
{
    name={$H$},
    description={Hadamard gate}
}
\newglossaryentry{p}
{
    name={$P$},
    description={Phase-shift gate}
}
\newglossaryentry{cnot}
{
    name={\textit{CNOT}},
    description={Controlled Not gate}
}
\newglossaryentry{id}
{
    name={$\mathrm{id}$},
    description={Identity operator}
}
\newglossaryentry{m0}
{
    name={$M_0$},
    description={Measurement operator for outcome 0}
}
\newglossaryentry{m1}
{
    name={$M_1$},
    description={Measurement operator for outcome 1}
}
\newglossaryentry{diamond-norm}
{
    name={$\|\cdot\|_{\diamondsuit}$},
    description={Diamond norm.}
}
\newglossaryentry{dim}
{
    name={$\text{dim}\left(V\right)$},
    description={Dimension of vector space $V$.}
}
\newglossaryentry{spectral-norm}
{
    name={$\|\cdot\|_{\infty}$},
    description={Spectral norm.}
}
\newglossaryentry{distance}
{
    name={$d(x,y)$},
    description={distance between vectors $x$ and $y$. }
}
\newglossaryentry{mr}
{
    name={$\mathcal{M}\mathbb{R}$},
    description={Banach space of finite Borel measures on $\mathbb{R}$.}
}
\newglossaryentry{real-space}
{
    name={$\mathbb{R}$},
    description={Space of real numbers}}
\newglossaryentry{product_meas}
{
    name={$\otimes_{\text{meas}}$},
    description={Product measure.}
}
\newglossaryentry{proj_norm}
{
    name={$\left\lVert \cdot  \right\rVert_{\pi}$},
    description={Projective norm.}
}
\newglossaryentry{proj_tensor}
{
    name={$  V \widehat{\otimes}_\pi W $},
    description={Projective tensor product of $ V $ and $ W $.}
}
\newglossaryentry{hilb_tensor}
{
    name={$  \mathcal{H} \otimes_2  \mathcal{K} $},
    description={Hilbert space tensor product of $\mathcal{H} $ and $ \mathcal{K}$.}
}
\newglossaryentry{l1_norm}
{
    name={$  \|\cdot\|_{L^1} $},
    description={$L^1$ norm.}
}
\newglossaryentry{l_inf_norm}
{
    name={$  \|\cdot\|_{L^\infty} $},
    description={$L^\infty$ norm.}
}
\newglossaryentry{hilbertspaces}
{
    name={$ \mathcal{H},  \mathcal{K} $},
    description={Typical names for Hilbert spaces.}
}
\newglossaryentry{boundedoperators}
{
    name={$ \mathcal{B}(V, W)  $},
    description={Vector space of all bounded linear operators from \( V \) to \( W \).}
}
\newglossaryentry{boundedoperatorsVV}
{
    name={$ \mathcal{B}(V)  $},
    description={Vector space of all bounded linear operators from \( V \) to itself.}
}
\newglossaryentry{traceclassHH}
{
    name={$ \mathcal{T} (\HilbH) $},
    description={Set of trace class operators on $\mathcal{H} $.}
}
\newglossaryentry{square_matrix}
{
    name={$ \mathcal{M}_n  $},
    description={Vector space of complex $n\times n$ matrices.}
}




%\glsaddall
%comando para ir da source para o pdf: ctrl + Alt + J 

%\logo{EAAD}{School of Architecture, Art and Design}{}
%\logoB{EAAD}{School of Architecture, Art and Design}{}

%\logo{EC}{School of Sciences}{}
%\logoB{EC}{School of Sciences}{}

%\logo{ED}{Law School}{}
%\logoB{ED}{Law School}{}

\logo{EE}{School of Engineering}{}
\logoB{EE}{School of Engineering}{}

%\logo{EEG}{School of Economics and Management}{}
%\logoB{EEG}{School of Economics and Management}{}

%\logo{ELACH}{School of Letters, Arts and Human Sciences}{}
%\logoB{ELACH}{School of Letters, Arts and Human Sciences}{}

%\logo{EM}{Medical school}{}
%\logoB{EM}{Medical school}{}

%\logo{EP}{School of Psychology}{}
%\logoB{EP}{School of Psychology}{}

%\logo{ESE}{Higher School of Nursing}{}
%\logoB{ESE}{Higher School of Nursing}{}

%\logo{I3Bs}{Research Institute on Biomaterials,}{Biodegradables and Biomimetics}
%\logoB{I3Bs}{Research Institute on Biomaterials,}{Biodegradables and Biomimetics}

%\logo{ICS}{Institute of Social Sciences}{}
%\logoB{ICS}{Institute of Social Sciences}{}

%\logo{IE}{Institute of Education}{}
%\logoB{IE}{Institute of Education}{}

\author{Bruna Filipa Martins Salgado}

\titleA{Metric $\lambda$-calculus with conditionals:}
\titleB{from quantum to probabilistic }
\titleC{and beyond}


\masters{Master in Physics Engineering}
%\area{Area of specialization}
\supervisor{Renato Jorge Araújo Neves}


%\bibpunct[,]{[}{]}{;}{a}{,}{,}

\begin{document}
\setlength{\parindent}{0em}

%-- Covers
\input{covers/Covers}

%-- Document setup
\newgeometry{right=25mm, left=25mm, top=25mm, bottom=25mm}
\pagenumbering{roman}

\setlength{\parskip}{0pt}
\setlength{\parindent}{0pt}

%-- Preamble
\input{preamble/Copyright}
\input{preamble/Acknowledgements}
\input{preamble/StatementofIntegrity}
\input{preamble/Abstract}

\phantomsection
\tableofcontents

\cleardoublepage
\listoffigures

% List of tables
%\renewcommand*{\listtablename}{List of Tables}
%\listoftables
%\clearpage

% Acronyms
\printnoidxglossary[sort = use,type=\acronymtype, title={Acronyms}]

% Glossary
\printnoidxglossary[sort = use,title={Notation}]

\cleardoublepage
\pagenumbering{arabic}

%-- Dissertation 
\part{Foundations}

\input{chapters/Introduction}
\input{chapters/StateOfTheArt}


\input{chapters/Contribution}
%\input{chapters/ProblemAndChallenges}

\part{Applications}
\input{chapters/PP}
\input{chapters/QC}
\input{chapters/ConclusionsAndFutureWork}
%\input{chapters/PlannedSchedule}

\renewcommand{\baselinestretch}{1}
\bibliographystyle{unsrt}
\bibliography{dissertation}
\printindex

\appendix
\renewcommand\chaptername{Appendix}

%\part{Appendices}

%\input{appendices/SupportWork}
%\input{appendices/DetailsOfResults}
%\input{appendices/Listings}
%\input{appendices/Tooling}

\input{covers/BackCover}

\end{document}

Prove that the norm of the commutator of two operators is less than or equal to 1.
\begin{equation}
    \begin{split}
        & \lVert [\textsc{Il} \otimes I, \textsc{Ir} \otimes I ]  \rVert  \\
        &= \text{max} \{ \lVert [\textsc{Il} \otimes I, \textsc{Ir} \otimes I ] (A) \rVert \hspace{2pt} \vert \hspace{2pt}  \lVert A\rVert =1   \} \\
        &= \text{max} \left\{ \left\lVert [\textsc{Il} \otimes I, \textsc{Ir} \otimes I ] \left(\sum_{i} v_i \otimes u_i,\sum_{i} w_i \otimes u_i  \right) \right\rVert \hspace{2pt} \Bigg\vert \hspace{2pt}  \left\lVert \left(\sum_{i} v_i \otimes u_i,\sum_{i} w_i \otimes u_i  \right) \right\rVert =1    \right\} \\
        & =\text{max} \left\{ \left\lVert \textsc{Il} \otimes I \left(\sum_{i} v_i \otimes u_i  \right)  +  \textsc{Ir} \otimes I \left(\sum_{i} w_i \otimes u_i  \right) \right\rVert \hspace{2pt} \Bigg\vert \hspace{2pt}  \left\lVert \left(\sum_{i} v_i \otimes u_i,\sum_{i} w_i \otimes u_i  \right) \right\rVert =1    \right\} \\
        & = \text{max} \Bigg\{ \left\lVert \textsc{Il} \left(\sum_{i} v_i  \right) \otimes I \left(\sum_{i} u_i  \right) + \textsc{Ir} \left(\sum_{i} w_i \right)\otimes I \left(\sum_{i} u_i  \right) \right\rVert \hspace{2pt} \\
        & \hspace{50pt}\Bigg\vert \hspace{2pt}  \left\lVert \left(\sum_{i} v_i \otimes u_i,\sum_{i} w_i \otimes u_i  \right) \right\rVert =1    \Bigg\} \\
        &= \text{max} \Bigg\{ \left\lVert \left(\sum_{i} v_i,0  \right) \otimes \sum_{i} u_i +  \left(0,\sum_{i} w_i \right) \otimes \sum_{i} u_i   \right\rVert  \hspace{2pt} \Bigg\vert \hspace{2pt}  \left\lVert \left(\sum_{i} v_i \otimes u_i,\sum_{i} w_i \otimes u_i  \right) \right\rVert =1    \Bigg\} \\
        &= \text{max} \Bigg\{ \left\lVert \left(\sum_{i} v_i \otimes  u_i ,0  \right) + \left(0,\sum_{i} w_i \otimes u_i  \right)   \right\rVert  \hspace{2pt} \Bigg\vert \hspace{2pt}  \left\lVert \left(\sum_{i} v_i \otimes u_i,\sum_{i} w_i \otimes u_i  \right) \right\rVert =1    \Bigg\} \\
        &= \text{max} \Bigg\{ \left\lVert \left(\sum_{i} v_i \otimes  u_i ,\sum_{i} w_i \otimes u_i   \right)    \right\rVert  \hspace{2pt} \Bigg\vert \hspace{2pt}  \left\lVert \left(\sum_{i} v_i \otimes u_i,\sum_{i} w_i \otimes u_i  \right) \right\rVert =1    \Bigg\} \\
        &=1
    \end{split}
    \end{equation}

    \begin{equation}
        \begin{split}
            & \hspace{3pt} \lVert [\textsc{Il} \otimes I, \textsc{Ir} \otimes I ]  \rVert_{}  \\
            &= \text{max} \{ \lVert [\textsc{Il} \otimes I, \textsc{Ir} \otimes I ] (A) \rVert \hspace{2pt} \vert \hspace{2pt}  \lVert A\rVert =1   \} \\
            &= \text{max} \left\{ \left\lVert [\textsc{Il} \otimes I, \textsc{Ir} \otimes I ] \left(\sum_{i} v_i \otimes u_i,\sum_{i} w_i \otimes u_i  \right) \right\rVert \hspace{2pt} \Bigg\vert \hspace{2pt}  \left\lVert \left(\sum_{i} v_i \otimes u_i,\sum_{i} w_i \otimes u_i  \right) \right\rVert =1    \right\} \\
            & =\text{max} \left\{ \left\lVert \textsc{Il} \otimes I \left(\sum_{i} v_i \otimes u_i  \right)  +  \textsc{Ir} \otimes I \left(\sum_{i} w_i \otimes u_i  \right) \right\rVert \hspace{2pt} \Bigg\vert \hspace{2pt}  \left\lVert \left(\sum_{i} v_i \otimes u_i,\sum_{i} w_i \otimes u_i  \right) \right\rVert =1    \right\} \\
            & = \text{max} \Bigg\{ \left\lVert \textsc{Il} \left(\sum_{i} v_i  \right) \otimes I \left(\sum_{i} u_i  \right) + \textsc{Ir} \left(\sum_{i} w_i \right)\otimes I \left(\sum_{i} u_i  \right) \right\rVert \hspace{2pt} \\
            & \hspace{50pt}\Bigg\vert \hspace{2pt}  \left\lVert \left(\sum_{i} v_i \otimes u_i,\sum_{i} w_i \otimes u_i  \right) \right\rVert =1    \Bigg\} \\
            &= \text{max} \Bigg\{ \left\lVert \left(\sum_{i} v_i,0  \right) \otimes \sum_{i} u_i +  \left(0,\sum_{i} w_i \right) \otimes \sum_{i} u_i   \right\rVert  \hspace{2pt} \Bigg\vert \hspace{2pt}  \left\lVert \left(\sum_{i} v_i \otimes u_i,\sum_{i} w_i \otimes u_i  \right) \right\rVert =1    \Bigg\} \\
            &= \text{max} \Bigg\{ \left\lVert \left(\sum_{i} v_i \otimes  u_i ,0  \right) + \left(0,\sum_{i} w_i \otimes u_i  \right)   \right\rVert  \hspace{2pt} \Bigg\vert \hspace{2pt}  \left\lVert \left(\sum_{i} v_i \otimes u_i,\sum_{i} w_i \otimes u_i  \right) \right\rVert =1    \Bigg\} \\
            &= \text{max} \Bigg\{ \left\lVert \left(\sum_{i} v_i \otimes  u_i ,\sum_{i} w_i \otimes u_i   \right)    \right\rVert  \hspace{2pt} \Bigg\vert \hspace{2pt}  \left\lVert \left(\sum_{i} v_i \otimes u_i,\sum_{i} w_i \otimes u_i  \right) \right\rVert =1    \Bigg\} \\
            &=1
        \end{split}
        \end{equation}


        %maliciuos atack a,b,c,d
        
\begin{figure} [H]
    \centering
    \begin{quantikz} [column sep=0.2cm, row sep=0.5cm,wire
      types={n,n,n,n,n}]%
        \lstick{$\ket{\psi}$}  & \qw &\qw & \qw & \qw & \qw &  \ctrl{1} \qw \gategroup[2,steps=2,style={dashed,rounded
        corners,fill=blue!20, inner
        xsep=2pt},background,label style={label
        position=below,anchor=north,yshift=-0.2cm}]{{\sc
        B}} & \gate{H} \qw & \qw & \qw &\qw \gategroup[5,steps=9,style={dashed,rounded
        corners,fill=blue!20, inner
        xsep=2pt},background,label style={label
        position=below,anchor=north,yshift=-0.2cm}]{{\sc
        C}}  & \qw & \qw & \qw & \targ{} \qw  & \qw & \qw & \qw & \qw & \qw & \qw & \meter{} \qw \gategroup[3,steps=6,style={dashed,rounded
        corners,fill=blue!20, inner
        xsep=2pt},background,label style={label
        position=below,anchor=north,yshift=-0.2cm}]{{\sc
        D}}     & \setwiretype{c}  &  &  & & \ctrl[vertical
  wire=c]{2}  \\
        \lstick {$\ket{0}$}  &\gate{H}\gategroup[2,steps=3,style={dashed,rounded
        corners,fill=blue!20, inner
        xsep=2pt},background,label style={label
        position=below,anchor=north,yshift=-0.2cm}]{{\sc
        A}} & \qw  & \ctrl{1} \qw& \qw & \qw  & \targ{} \qw & \qw & \qw & \qw & \qw& \qw & \qw & \qw & \qw &  \qw & \qw &  \targ{} \qw & \qw & \qw & \qw & \meter{} \qw & \setwiretype{c}  & & \ctrl[vertical
  wire=c]{1} \\
        \lstick{$\ket{0}$}  &  \qw & \qw &  \targ{} \qw \qw & \qw &\qw&\qw & \qw & \qw& \qw & \qw & \qw & \qw& \qw & \qw & \qw & \qw &  \qw & \qw & \qw & \qw & \qw & \qw & \qw &  \gate{X} \qw & \qw & \gate{Z} \qw\\
         &   & &  &  & & &  &  & & & & \lstick{$\ket{0}$}  & \qw & \qw & \qw  & \gate{R_X(\frac{\pi}{2})} \qw& \ctrl{-2} \qw & \gate{\text{Disc}} \qw  \\
        &   &  & & & & &  &  & & & & \lstick{$\ket{0}$}   &\gate{R_X(\frac{\pi}{2})} \qw  & \ctrl{-4} \qw & \gate{\text{Disc}} \qw & &  &  &  &  &   & &  &  &  &  &  
      \end{quantikz}
    \caption{Quantum Teleportation Protocol: Bit flip with a 50\% probability before measurement.}
    \label{fig:teleport_bit_flip}
  \end{figure}






  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  
\begin{figure} [H] 
  \centering
  \begin{center}
      \includegraphics[width=0.6\textwidth]{images/qsd_1.png}
  \end{center}
\caption{Optimal minimum error measurement for discriminating between the pure states \ket{\psi_0}  and  \ket{\psi_1}. $\gamma$ is  the angle between the states \ket{\psi_0}  and  \ket{\psi_1}. $\beta$ is the angle between the states \ket{\psi_0}  and  \ket{v_0} \big/ \ket{\psi_1}  and  \ket{v_1}. $\theta$ is the angle between the states \ket{\psi_0}  and \ket{0} - the polar angle in the Bloch Sphere. $\alpha$ is the angle between the states \ket{v_0}  and \ket{0} .}
\label{fig:qsd1}
\end{figure}

Observing \autoref{fig:qsd1} is possible to conclude that $\alpha = \theta - \beta = \theta - \left(\frac{\frac{\pi}{2}-\gamma}{2} \right) = \theta -  {\frac{\pi}{4}}+\frac{\gamma}{8} $. Given the direction of the rotation, the angle $\alpha$ is negative, so the rotation is $R_{-\alpha}$ which also correspons to $R^{\dag}_{\alpha}$.

As a result, the quantum discrimination for two pure states can be formulated as follows:
\begin{align*}
  q: \textit{qbit}\hspace{3 pt} \triangleright \hspace{3 pt} \textit{meas} (R^{\dag}_{\alpha} (q)) 
\end{align*}


Attending to \autoref{eq:qubit_bs}, when $q = \ket{\psi_{0}}$ this program is interpreted as follows:

\begin{equation}  \label{eq:teleport_1}
  \begin{split}
&  \ket{\psi}=   \cos\left(\frac{\theta}{2}\right) \ket{0} + e^{i\phi}\sin\left(\frac{\theta}{2}\right)\ket{1} \\
  \xmapsto{R^{\dag}_{\alpha} (q)} \quad & \left(\cos\left(  \frac{\theta}{2} -  {\frac{\pi}{8}}+\frac{\gamma}{4}\right) \cos\left(\frac{\theta}{2}\right) + \sin\left(\frac{\theta}{2} -  {\frac{\pi}{8}}+\frac{\gamma}{4}\right) e^{i\phi}\sin\left(\frac{\theta}{2}\right) \right)\ket{0}  \\
& - \left(\sin\left(\frac{\theta}{2} -  {\frac{\pi}{8}}+\frac{\gamma}{4}\right) \cos\left(\frac{\theta}{2}\right)   + \cos\left(  \frac{\theta}{2} -  {\frac{\pi}{8}}+\frac{\gamma}{4}\right) e^{i\phi}\sin\left(\frac{\theta}{2}\right)\right)\ket{1}   \\
= & \left( \frac{\cos\left(\theta -  {\frac{\pi}{8}}+\frac{\gamma}{4} \right) + \cos\left({-\frac{\pi}{8}}+\frac{\gamma}{4} \right) + e^{i\phi} ( \cos\left({-\frac{\pi}{8}}+\frac{\gamma}{4}\right) - \cos\left(\theta -  {\frac{\pi}{8}}+\frac{\gamma}{4} \right))}{2} \right)   \ket{0}  \\
& + \left( \frac{-\sin\left(\theta -  {\frac{\pi}{8}}+\frac{\gamma}{4} \right) - \sin\left({-\frac{\pi}{8}}+\frac{\gamma}{4} \right) + e^{i\phi} (\sin\left({-\frac{\pi}{8}}+\frac{\gamma}{4}\right) - \sin\left(\theta -  {\frac{\pi}{8}}+\frac{\gamma}{4} \right))}{2}  \right) \ket{1}  \\
\xmapsto{ \hspace{1pt} \textit{meas} (R^{\dag}_{\alpha} (q))} \quad & \Big( \frac{ \cos^{2}\left(\theta -  {\frac{\pi}{8}}+\frac{\gamma}{4} \right) + \cos\left(\theta -  {\frac{\pi}{8}}+\frac{\gamma}{4}\right)\cos\left( {-\frac{\pi}{8}}+\frac{\gamma}{4}\right) + e^{-i\phi}  \cos\left(\theta -  {\frac{\pi}{8}}+\frac{\gamma}{4}\right) \cos\left( {-\frac{\pi}{8}}+\frac{\gamma}{4}\right) } {4} \\ %
& \frac {-e^{-i\phi} \cos^{2}\left(\theta - {\frac{\pi}{8}}+\frac{\gamma}{4} \right)  + \cos\left( {-\frac{\pi}{8}}+\frac{\gamma}{4}\right) \cos\left(\theta -  {\frac{\pi}{8}}+\frac{\gamma}{4}\right) + \cos^{2}\left( {-\frac{\pi}{8}}+\frac{\gamma}{4} \right)     } {4} \\
& \frac {+ e^{-i\phi} \cos^{2}\left({-\frac{\pi}{8}}+\frac{\gamma}{4} \right)- e^{-i\phi} \cos\left( {-\frac{\pi}{8}}+\frac{\gamma}{4}\right) \cos\left(\theta -  {\frac{\pi}{8}}+\frac{\gamma}{4}\right)  + e^{i\phi} \cos\left( {-\frac{\pi}{8}}+\frac{\gamma}{4}\right) \cos\left(\theta -  {\frac{\pi}{8}}+\frac{\gamma}{4}\right)     } {4}  \\
& \frac {+ e^{i\phi} \cos^{2}\left( {-\frac{\pi}{8}}+\frac{\gamma}{4} \right) +  \cos^{2}\left(- {\frac{\pi}{8}}+\frac{\gamma}{4} \right) -  \cos\left( {-\frac{\pi}{8}}+\frac{\gamma}{4}\right) \cos\left(\theta -  {\frac{\pi}{8}}+\frac{\gamma}{4}\right) } {4}\\
& \frac{-  e^{i\phi}\cos^{2}\left(\theta -  {\frac{\pi}{8}}+\frac{\gamma}{4} \right) - e^{i\phi} \cos\left(\theta -  {\frac{\pi}{8}}+\frac{\gamma}{4}\right)\cos\left( {-\frac{\pi}{8}}+\frac{\gamma}{4}\right) -   \cos\left(\theta -  {\frac{\pi}{8}}+\frac{\gamma}{4}\right) \cos\left( {-\frac{\pi}{8}}+\frac{\gamma}{4}\right) } {4} \\
& + \cos^{2}\left(\theta - {\frac{\pi}{8}}+\frac{\gamma}{4} \right), \ldots \Big) \\
= & \Big( \frac {2 \cos^{2}\left(\theta - {\frac{\pi}{8}}+\frac{\gamma}{4} \right) - (e^{-i \phi} + e^{i \phi})  \cos^{2}\left(\theta - {\frac{\pi}{8}}+\frac{\gamma}{4} \right)  + 2 \cos^{2}\left({-\frac{\pi}{8}}+\frac{\gamma}{4} \right)     } {4}  \\
&  \frac {+(e^{-i \phi} + e^{i \phi}) \cos^{2}\left({-\frac{\pi}{8}}+\frac{\gamma}{4} \right)} {4}, \ldots \Big) \\
= & \Big( \frac {\cos^{2}\left(\theta - {\frac{\pi}{8}}+\frac{\gamma}{2} \right) - \cos(\phi)  \cos^{2}\left(\theta - {\frac{\pi}{8}}+\frac{\gamma}{4} \right)  +  \cos^{2}\left({-\frac{\pi}{8}}+\frac{\gamma}{4} \right)     } {2}  \\
&  \frac {+ \cos (\phi) \cos^{2}\left({-\frac{\pi}{8}}+\frac{\gamma}{4} \right)} {2}, \ldots \Big) \\
  \end{split}
\end{equation}


\section{Discriminating Two Pure Quantum States}
\todo[inline,size=\normalsize]{pôr introdução a quantum state discrimination e a sua importância e de onde vem a melhor estragegia -> livro Barret}



Given a pure $d$-dimensional state \ket{\psi} known to be either \ket{\psi_0} or \ket{\psi_1}, one must guess which state \ket{\psi} is. In quantum state discrimination, we wish to design a measurement to distinguish optimally between \ket{\psi_0} or \ket{\psi_1}. 

Assume with out loss of generality the angle between \ket{\psi_0}  and \ket{\psi_1}, designated $\alpha$, is between $0$ and $\frac{pi}{2}$. Otherwise, replace \ket{\psi_0} is replaced by $- \ket{\psi_0}$.

In this case the best strategy is is to do the projective measurement with \{\ket{v_0}, \ket{v_1}\}, where \ket{v_0}, \ket{v_1}\ are in the span of \ket{\psi_0}  and \ket{\psi_1} such that $\langle v_{0}| v_{0} \rangle = 0$, they are symmetric with
respect to the angle bisector of \ket{\psi_0}  and \ket{\psi_1}, and \ket{v_i} is closer to  \ket{\psi_i} for $i = 0, 1$. On outcome $“i”$, we guess $\psi_i$.

\begin{figure} [H] 
    \centering
    \begin{center}
        \includegraphics[width=0.6\textwidth]{images/qsd_0.png}
    \end{center}
\caption{Optimal minimum error measurement for discriminating between the pure states \ket{\psi_0}  and  \ket{\psi_1}. This is a
projective measurement onto the states \ket{v_0}  and  \ket{v_1}, symmetrically located on either side of the signal states and shown in red here. $\gamma$ is  the angle between the states \ket{\psi_0}  and  \ket{\psi_1}. $\beta$ is the angle between the states \ket{\psi_0}  and  \ket{v_0} \big/ \ket{\psi_1}  and  \ket{v_1} .}
\label{fig:qsd}
\end{figure}

The probability of success using the best strategy is

\begin{equation*}
    P_{succ} = \langle \psi_{0}| v_{0} \rangle = \cos^2(\beta) = \cos^2 \left(\frac{\pi/2 - \gamma}{2}\right) = \frac{1}{2} + \frac{1}{2} \cos(\pi/2 -\gamma) = \frac{1}{2} + \frac{1}{2} \sin(\gamma)
\end{equation*}

\subsection{QSD for two pure states: quantum lambda calculus formulation}

Since the quantum lambda calculus presented allows only for explicit projective measurements in the computational basis, it is necessary to rotate the state \ket{\psi} so that \ket{v_0} and \ket{v_1} coincide with the computational basis. This can be done by applying a unitary $U$ to the state \ket{\psi} such that $U \ket{v_0} = \ket{0}$. 

Observing \autoref{fig:qsd} is possible to conclude that $\beta =  \frac{\frac{\pi}{2}-\gamma}{2} = \frac{\pi}{4} - \frac{\gamma}{2}$. Therefore,

\begin{equation}
    \begin{split}
        \ket{v_0} =R^{\dag}_{\beta} \ket{\psi_0} & = \begin{pmatrix}
        \cos{ \left(\frac{\pi}{4} - \frac{\gamma}{2}\right)}  & \sin{ \left(\frac{\pi}{4} - \frac{\gamma}{2}\right)} \\
       - \sin{ \left(\frac{\pi}{4} - \frac{\gamma}{2}\right)}  &  \cos{ \left(\frac{\pi}{4} - \frac{\gamma}{2}\right)} \end{pmatrix} \begin{pmatrix}
        \cos{ \left(\frac{\theta}{2}\right)}   \\
       e^{i \phi}\sin{ \left(\frac{\theta}{2}\right)}  \end{pmatrix} \\
       & = \begin{pmatrix}
        \cos{ \left(\frac{\pi}{4} - \frac{\gamma}{2}\right)}  \cos{ \left(\frac{\theta}{2}\right)}  + \sin{ \left(\frac{\pi}{4} - \frac{\gamma}{2}\right)} e^{i \phi}\sin{ \left(\frac{\theta}{2}\right)}  \\
       - \sin{ \left(\frac{\pi}{4} - \frac{\gamma}{2}\right)}  \cos{ \left(\frac{\theta}{2}\right)}  +  \cos{ \left(\frac{\pi}{4} - \frac{\gamma}{2}\right)} e^{i \phi}\sin{ \left(\frac{\theta}{2}\right)}   \end{pmatrix} 
    \end{split}
\end{equation}

Consequently, 

\begin{equation}
    \begin{split}
        \ket{v_1}  = \begin{pmatrix}
         \sin{ \left(\frac{\pi}{4} - \frac{\gamma}{2}\right)}  \cos{ \left(\frac{\theta}{2}\right)}  -  \cos{ \left(\frac{\pi}{4} - \frac{\gamma}{2}\right)} e^{i \phi}\sin{ \left(\frac{\theta}{2}\right)}   
        \\
        \cos{ \left(\frac{\pi}{4} - \frac{\gamma}{2}\right)}  \cos{ \left(\frac{\theta}{2}\right)}  + \sin{ \left(\frac{\pi}{4} - \frac{\gamma}{2}\right)} e^{i \phi}\sin{ \left(\frac{\theta}{2}\right)}  \end{pmatrix} 
    \end{split}
\end{equation}

As a result,
\begin{equation}
    \begin{split}
        U =  \begin{pmatrix} \cos{ \left(\frac{\pi}{4} - \frac{\gamma}{2}\right)}  \cos{ \left(\frac{\theta}{2}\right)}  + \sin{ \left(\frac{\pi}{4} - \frac{\gamma}{2}\right)} e^{-i \phi}\sin{ \left(\frac{\theta}{2}\right)}  & - \sin{ \left(\frac{\pi}{4} - \frac{\gamma}{2}\right)}  \cos{ \left(\frac{\theta}{2}\right)}  +  \cos{ \left(\frac{\pi}{4} - \frac{\gamma}{2}\right)} e^{-i \phi}\sin{ \left(\frac{\theta}{2}\right)}   \\
            \sin{ \left(\frac{\pi}{4} - \frac{\gamma}{2}\right)}  \cos{ \left(\frac{\theta}{2}\right)}  -  \cos{ \left(\frac{\pi}{4} - \frac{\gamma}{2}\right)} e^{-i \phi}\sin{ \left(\frac{\theta}{2}\right)}  &  \cos{ \left(\frac{\pi}{4} - \frac{\gamma}{2}\right)}  \cos{ \left(\frac{\theta}{2}\right)}  + \sin{ \left(\frac{\pi}{4} - \frac{\gamma}{2}\right)} e^{-i \phi}\sin{ \left(\frac{\theta}{2}\right)}  \end{pmatrix} 
    \end{split}
\end{equation}

When $\ket{\psi} = \ket{\psi_0}$, one has that,
\begin{equation}
    \begin{split}
        &U \ket{\psi} = \\
        &\scriptsize{
            \begin{pmatrix} 
                \left[\cos{ \left(\frac{\pi}{4} - \frac{\gamma}{2}\right)}  \cos{ \left(\frac{\theta}{2}\right)}  + \sin{ \left(\frac{\pi}{4} - \frac{\gamma}{2}\right)} e^{-i \phi}\sin{ \left(\frac{\theta}{2}\right)}\right] \cos{ \left(\frac{\theta}{2}\right)}  +  
                \left[ - \sin{ \left(\frac{\pi}{4} - \frac{\gamma}{2}\right)}  \cos{ \left(\frac{\theta}{2}\right)}  +  \cos{ \left(\frac{\pi}{4} - \frac{\gamma}{2}\right)} e^{-i \phi}\sin{ \left(\frac{\theta}{2}\right)} \right] e^{i \phi}\sin{ \left(\frac{\theta}{2}\right)} \\
                \left[\sin{ \left(\frac{\pi}{4} - \frac{\gamma}{2}\right)}  \cos{ \left(\frac{\theta}{2}\right)}  -  \cos{ \left(\frac{\pi}{4} - \frac{\gamma}{2}\right)} e^{-i \phi}\sin{ \left(\frac{\theta}{2}\right)}\right]\cos{ \left(\frac{\theta}{2}\right)} + \left[ \cos{ \left(\frac{\pi}{4} - \frac{\gamma}{2}\right)}  \cos{ \left(\frac{\theta}{2}\right)}  + \sin{ \left(\frac{\pi}{4} - \frac{\gamma}{2}\right)} e^{-i \phi}\sin{ \left(\frac{\theta}{2}\right)} \right] e^{i \phi}\sin{ \left(\frac{\theta}{2}\right)}
            \end{pmatrix}  } \\
        & = \begin{pmatrix} \cos{ \left(\frac{\pi}{4} - \frac{\gamma}{2}\right)} \frac{\cos{ \left(\theta\right)}+1} {2}   + e^{-i \phi} \sin{ \left(\frac{\pi}{4} - \frac{\gamma}{2}\right)} \frac{\sin{ \left(\theta\right)}} {2} - e^{i \phi} \sin{ \left(\frac{\pi}{4} - \frac{\gamma}{2}\right)} \frac{\sin{ \left(\theta\right)}} {2} +  \cos{ \left(\frac{\pi}{4} - \frac{\gamma}{2}\right)} \frac{\cos{ 1- \left(\theta\right)}} {2} \\
        \sin{ \left(\frac{\pi}{4} - \frac{\gamma}{2}\right)} \frac{\cos{ \left(\theta\right)}+1} {2}   - e^{-i \phi} \cos{ \left(\frac{\pi}{4} - \frac{\gamma}{2}\right)} \frac{\sin{ \left(\theta\right)}} {2} + e^{i \phi} \cos{ \left(\frac{\pi}{4} - \frac{\gamma}{2}\right)} \frac{\sin{ \left(\theta\right)}} {2} +  \sin{ \left(\frac{\pi}{4} - \frac{\gamma}{2}\right)} \frac{\cos{ 1- \left(\theta\right)}} {2}  
            \end{pmatrix} \\
            & = \begin{pmatrix} \cos{ \left(\frac{\pi}{4} - \frac{\gamma}{2}\right)}   + (e^{-i \phi}-e^{i \phi}) \sin{ \left(\frac{\pi}{4} - \frac{\gamma}{2}\right)} \frac{\sin{ \left(\theta\right)}} {2} \\
            \sin{ \left(\frac{\pi}{4} - \frac{\gamma}{2}\right)} \  (- e^{-i \phi} + e^{i \phi} ) \cos{ \left(\frac{\pi}{4} - \frac{\gamma}{2}\right)} \frac{\sin{ \left(\theta\right)}} {2} \end{pmatrix} \\
            & = \begin{pmatrix} \cos{ \left(\frac{\pi}{4} - \frac{\gamma}{2}\right)}   + 2i \sin{(\phi)} (\cos{ \left(\frac{\pi}{4} - \frac{\gamma}{2}-\theta\right)} - \cos{ \left(\frac{\pi}{4} - \frac{\gamma}{2}+\theta \right)} )\\
            \sin{ \left(\frac{\pi}{4} - \frac{\gamma}{2}\right)} \  - 2i \sin{(\phi)} (\sin{ \left(\frac{\pi}{4} - \frac{\gamma}{2}+\theta\right)} - \sin{ \left(\frac{\pi}{4} - \frac{\gamma}{2}-\theta \right)} ) \end{pmatrix} 
    \end{split}
\end{equation}

%Given the direction of the rotation, the angle $\alpha$ is negative, so the rotation is $R_{-\alpha}$ which also correspons to $R^{\dag}_{\alpha}$.

%As a result, the quantum discrimination for two pure states can be formulated as follows:
%\begin{align*}
  %q: \textit{qbit}\hspace{3 pt} \triangleright \hspace{3 pt} \textit{meas} (U (q)) 
%\end{align*}




