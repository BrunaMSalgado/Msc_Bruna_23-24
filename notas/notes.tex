\documentclass[10pt,a4paper]{amsart}
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usepackage[mathcal]{euscript}
\usepackage{mathrsfs}  
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{stmaryrd}
\usepackage{graphicx}
\usepackage{mathtools}
\usepackage{pgfplots}
\usepackage{xfrac}
\usepackage{listings}
\usepackage{xcolor}
\usepackage{lstlinebgrd}
\usepackage{ebproof}
\usepackage{graphicx,float}
\usepackage[colorlinks=true, linkcolor=cyan, urlcolor=cyan, citecolor=cyan]{hyperref}
\usepackage[shortlabels]{enumitem}
\usepackage[textsize=tiny,textwidth=45]{todonotes}
\input{macros}
\usepackage[left=2cm,right=2cm,top=2cm,bottom=2cm]{geometry}
\linespread{1.10}
\author{\dots}
\title{Notes}

\lstset{
language=C,
showstringspaces=false,
keywordstyle=\color{blue},
basicstyle=\fontsize{10}{13}\ttfamily,
emph={exit,blue,unif,then,wait},emphstyle=\color{blue},
breaklines=true,
escapeinside={*@}{*@}
}


\usepackage{proof}
\usepackage{amsthm}
\usepackage[all]{xy}
%for definition
\theoremstyle{definition}
\newtheorem{definition}{Definition}[section]

%for examples
\theoremstyle{definition}
\newtheorem{example}[definition]{Example}

%lemmas
\theoremstyle{definition}
\newtheorem{lemma}[definition]{Lemma}

%proposition
\theoremstyle{definition}
\newtheorem{proposition}[definition]{Proposition}
%corollary
\theoremstyle{definition}
\newtheorem{corollary}[definition]{Corollary}

%theorem
\theoremstyle{definition}
\newtheorem{theorem}[definition]{Theorem}

% Renato's macros
\newcommand{\until}{\> \textcolor{blue}{\prog{for}} \>}
\newcommand{\then}{\textcolor{blue}{then}}
\newcommand{\progife}[3]{{ \blue{\prog{if}} \> #1 \> \blue{\prog{then}} \> 
{\prog #2} \> \blue{\prog{else}} \> {\prog #3}}}
\newcommand{\progwhile}[2]{{\blue{\prog{while}} \>  #1 \> \blue{\prog{do}} \> \{ \> {#2}  \> \}}}
\newcommand{\scomp}{\, \blue{;} \,}
\newcommand{\prem}[1]{(\text{if\/ }#1)}
\newcommand{\nline}{\vspace{-5mm}}
\newcommand{\ssto}[1][]{~\to^{#1}~}
\newcommand{\bsto}{~\Downarrow~}
\newcommand{\stp}{\mathit{stop}}
\newcommand{\skp}{\mathit{skip}}
\newcommand{\err}{\mathit{err}}
\providecommand{\comma}{,\operatorname{}\linebreak[1]}		% possibly line-beaking comma
\newcommand{\sep}{\kern1pt\comma\kern-1pt}
\newcommand{\lrule}[3]{\textbf{#1}\quad\frac{#2}{#3}}
\newcommand{\ptt}{{\prog tt}}
\newcommand{\pff}{{\prog ff}}
\newcommand{\unif}{{\prog \blue{unif}}}
\newcommand{\meas}[1]{\mathcal{M}(#1)}
\newcommand{\pmap}{ \xrightharpoonup{\hspace{0.1cm}} }

\begin{document}
\title{Quantum stuff}
\maketitle
%\tableofcontents
\section{Lambda-calculus with conditionals}

\subsection{Syntax}

The term formation rules for conditionals are depicted in \autoref{fig:typing_rules_cond}. 


\begin{figure}[H]
    \begin{equation*}
    \begin{aligned}
    &\hspace{10pt}
    \begin{prooftree}
    \hypo{\Gamma \triangleright v: \mathbb{A}}
    \infer1[(inl)]{\Gamma \triangleright \text{inl}_{\mathbb{B}}(v): \mathbb{A} \oplus \mathbb{B}}
    \end{prooftree}
    \hspace{30pt}
    \begin{prooftree}
    \hypo{\Gamma \triangleright v: \mathbb{B}}
    \infer1[(inr)]{\Gamma \triangleright \text{inr}_{\mathbb{A}}(v): \mathbb{A} \oplus \mathbb{B}}
    \end{prooftree} \\[20pt]
    &\hspace{-20pt}
    \begin{prooftree}
    \hypo{\Gamma \triangleright v: \mathbb{A} \oplus \mathbb{B}}
    \hypo{\Delta, x: \mathbb{A} \triangleright w: \mathbb{D}}
    \hypo{\Delta, y: \mathbb{B} \triangleright u: \mathbb{D}}
    \hypo{E \in \text{Sf}(\Gamma; \Delta)}
    \infer4[(case)]{E \triangleright \text{case } v \{\text{inl}_{\mathbb{B}}(x) \Rightarrow w ; \text{inr}_{\mathbb{A}}(y) \Rightarrow u\}: \mathbb{D}}
    \end{prooftree}
    \end{aligned}
    \end{equation*}
    \caption{Term formation rules for conditionals}
    \label{fig:typing_rules_cond}
    \end{figure}


The rules presented in Figure \ref{fig:typing_rules_cond} are subject 
the properties established in Theorem \autoref{theorem:unique_der}.

\todo[inline,size=\normalsize]{Coloquei as outras 2 regras pq precisamos de pelo menos a primeira para provar a derivação única e como as provas já estavam feitas, achei melhor colocar todas.} 

\todo[inline,size=\normalsize]{Temos D's em  vez de C's por causa do C tb ser usado para os números complexos.} 

\begin{theorem} \label {theorem:unique_der}
    Lambda calculus with conditionals has the following properties:
   \begin{enumerate}
     \item for all judgements $\Gamma \triangleright v$ and $\Gamma' \triangleright v$, te($\Gamma$) $\simeq_{\pi}$  te($\Gamma'$); 
     \item additionally if $\Gamma \triangleright v: \mathbb{A}, \Gamma'\triangleright v: \mathbb{A}'$, and $\Gamma \simeq_{\pi} \Gamma' $, then $\mathbb{A}$ must be equal to $\mathbb{A}'$;
     \item all judgements $\Gamma \triangleright v:\mathbb{A}$ have a unique derivation.
   \end{enumerate}
   \end{theorem}

  \begin{proof}

    \textbf{Property 1}

    For the injections, taking into account the inl and inr derivations in Figure \ref{fig:typing_rules_cond} and

  \begin{figure} [H]
    \begin{equation*}
    \begin{aligned}
      &
      \begin{prooftree}
      \hypo{\Gamma' \triangleright v: \mathbb{A}}
      \infer1[]{\Gamma' \triangleright \text{inl}_{\mathbb{B}}(v): \mathbb{A} \oplus \mathbb{B}}
      \end{prooftree}
      \hspace{60pt}
      \begin{prooftree}
      \hypo{\Gamma' \triangleright v: \mathbb{B}}
      \infer1[]{\Gamma' \triangleright \text{inr}_{\mathbb{A}}(v): \mathbb{A} \oplus \mathbb{B}},
      \end{prooftree} \\
    \end{aligned}
    \end{equation*}
    \end{figure}
it is necessary to prove that te($\Gamma$) $\simeq_{\pi}$  te($\Gamma'$). By induction hypothesis, te($\Gamma$) $\simeq_{\pi}$  te($\Gamma'$). Therefore, property 1 is holds for the injections.


Concerning the case statement, considering  Figure \ref{fig:typing_rules_cond} and 
  
\begin{figure} [H]
    \begin{equation*}
    \begin{aligned}
      \begin{prooftree}
          \hypo{\Gamma' \triangleright v: \mathbb{A} \oplus \mathbb{B}}
          \hypo{\Delta', x: \mathbb{A} \triangleright w: \mathbb{D}}
          \hypo{\Delta', y: \mathbb{B} \triangleright u: \mathbb{D}}
          \hypo{E' \in \text{Sf}(\Gamma'; \Delta')}
          \infer4[]{E' \triangleright \text{case } v \{\text{inl}_{\mathbb{B}}(x) \Rightarrow w ; \text{inr}_{\mathbb{A}}(y) \Rightarrow u\}: \mathbb{D}}
          \end{prooftree}
    \end{aligned}
    \end{equation*}
    \end{figure}

we want to prove that te($E$) $\simeq_{\pi}$  te($E'$). Considering the definition of shuffle, it follows that  te($E$) $\simeq_{\pi}$  te($\Gamma, \Delta$) and te($E'$) $\simeq_{\pi}$  te($\Gamma', \Delta'$). By induction hypothesis, te($\Gamma$) $\simeq_{\pi}$  te($\Gamma$), te($\Delta,x$) $\simeq_{\pi}$  te($\Delta',x$) and te($\Delta,y$) $\simeq_{\pi}$  te($\Delta',y$). Given that 
%\text{te}(\Gamma) \simeq_{\pi}  \text{te}(\Gamma),
\begin{align*}
     \text{te}(\Delta,x) \simeq_{\pi}  \text{te}(\Delta',x) \land \text{te}(\Delta,y) \simeq_{\pi}  \text{te}(\Delta',y) 
    \implies \text{te}(\Delta) \simeq_{\pi}  \text{te}(\Delta'), 
  \end{align*}
 it can be concluded that te($E$) $\simeq_{\pi}$  te($E'$).


%This implies that  te($\Delta$) $\simeq_{\pi}$ te($\Delta'$). Since, $E \in \text{Sf}(\Gamma;\Delta)$ and  $E' \in \text{Sf}(\Gamma';\Delta')$, one has that te($E$) $\simeq_{\pi}$  te($\Gamma, \Delta$) and te($E'$) $\simeq_{\pi}$  te($\Gamma', \Delta'$). Consequently, te($E$) $\simeq_{\pi}$  te($E'$).


\vspace{10pt}
\textbf{Property 2}

For the injections, taking into account the inl and inr derivations in \autoref{fig:typing_rules_cond} and

\begin{figure} [H]
  \begin{equation*}
  \begin{split}
  \begin{aligned}
  & \hspace{15pt}
  \begin{minipage}[t]{0.3\textwidth}
  $\begin{array}{c}
     \Gamma' \triangleright v: \mathbb{A'} \\
    \hline
   \Gamma' \triangleright \text{inl}_{\mathbb{B}}(v):  \mathbb{A'} \oplus \mathbb{B}
\end{array}
$
  \end{minipage} 
 \hspace{20pt}
\begin{minipage}[t]{0.3\textwidth}
$\begin{array}{c}
      \Gamma' \triangleright v:  \mathbb{B'} \\
    \hline
   \Gamma' \triangleright \text{inr}_{\mathbb{A}}(v): \mathbb{A} \oplus \mathbb{B'}
\end{array}
$ \end{minipage}
  \end{aligned}
  \end{split}
  \end{equation*}
  \end{figure}

concerning the left injection it is neccessary to prove that if $\Gamma \triangleright \text{inl}_{\mathbb{B}}(v):  \mathbb{A} \oplus \mathbb{B}$, $\Gamma' \triangleright \text{inl}_{\mathbb{B}}(v):  \mathbb{A'} \oplus \mathbb{B}$, and $\Gamma \simeq_{\pi} \Gamma' $, then $\mathbb{A} \oplus \mathbb{B} $ must be equal to $\mathbb{A}'\oplus \mathbb{B}$. By induction hypothesis over the premises it follows that $\mathbb{A} $ must be equal to $\mathbb{A}'$. Consequentlty, $\mathbb{A}\oplus \mathbb{B}$ must be equal $\mathbb{A'}\oplus \mathbb{B}$  The same reasoning can be applied to the right injection.

Regarding the case statement in considering \autoref{fig:typing_rules_cond} and  

\begin{figure} [H]
  \begin{equation*}
  \begin{split}
  \begin{aligned}
  & \hspace{15pt}
  \begin{minipage}[t]{0.3\textwidth}
  $\begin{array}{c}
       \Gamma\triangleright v: \mathbb{A} \oplus \mathbb{B} \quad \Delta', x: \mathbb{A} \triangleright w: \mathbb{C'} \quad \Delta', y: \mathbb{B}  \triangleright u : \mathbb{C'}   \quad E' \in \text{Sf}(\Gamma';\Delta')  \\
      \hline
     E' \triangleright \text{ case } v \hspace{2pt} \{\text{inl}_{\mathbb{B}}  (x) \Rightarrow w ; \hspace{1pt} \text{inr}_{\mathbb{A}}  (y) \Rightarrow u\}: \mathbb{C'} 
  \end{array}
  $
  \end{minipage} 
  \end{aligned}
  \end{split}
  \end{equation*}
  \end{figure}

we want to prove that if $E \triangleright \text{ case } v \hspace{2pt} \{\text{inl} (x) \Rightarrow w ; \hspace{1pt} \text{inr} (y) \Rightarrow u\}: \mathbb{D}$; $\Gamma'\triangleright \text{ case } v \hspace{2pt} \{\text{inl} (x) \Rightarrow w ; \hspace{1pt} \text{inr} (y) \Rightarrow u\}: \mathbb{D}'$, and $E \simeq_{\pi} E' $, then $\mathbb{D}$ must be equal to $\mathbb{D}'$. Assuming, that  $E \simeq_{\pi} E' $ and knowing that $E \in \text{Sf}(\Gamma;\Delta)$ and  $E' \in \text{Sf}(\Gamma';\Delta')$, one has that

\begin{align*}
  & x: \mathbb{A}  \in \Delta & \\
  \implies & x: \mathbb{A}  \in E \hspace{50pt} \{E \in \text{Sf}(\Gamma;\Delta)\} \\
  \implies & x: \mathbb{A} \in E' \hspace{50pt} \{ E \simeq_{\pi} E' \}  \\
  \implies & x: \mathbb{A}  \in \Delta' \hspace{50pt} \{\text{All terms are well typed and contexts do not share variables}\}
\end{align*}

This proves that $\Delta \simeq_{\pi} \Delta'$. Therefore, by induction hypothesis on the premises of the conditional statement, one has that $\mathbb{D}$ must be equal to $\mathbb{D}'$.
  

\vspace{10pt}
    \textbf{Property 3}

    Firstly it is necessary to demonstrate that the injections have unique derivations. This means proving that the premises of the inl and inr rules in Figure \ref{fig:typing_rules_cond} and in
\begin{figure} [H]
  \begin{equation*}
  \begin{aligned}
    &
    \begin{prooftree}
    \hypo{\Gamma' \triangleright v: \mathbb{A}}
    \infer1[]{\Gamma \triangleright \text{inl}_{\mathbb{B}}(v): \mathbb{A} \oplus \mathbb{B}}
    \end{prooftree}
    \hspace{60pt}
    \begin{prooftree}
    \hypo{\Gamma' \triangleright v: \mathbb{B}}
    \infer1[]{\Gamma \triangleright \text{inr}_{\mathbb{A}}(v): \mathbb{A} \oplus \mathbb{B}}
    \end{prooftree} \\
  \end{aligned}
  \end{equation*}
  \end{figure}

are equal, which means proving that $\Gamma = \Gamma'$. In both cases, the derivation in Figure \ref{fig:typing_rules_cond} enforces that $\Gamma = \Gamma'$.

Now, it is necessary to demonstrate that the case statement in Figure \ref{fig:typing_rules_cond} has a unique derivation. This means proving that the premises in Figure \ref{fig:typing_rules_cond} and in

\begin{figure} [H]
  \begin{equation*}
  \begin{aligned}
    \begin{prooftree}
        \hypo{\Gamma' \triangleright v: \mathbb{A} \oplus \mathbb{B}}
        \hypo{\Delta', x: \mathbb{A} \triangleright w: \mathbb{D}}
        \hypo{\Delta', y: \mathbb{B} \triangleright u: \mathbb{D}}
        \hypo{E \in \text{Sf}(\Gamma'; \Delta')}
        \infer4[]{E \triangleright \text{case } v \{\text{inl}_{\mathbb{B}}(x) \Rightarrow w ; \text{inr}_{\mathbb{A}}(y) \Rightarrow u\}: \mathbb{D}}
        \end{prooftree}
  \end{aligned}
  \end{equation*}
  \end{figure}

are equal, more concretely that $\Gamma = \Gamma'$ and $\Delta = \Delta'$. 

\begin{align*}
  & x: \mathbb{A}  \in \Gamma & \\
  \implies & x: \mathbb{A}  \in E \land   te(x:\mathbb{A}) \in \Gamma'  & \{E \in \text{Sf}(\Gamma;\Delta), te(\Gamma) \simeq_{\pi}  te(\Gamma') \} \\
  \implies & x: \mathbb{A}  \in E \land  x:\mathbb{A} \in \Gamma'  & \{ E \in \text{Sf}(\Gamma;\Delta),E \in \text{Sf}(\Gamma';\Delta') \} \\
\end{align*}

This last implication is related with the fact that in $E$, there can only exist one  variable designated by $x$. Given that a shuffle preserves the relative order of the variables in each context, it follows that $\Gamma = \Gamma'$. The same reasoning can be applied to $\Delta$ and $\Delta'$, which concludes the proof. 


  \end{proof}

\bibliographystyle{alpha} 
\bibliography{biblio}
\end{document}
