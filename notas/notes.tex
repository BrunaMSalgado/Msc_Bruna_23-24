\documentclass[10pt,a4paper]{amsart}
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usepackage[mathcal]{euscript}
\usepackage{mathrsfs}  
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{mathrsfs}  
\usepackage{amssymb}
\usepackage{stmaryrd}
\usepackage{graphicx}
\usepackage{mathtools}
\usepackage{pgfplots}
\usepackage{xfrac}
\usepackage{listings}
\usepackage{xcolor}
\usepackage{lstlinebgrd}
\usepackage{ebproof}
\usepackage{graphicx,float}
\usepackage[colorlinks=true, linkcolor=cyan, urlcolor=cyan, citecolor=cyan]{hyperref}
\usepackage[shortlabels]{enumitem}
\usepackage[textsize=tiny,textwidth=45]{todonotes}
\input{macros}
\usepackage[left=2cm,right=2cm,top=2cm,bottom=2cm]{geometry}
\usepackage{tcolorbox}
\usepackage{braket}
\usepackage{quantikz}
\usepackage{tikz-cd}
\linespread{1.10}
\author{\dots}
\title{Notes}

\lstset{
language=C,
showstringspaces=false,
keywordstyle=\color{blue},
basicstyle=\fontsize{10}{13}\ttfamily,
emph={exit,blue,unif,then,wait},emphstyle=\color{blue},
breaklines=true,
escapeinside={*@}{*@}
}


\usepackage{proof}
\usepackage{amsthm}
\usepackage[all]{xy}
%for definition
\theoremstyle{definition}
\newtheorem{definition}{Definition}[section]

%for examples
\theoremstyle{definition}
\newtheorem{example}[definition]{Example}

%lemmas
\theoremstyle{definition}
\newtheorem{lemma}[definition]{Lemma}

%proposition
\theoremstyle{definition}
\newtheorem{proposition}[definition]{Proposition}
%corollary
\theoremstyle{definition}
\newtheorem{corollary}[definition]{Corollary}

%theorem
\theoremstyle{definition}
\newtheorem{theorem}[definition]{Theorem}

% Renato's macros
\newcommand{\until}{\> \textcolor{blue}{\prog{for}} \>}
\newcommand{\then}{\textcolor{blue}{then}}
\newcommand{\progife}[3]{{ \blue{\prog{if}} \> #1 \> \blue{\prog{then}} \> 
{\prog #2} \> \blue{\prog{else}} \> {\prog #3}}}
\newcommand{\progwhile}[2]{{\blue{\prog{while}} \>  #1 \> \blue{\prog{do}} \> \{ \> {#2}  \> \}}}
\newcommand{\scomp}{\, \blue{;} \,}
\newcommand{\prem}[1]{(\text{if\/ }#1)}
\newcommand{\nline}{\vspace{-5mm}}
\newcommand{\ssto}[1][]{~\to^{#1}~}
\newcommand{\bsto}{~\Downarrow~}
\newcommand{\stp}{\mathit{stop}}
\newcommand{\skp}{\mathit{skip}}
\newcommand{\err}{\mathit{err}}
\providecommand{\comma}{,\operatorname{}\linebreak[1]}		% possibly line-beaking comma
\newcommand{\sep}{\kern1pt\comma\kern-1pt}
\newcommand{\lrule}[3]{\textbf{#1}\quad\frac{#2}{#3}}
\newcommand{\ptt}{{\prog tt}}
\newcommand{\pff}{{\prog ff}}
\newcommand{\unif}{{\prog \blue{unif}}}
\newcommand{\meas}[1]{\mathcal{M}(#1)}
\newcommand{\pmap}{ \xrightharpoonup{\hspace{0.1cm}} }

\begin{document}
\title{Quantum stuff}
\maketitle
%\tableofcontents
\section{Lambda-calculus with conditionals}

\subsection{Syntax}

Considering a class $G$ of ground types, the grammar of types for linear lambda calculus with conditionals corresponds to:

\begin{equation*} \label{eq:grammartypes}
  \centering
   \typeA ::= X \in G \hspace{3 pt} \vert \hspace{3 pt} \typeI \hspace{3 pt}  \vert \hspace{3 pt} \typeA  \otimes  \typeA \hspace{3 pt} \vert  \hspace{3 pt} \typeA  \oplus \typeA \hspace{3 pt}  \vert  \hspace{3 pt} \typeA \multimap  \typeA
  \end{equation*}

The term formation rules for conditionals are depicted in \autoref{fig:typing_rules_cond}. 

\begin{figure}[H]
    \begin{equation*}
    \begin{aligned}
    &\hspace{10pt}
    %
    \begin{prooftree}
        \hypo{\Gamma \vljud v: \typeA}
        \infer1[(inl)]{\Gamma \vljud \inl_{\typeB}(v): \typeA \oplus \typeB}
    \end{prooftree}
    %
    \hspace{30pt}
    %
    \begin{prooftree}
        \hypo{\Gamma \vljud v: \typeB}
        \infer1[(inr)]{\Gamma \vljud \inr_{\typeA}(v): \typeA \oplus \typeB}
    \end{prooftree} 
    %
    \\[20pt]
    &\hspace{-20pt}
    %
    \begin{prooftree}
        \hypo{\Gamma \vljud v: \typeA \oplus \typeB}
        \hypo{\Delta, x: \typeA \vljud w: \typeD}
        \hypo{\Delta, y: \typeB \vljud u: \typeD}
        \hypo{E \in \Shuff(\Gamma; \Delta)}
        \infer4[(case)]{E \vljud \text{case } v\,
        \{\inl_{\typeB}(x) 
            \Rightarrow w ; \,
          \inr_{\typeA}(y) \Rightarrow u
        \}: \typeD}
    \end{prooftree}
    %
    \\[10pt]
    \end{aligned}
    \end{equation*}
    \caption{Term formation rules for conditionals}
    \label{fig:typing_rules_cond}
\end{figure}
The rules presented in Figure \ref{fig:typing_rules_cond} enjoy the following
properties.

\begin{theorem} \label {theorem:unique_der}
   Lambda calculus with conditionals has the following properties:
   \begin{enumerate}
     \item\label{perm} for all judgements $\Gamma \vljud v$ and $\Gamma'
             \vljud v$, te($\Gamma$) $\simeq_{\pi}$  te($\Gamma'$); 
     %
     \item\label{type} additionally if $\Gamma \vljud v: \typeA,
       \Gamma' \vljud v: \typeA'$, and $\Gamma \simeq_{\pi}
       \Gamma'$, then $\typeA$ must be equal to $\typeA'$;
     %
     \item\label{der} all judgements $\Gamma \vljud v:\typeA$ have a unique derivation.
\end{enumerate}
\end{theorem}
%
\begin{proof}
It follows in all three cases from induction over the length of derivation
trees. 

Let us focus first on Property~\eqref{perm}. The case of the rules concerning
injections is direct. As for rule~$\rulename{cond}$ take two contexts $E$ and
$E'$ for the same conditional. According to this rule we obtain contexts
$\Gamma$, $\Gamma'$, $\Delta$, $\Delta'$ such that $E \in
\Shuff(\Gamma;\Delta)$ and $E' \in \Shuff(\Gamma';\Delta')$. It follows from
induction that  $\Gamma \simeq_\pi \Gamma'$ and $\Delta \simeq_\pi \Delta'$,
and the proof is then obtained from the sequence of equivalences,
\begin{align*}
        \text{te}(E) & \simeq_\pi \text{te}(\Gamma, \Delta) 
        \\
        & \simeq_\pi \text{te}(\Gamma', \Delta')
        \\
        & \simeq_\pi \text{te}(E')
\end{align*}
Concerning Property~\eqref{type}, the case of the rules concerning injections
is direct and the case of rule~$\rulename{cond}$ is a corollary of
Property~\eqref{perm}. Finally let us consider Property~\eqref{der}. Again the
case concerning injections is direct and we thus focus only on
rule~$\rulename{cond}$. According to this rule we obtain contexts $\Gamma$,
$\Gamma'$, $\Delta$, $\Delta'$ such that $E \in \Shuff(\Gamma;\Delta)$ and $E
\in \Shuff(\Gamma';\Delta')$. By an appeal to Property~\eqref{perm} we also
obtain $\Gamma \simeq_\pi \Gamma'$ and $\Delta \simeq_\pi \Delta'$, and thus
since shuffling preserves relative orders we obtain $\Gamma = \Gamma'$ and
$\Delta = \Delta'$. The proof then follows by induction.
\end{proof}

\begin{lemma}[Exchange and Subsitution]
\label{lem:exh_and_sub} 
For every judgement $\Gamma,x: \typeA, y: \typeB, \Delta \vljud v: \typeD$ the
judgement $\Gamma, y:\typeB, x:\typeA, \Delta \vljud v:
\typeD$ is derivable. Not only this, given judgements  $\Gamma,x:\typeA \vljud
v: \typeB$ and $\Delta \vljud w: \typeA$ the judgement $\Gamma, \Delta \vljud
v[w/x]: \typeB$ is also derivable.
\end{lemma}


\begin{proof}
We start with the exchange property which follows by induction over the length
of derivation trees. The rules that involve injections are direct.  The rule
$\rulename{case}$ calls for case distinction, more specifically we  distinguish
between the cases in which both variables ($x : \typeA$ and $y : \typeB$) are
in $\Gamma$, both are in $\Delta$, and otherwise. The first two cases follow
straightforwardly by induction and the definition of a shuffle. For the third
case consider a judgement $E_1,x : \typeA, y : \typeB, E_2 \vljud \text{case }
v\, \{\inl_{\typeF}(a) \Rightarrow w ; \, \inr_{\typeE}(b) \Rightarrow u \}:
\typeD$, and assume with no loss of generality that $\Gamma$ is of the form
$\Gamma_1, x : \typeA, \Gamma_2$ and $\Delta$ of the form $\Delta_1, y :
\typeB, \Delta_2$. The proof now follows directly from the implication,
\[
        E_1, x : \typeA, y : \typeB, E_2 \in \Shuff(\Gamma_1, x : \typeA, \Gamma_2 ; \,
        \Delta_1, y : \typeB, \Delta_2)
        \Longrightarrow
        E_1, y : \typeB, x : \typeA, E_2 \in \Shuff(\Gamma_1, x : \typeA, \Gamma_2 ; \,
        \Delta_1, y : \typeB, \Delta_2)
\]
(which holds by the definition of a shuffle).

Finally we now focus on the substitution rule which also follows by induction over the
length of derivation trees. Again the cases involving the injections are direct,
and we thus only detail the proof of rule $\rulename{case}$. Consider then
judgements $E,x : \typeA \vljud \text{case } v\, \{\inl_{\typeD}(a) \Rightarrow
w ; \, \inr_{\typeE}(b) \Rightarrow u \}: \typeB$ and
$Z \vljud t : \typeA$ with $E \in \Shuff(\Gamma; \Delta)$. According to the definition
of a shuffle either $\Gamma$ is of the form $\Gamma_1, x: \typeA$ or $\Delta$ is
of the form $\Delta_1, x : \typeA$. The first case follows directly and the second case
is a corollary of the exchange rule.
\end{proof}

The equational system for the conditionals is shown in Figure
\ref{fig:equations-in-context-cond}.


  \begin{figure}[h!]
    \centering
    \begin{tcolorbox}[colframe=black, colback=white, boxrule=0.6pt, arc=1pt,boxsep=1pt,top=1pt,bottom=1pt, width=0.85 \textwidth]
    \begin{equation*}
        \begin{split}
          &(\beta_{case}^{inl}) \hspace{3pt} \text{case } 
          \inl_{\typeB}(v)\, \{ \inl_{\typeB} (x) \Rightarrow w 
          ;\, \inr_{\typeA} (y) 
          \Rightarrow u\}= w[v/x]
          %
          \\
          %
          &(\beta_{case}^{inr}) \hspace{3pt} \text{case } 
          \inr_{\typeA}(v)\, \{ \inl_{\typeB} (x) \Rightarrow w 
          ;\, \inr_{\typeA} (y) 
          \Rightarrow u\}= u[v/y]
          %
          \\
          %
          %
          & (\eta_{case}) \hspace{3pt} \text{case } v\, \{\text{inl}_{\typeB} (y) \Rightarrow w [ \text{inl}_{\typeB}(y)/x] ;\, \text{inr}_{\typeA} (z) \Rightarrow w [ \text{inr}_{\typeA}(z)/x]\} = w[v/x] 
        \end{split}
    \end{equation*}
    \end{tcolorbox}
    \caption{Equational system for the conditionals}
    \label{fig:equations-in-context-cond}
    \end{figure}


\subsubsection{Linear $\lambda$-calculus and quantum computation}

We now illustrate the use of the previous language for describing quantum
programs. To this effect, we first consider a type \emph{qbit} of qubits, the
basic unit of information in quantum computation. We then regard $\typeI \oplus
\typeI$ to be the type of bits, a common approach not only in quantum
computation~\cite{selinger04} but also in the categorical interpretation of a
`truth-values' object~\cite{johnstone02,cho15}. Next we propound the following
basic quantum operations:  the conversion of a bit into a qubit, $q : \typeI
\oplus \typeI  \to \emph{qbit}$, the measurement of a qubit,
$\emph{meas}:\emph{qbit} \to \typeI \oplus \typeI$, and a pre-determined set of
operations on $n$-qubits, $\emph{U}:\emph{qbit},\ldots,\emph{qbit} \to
\emph{qbit}^{\otimes n}$. The latter set can include for example the Hadamard
gate $H : \emph{qbit} \to \emph{qbit}$, the not-gate $X : \emph{qbit} \to
\emph{qbit}$, or the cnot-gate $CNOT : \emph{qbit},\emph{qbit} \to
\emph{qbit}^{\otimes 2}$. We consider as well a pre-determined set of quantum
states $\ket{\psi} : \typeI \to \emph{qbit}$.  Finally note that the values
\emph{true} and \emph{false} (in the type $\typeI \oplus \typeI$) are regarded to be 
the terms $\inl(\ast)$ and $\inr(\ast)$ respectively.

Let us now apply this machinery to two well-known problems in quantum computation
and quantum information.

\begin{example}[Coin toss]
~\todo[inline]{Descrever aqui como obter valores $p_0$ e $p_1$ para depois
poderem ser usados no próximo exemplo.}
\end{example}

In the quantum setting, tossing a `fair' coin can be described as preparing a qubit in a superposition of two states, $\ket{0}$ and $\ket{1}$, representing `heads' and `tails', each with an equal probability of $0.5$ and then measuring it. This is achieved by simply applying a Hadamard gate to the initial state $\ket{0}$, followed by a measurement.
More generally, tossing a coin (whether `fair' or `unfair') can be described as preparing a qubit in a superposition of  $\ket{0}$ and $\ket{1}$, with probabilities $p$ and $1-p$, respectively,  and then measuring it.  Considering $p= \cos(\theta/2)^2$ and the standard quantum gate operation $R_{y,\theta} : \emph{qbit} \to \emph{qbit}$,  this process is described by the following $\lambda$-term:

\begin{align*}
  &\textbf{CoinToss} = - \vljud \emph{meas} (R_{y,\theta} (\ket{0})): \typeI \oplus \typeI
\end{align*}

\begin{example}[Quantum state discrimination]

Quantum state discrimination is a pivotal challenge in quantum information,
fundamental to the extraction of classical information from quantum systems.
While orthogonal states can be perfectly distinguished, the same does not apply
to nonorthogonal states. In fact even when the set of possible nonorthogonal
states is known, determining the optimal discrimination strategy is considered
a nontrivial problem.

When distinguishing between two nonorthogonal quantum states, the Helstrom
measurement represents the optimal strategy
\cite{helstromQuantumDetectionEstimation1976}. In the case where both states
are pure, the Helstrom measurement corresponds to a projective measurement
\cite{barnett2009quantum}.  When operating within the computational basis, a
projective measurement can be understood as the application of a unitary
operator followed by a subsequent measurement in the computational basis. Thus
the Helstrom measurement can be interpreted as a unitary transformation applied
to the quantum state, followed by a measurement in the computational basis. 

We will now show how to describe this discrimination task in
$\lambda$-calculus.  Consider two pure states $\ket{\psi_0}$ and
$\ket{\psi_1}$, prepared \emph{a priori} with probabilities $p_0$ and $p_1 = 1-p_0$,
respectively. Consider as well an operation $U : \emph{qbit} \to \emph{qbit}$ which
corresponds to the basis-change associated with the Helstrom measurement.
The relevant $\lambda$-terms are then:
\begin{align*}
  &\textbf{StatePreparation} =  b: \typeI \oplus \typeI  \vljud  \text{case } b\,
  \{\inl_{\typeB}(x) \Rightarrow \ket{\psi_0} ; \inr_{\typeA}(y) \Rightarrow \ket{\psi_1}\}: \textit{qbit} \\
  &\textbf{HMeasure} =  x : \emph{qbit} \vljud \emph{meas} (\emph{U}(x)): \typeI \oplus \typeI \\
  &\textbf{Discrimination} = (p_0,p_1): \typeI\oplus \typeI \vljud \textbf{HMeasure} [ \textbf{StatePreparation} [(p_0,p_1)/ b] / x] : \typeI\oplus \typeI
\end{align*}
\end{example}


\begin{example}[Quantum teleportation]
\cite{bennett1993teleporting} introduced the concept of quantum teleportation,
a protocol that allows the transfer of  unknown quantum states between distant
parties.  The quantum teleportation protocol is a fundamental building block of
quantum communication, quantum computation, and quantum networks, its
applications ranging from secure quantum communication to distributed quantum
computing
\cite{briegel1998quantum,gottesman1999demonstrating,kimble2008quantum}.
Conceptually it can be described as follows: Alice and Bob share an entangled
pair of qubits, specifically in a Bell state. Alice keeps the first qubit and
Bob the second. Moreover, Alice has a qubit in an unknown state $\ket{\psi}$
that she wants to send to Bob.  Alice entangles her qubit and the first qubit
in the Bell state, and then measures both. The result of this measurement is
two classical bits that Alice then sends to Bob though a classical channel.
Based on the measurement results, Bob applies a correction to his qubit so it
matches the initial state $\ket{\psi}$.  The circuit corresponding to the
implementation of quantum teleportation is depicted in \autoref{fig:teleport}.


\begin{figure} [H]
  \centering
  \begin{quantikz} [column sep=0.2cm, row sep=0.5cm] 
      \lstick{$\ket{\psi}$}  & \qw &\qw & \qw & \qw & \qw& \ctrl{1}\gategroup[2,steps=4,style={dashed,rounded
      corners,fill=blue!20, inner
      xsep=2pt},background,label style={label
      position=below,anchor=north,yshift=-0.2cm}]{{\sc
      BellMeasure}} & \gate{H} & \qw & \meter{} & \setwiretype{c}  &  & \gategroup[3,steps=4,style={dashed,rounded
      corners,fill=blue!20, inner
      xsep=2pt},background,label style={label
      position=below,anchor=north,yshift=-0.2cm}]{{\sc
      Correction}}  &  & & \ctrl[vertical
wire=c]{2}  \\
      \lstick {$\ket{0}$}  &\gate{H}\gategroup[2,steps=3,style={dashed,rounded
      corners,fill=blue!20, inner
      xsep=2pt},background,label style={label
      position=below,anchor=north,yshift=-0.2cm}]{{\sc
      EPR}} & \qw  & \ctrl{1}& \qw & \qw & \targ{} & \qw & \qw & \meter{} & \setwiretype{c} & & & \ctrl[vertical
wire=c]{1} \\
      \lstick{$\ket{0}$}  &  \qw & \qw &  \targ{} & \qw &\qw&\qw & \qw & \qw& \qw & \qw & \qw &  \qw & \gate{X} & \qw & \gate{Z} 
 \end{quantikz}
  \caption{Quantum Teleportation Protocol}
  \label{fig:teleport}
\end{figure}
We first describe each of the rectangles filled in blue separately, and using
standard quantum gate operations, namely $H: \emph{qbit} \to \emph{qbit}$, $X:
\emph{qbit} \to  \emph{qbit}$, $Z: \emph{qbit} \to \emph{qbit}$, and
$\emph{CNOT}: \emph{qbit}, \emph{qbit} \to \emph{qbit} \otimes \emph{qbit}$:
\begin{align*}
   &\textbf{EPR} =  \emph{CNOT} (\emph{H}\ket{0},\ket{0}) : \emph{qbit} \otimes
   \emph{qbit}  \\ 
   %
   &\textbf{BellMeasure} =  q_{1}: \textit{qbit}, q_{2}: \textit{qbit}
   \vljud  \text{pm} \, \textit{CNOT} (q_{1},q_{2})
  \,  \text{to}\, x \otimes y. \,
   \textit{meas} (\textit{H} (x)) \otimes \textit{meas} (y) :
   \left(\typeI\oplus \typeI\right) \otimes \left(\typeI\oplus
   \typeI\right) \\
   %
   &\textbf{Correction}= q: \textit{qbit}, x: \typeI \oplus \typeI,  y:
        \typeI \oplus \typeI \vljud  \text{case } x
       \,  \{\inl (x_{0}) \Rightarrow 
                x_0 \text{ to } \ast. \, \text{case }
                y \,  \{\inl (y_{0})  \Rightarrow  y_0 \text{ to } \ast.
                        \, q; 
                \\
   &   \hspace{333pt} \inr (y_{1}) \Rightarrow y_1 \text{ to } \ast. \, \emph{X}
(q)\} ; \\ 
   & \hspace{215pt}\inr (x_{1})  \Rightarrow x_1 \text{ to } \ast. \,
        \text{case}\hspace{2pt} y\,  \{\inl (y_{0})  \Rightarrow
        y_0 \text{ to } \ast. \, \emph{Z}(q);  
\\ 
   &\hspace{333pt} \inr (y_{1}) \Rightarrow{} y_1 \text{ to } \ast. \, \emph{Z}
(\emph{X}(q)) \}\} : \emph{qbit}
\end{align*}
Designating the qubit to be teleported as $qb_0$, one then describes the
teleportation procedure in $\lambda$-calculus as follows:
 \begin{align*}
  \textbf{QTP} = qb_{0}: \textit{qbit}\hspace{3 pt} \vljud \hspace{3 pt} & \text{pm} \hspace{5pt} \textbf{EPR} \hspace{5pt} \text{to} \hspace{5pt}  qb_{1} \otimes qb_{2}.  \notag \\
     & \text{pm}\hspace{5pt} \textbf{BellMeasure}\, [qb_0/q_1,qb_{1}/q_2] \hspace{5pt}  \text{to} \hspace{5pt} c_{0}\otimes c_{1} . \notag \\
     & \textbf{Correction}\, [qb_{2}/q,c_{0}/x, c_{1}/y] 
     : \emph{qbit} 
 \end{align*}

\end{example}
 
 \subsection{Interpretation}

Now that we have a basic syntactic theory of conditionals, it is useful to
define the meaning of the extended calculus' terms within the ``reality'' of
interest -- that is, to provide a semantics for the calculus' conditionals in a
given ``reality", more technically a mathematical model with suitable
structure. In our work such a model will correspond to a distributive symmetric
monoidal (closed) category~\cite{maclane13}. In more detail, 
\begin{definition}
        A category $\catC$ is called monoidal when it comes equipped with a
        bifunctor $\otimes: \catC \times \catC \to \catC$ -- which intuitively
        acts as a monoid operation -- and an object $I$ -- which intuitively
        acts as the corresponding unit -- such that a number of diagrams
        commute (see the full details in~\cite{maclane13}). We call this
        category symmetric monoidal if it additionally comes equipped with a
        natural isomorphism $\sw : A \otimes B \cong B \otimes A$ for all
        objects $A,B$ in $\catC$.

        We say that a monoidal category $\catC$ is closed if for each object
        $A$ in $\catC$ the functor $- \otimes A$ has a right adjoint,
        denoted by $A \multimap -$. 
\end{definition}

\begin{definition}
Consider a category $\catC$.  We say that it has (binary) coproducts if for any
objects $A$ and $B$ in $\catC$ there also exists an object $A \oplus B$ in
$\catC$ with morphisms $\inl : A \to A \oplus B$ and $\inr : B \to A \oplus B$
that satisfy a certain universal property: specifically for every two morphisms
$f  : A \to C$ and $g : B \to C$ there exists a \emph{unique} morphism $[f,g] :
A \oplus B \to C$ that makes the diagram below commute.
\[
\begin{tikzpicture}
  \matrix (m) [matrix of math nodes,row sep=4em,column sep=7em,minimum width=2em]
  {
   & C &  \\
    A  & A \oplus B & B\\
  };
  \path[-stealth]
    (m-2-1) edge  node [above] {$f$} (m-1-2)
    (m-2-3) edge  node [above] {$g$} (m-1-2)
    (m-2-1) edge  node [below] {$\inl$} (m-2-2)
    (m-2-3) edge  node [below] {$\inr$} (m-2-2)
    (m-2-2) edge [dotted]  node [right] {$[f,g]$} (m-1-2);
    ;
\end{tikzpicture}
\]
\end{definition}

\begin{definition}
        A monoidal category $\catC$ with coproducts is called
        distributive if for every object $A$ in $\catC$ the
        functor $- \otimes A$ preserves coproducts. Explicitly
        this means that the morphism,
        \[
                [\inl \otimes \id, \inr \otimes \id] : B \otimes A \oplus C \otimes                     A \to (B \oplus C) \otimes A
        \]
        is actually an isomorphism. We will denote the respective inverse
        by $\dist$. Note that if $\catC$ is monoidal closed then it is automatically
        distributive as left adjoints preserve all colimits.
\end{definition}

% Let $\mathcal{C}$ be a monoidal closed category and let $X,$ $Y,$ and $Z$ be objects in $\mathcal{C}$. The morphism $\dist_{X, Y,Z}: X \otimes  \left(Y \oplus Z\right) \xrightarrow{} \left(X \otimes Y\right) \oplus \left(X \otimes Y\right)$, denotes the distributive property of the tensor product over the coproduct.  This distributive property holds in monoidal closed categories with coproducts because the tensor functor is a left adjoint (to the internal hom), and left adjoints preserve colimits.

Before presenting the interpretation of $\lambda$-calculus with conditionals in
distributive symmetric monoidal (closed) categories let us give some examples
of the latter in order to illustrate our work's broad range of applicability.

\begin{example}
Examples of monoidal closed categories with coproducts include the category of sets, the category of vector spaces, and the category of partial orders. In the category of sets, the tensor product is the cartesian product, the monoidal unit is the singleton set, the coproduct is the disjoint union, and the internal hom consists of all functions between sets. For the category of vector spaces, the tensor product is the standard tensor product of vector spaces, the monoidal unit is the field of scalars, the coproduct is the direct sum, and the internal hom is the space of linear maps. In the category of partial orders, the tensor product corresponds to the meet ($\wedge$), the monoidal unit to the the singleton poset, the coproduct to the join ($\vee$), and the internal hom is the poset of monotone functions ordered pointwise.
\end{example}

We now present the interpretation of $\lambda$-calculus with conditionals.
First the new type $A \oplus B$ is interpreted as $\sem{A \oplus B} = [\![A
]\!] \oplus [\![ B ]\!]$. As for the new terms, the corresponding
interpretation is defined inductively in \autoref{fig:denotational_sem cond}.

\begin{figure}[H]
  \begin{equation*}
  \begin{aligned}
  &\hspace{10pt}
  %
  \begin{prooftree}
      \hypo{ [\![\Gamma \vljud v: \typeA]\!] = m }
      \infer1[]{ [\![ \Gamma \vljud \text{inl}_{\typeB} (v):  \typeA \oplus \typeB  ]\!] = \inl  \comp m}
  \end{prooftree}
  %
  \hspace{120pt}
  %
  \begin{prooftree}
    \hypo{ [\![\Gamma \vljud v: \typeB]\!] = m }
    \infer1[]{ [\![ \Gamma \vljud \text{inr}_{\typeA} (v):  \typeA \oplus \typeB  ]\!] = \inr  \comp m}
\end{prooftree}
  %
  \\[20pt]
  &\hspace{-20pt}
  %
  \begin{prooftree}
      \hypo{[\![\Gamma\vljud v: \typeA \oplus \typeB ]\!] = b}
      \hypo{[\![\Delta, x:\typeA \vljud w: \typeD ]\!] = p}
      \hypo{ [\![\Delta,y:\typeB \vljud u: \typeD ]\!] = q }
      \hypo{E \in \Shuff(\Gamma; \Delta)}
      \infer4[]{ [\![E \vljud \text{case } v\,  \{\text{inl}_{\typeB} (x) \Rightarrow w ;\, \text{inr}_{\typeA} (y) \Rightarrow u\}: \typeD ]\!] =   [p,q] \comp (\text{jn}_{\Delta;\typeA}\comp \sw \oplus \text{jn}_{\Delta;\typeB}\comp \sw) \comp \dist \comp (b \otimes \text{id}) \comp \text{sp}_{\Gamma;\Delta} \comp \text{sh}_{E}}
  \end{prooftree}
  %
  \\[10pt]
  \end{aligned}
  \end{equation*}
  \caption{Judgment interpretation for conditionals}
\label{fig:denotational_sem cond}
\end{figure}


The next step is to demonstrate that the equations in Figure \ref{fig:equations-in-context-cond} are valid under the given interpretation. To achieve this, we first establish the following lemma.

\begin{lemma}[Exchange and Substitution]
\label{lem_interpret_exch:sub} 
For all judgements $\Gamma,x:\typeA, y:\typeB, \Delta \vljud v: \typeD, \> $
$\Gamma,x:\typeA \vljud v: \typeB$ and $\Delta \vljud w: \typeA$  the following
equations hold: 
  \begin{equation*}
\begin{split}
  [\![\Gamma,x:\typeA, y:\typeB, \Delta \vljud v: \typeD]\!] = [\![\Gamma,y:\typeB,x:\typeA,  \Delta \vljud v: \typeD]\! ] \comp \text{exch}_{\Gamma, \underline{ \typeA, \typeB} ,\Delta} \\
  [\![\Gamma, \Delta \vljud v[w/x]: \typeB]\!] = [\![\Gamma, x:\typeA \vljud v: \typeB]\!]\comp \text{jn}_{\Gamma;\typeA} \comp (\text{id} \otimes [\![ \Delta  \vljud w: \typeA]\!] ) \comp \text{sp}_{\Gamma;\Delta} 
\end{split}
  \end{equation*}
\end{lemma}

\begin{proof}
  We begin with the exchange property. The rules involving injections are
  straightforward. As for the rule~$\rulename{case}$, we distinguish between
  the scenarios where both variables ($x : \typeA$ and $y : \typeB$) are in
  $\Gamma$, both are in $\Delta$, or they are distributed across $\Gamma$ and
  $\Delta$. We begin with the first case. 
  \begin{align*}
    & \sem{\Gamma,x, y, \Delta \vljud \text{case }  v\,  \{\text{inl}_{\typeD} (a) \Rightarrow w ;\, \text{inr}_{\typeE} (b) \Rightarrow u\}} \\ 
    &\triangleq   [\sem{w}  , \sem{u}] \comp (\text{jn}_{E;\typeD}
    \comp \sw \oplus \text{jn}_{E;\typeE } \comp \sw) 
    \comp (\sem{ v} \otimes \id)  
    \comp \text{sp}_{\Gamma_{1},\typeA, \typeB,\Gamma_{2};E} 
    \comp \text{sh}_{\Gamma,\typeA, \typeB,\Delta}
    & \\
    & =  [\sem{w},\sem{u}] \comp (\text{jn}_{E;\typeD}
    \comp \sw \oplus \text{jn}_{E;\typeE } \comp \sw) 
    \comp (\sem{v} \comp\, \text{exch}_{\Gamma_{1}, \underline{\typeA,\typeB},\Gamma_{2}} 
    \otimes \id) \comp \text{sp}_{\Gamma_{1},\typeA, \typeB,\Gamma_{2};E} 
    \comp \text{sh}_{\Gamma,\typeA, \typeB,\Delta}
    & \text{(Induction)}\\
    &  =  \dots  \comp (\sem{v} \otimes \id) 
          \comp (\text{exch}_{\Gamma_1, \underline{\typeA, \typeB}, \Gamma_2} \otimes \text{id}) \comp \text{sp}_{\Gamma_{1},\typeA,\typeB, \Gamma_{2};E} \comp  \text{sh}_{\Gamma,\typeA, \typeB,\Delta} & {}\\
    & = \dots \comp (\sem{v} \otimes \id) \comp \text{sp}_{\Gamma_{1},\typeB,\typeA, \Gamma_{2};E} 
          \comp \text{sh}_{\Gamma,\typeB, \typeA,\Delta}  
          \comp \text{exch}_{\Gamma,  \underline{\typeA,\typeB}, \Delta} 
    & {\text{(Coherence)}} \\
    & \triangleq \sem{\Gamma,y, x, \Delta \vljud \text{case } v\,  \{\text{inl}_{\typeE} (a) \Rightarrow w ;\, \text{inr}_{\typeD} (b) \Rightarrow u\}} 
    \comp \text{exch}_{\Gamma,  \underline{\typeA, \typeB}, \Delta}
  \end{align*}
Let us now focus on the second case, \ie\ both variables live in $\Delta$.
%
%The second case follows by induction, the coherence theorem for symmetric monoidal categories, the universal property of the coproduct, and naturality of $\alpha,$ $\lambda,$ $\rho,$ and $\sw$ and their inverses.
%
% \left[[\![ w ]\!] ,[\![ u ]\!]\right] \comp (\text{jn}_{\Delta_{1},\typeA,\typeB}\comp \sw \oplus \text{jn}_{\Delta_{1},\typeA,\typeB} \comp \sw 
\begin{align*}
  & \sem{\Gamma,x, y, \Delta \vljud \text{case } \, v\, \{\text{inl} (a) \Rightarrow w ;\, \text{inr} (b) \Rightarrow u\}} \\
  & \triangleq  [\sem{w} ,\sem{u}]\comp (\text{jn}
  \comp \sw \oplus \text{jn} \comp \sw) 
  \comp \dist \comp (\sem{v} \otimes \id) \comp 
  \text{sp}_{} 
  \comp \text{sh}_{}  \\
  & = [\sem{ w }  \comp \text{exch}, \sem{u}\comp \text{exch}] \comp (\text{jn}\comp \sw \oplus \text{jn} \comp \sw) \comp \dist \comp (\sem{v} \otimes \id) \comp\text{sp} \comp \text{sh}
  & \text{(Induction)}\\
  & = [\sem{ w }, \sem{u}] 
  \comp (\text{exch} \oplus \text{exch}) 
  \comp (\text{jn}\comp \sw \oplus \text{jn} \comp \sw) 
  \comp \dist \comp (\sem{v} \otimes \id) \comp\text{sp} \comp \text{sh} 
  & \text{(Coproduct laws)}
  \\
  & = [\sem{ w }, \sem{u}] 
  \comp (\text{jn}\comp \sw \oplus \text{jn} \comp \sw) 
  \comp (\id \otimes \text{exch} \oplus \id \otimes \text{exch})
  \comp \dist \comp (\sem{v} \otimes \id) \comp\text{sp} \comp \text{sh} 
  & \text{(Coherence)}
  \\
  & = [\sem{ w }, \sem{u}] 
  \comp (\text{jn}\comp \sw \oplus \text{jn} \comp \sw) 
  \comp \dist 
  \comp (\id \otimes \text{exch}) \comp (\sem{v} \otimes \id) \comp\text{sp} \comp \text{sh} 
  & \text{(Naturality)}
  \\
  & = [\sem{ w }, \sem{u}] 
  \comp (\text{jn}\comp \sw \oplus \text{jn} \comp \sw) 
  \comp \dist 
  \comp (\sem{v} \otimes \id) \comp\text{sp} \comp \text{sh} 
  \comp \text{exch}
  & \text{(Coherence)}
  \\
  & \triangleq \sem{\Gamma,y, x, \Delta \vljud \text{case } v\,  \{\text{inl} (a) \Rightarrow w ;\, \text{inr} (b) \Rightarrow u\}} 
  \comp \text{exch}_{}
  %& = [[\![ w ]\!] \comp \text{jn}_{\Delta_{1} ,\typeB,\typeA,  \Delta_{2};\typeD} \comp \text{sp}_{\Delta_{1}, \typeB, \typeA, \Delta_{2};\typeD} \comp  \text{exch}_{\Delta_{1},\underline{\typeA,\typeB},  \Delta_{2},\typeD} \comp  \text{jn}_{\Delta_{1},\typeA,\typeB,  \Delta_{2};\typeD}  ,    [\![u ]\!] \comp \text{jn}_{\Delta_{1} ,\typeB,\typeA,  \Delta_{2};\typeE} & {\text{(coherence)}} \\
  %& \hspace{10pt} \comp \text{sp}_{\Delta_{1}, \typeB, \typeA, \Delta_{2};\typeE} \comp  \text{exch}_{\Delta_{1},\underline{\typeA,\typeB},  \Delta_{2},\typeE} \comp  \text{jn}_{\Delta_{1},\typeA,\typeB,  \Delta_{2};\typeE} ] \comp \dist \comp \sw \comp ([\![  v : \typeD \oplus \typeE  ]\!] \otimes \text{id}) \\
  %& \hspace{10pt} \comp\text{sp}_{E; \Delta_{1},\typeA,\typeB,  \Delta_{2}} \comp \text{sh}_{\Gamma,\typeA, \typeB,\Delta} \\
%  & = [[\![ w ]\!] ,  [\![u ]\!]] \comp  (\text{jn}_{\Delta_{1},\typeA,\typeB,  \Delta_{2};\typeD} \comp \sw \oplus \text{jn}_{\Delta_{1},\typeA,\typeB,  \Delta_{2};\typeE} \comp \sw ) \comp (\text{sp}_{\typeD;\Delta_{1}, \typeB, \typeA, \Delta_{2}} \comp  \text{exch}_{\typeD, \Delta_{1},\underline{\typeA,\typeB},  \Delta_{2}}   & {\text{(coherence and}} \\
%  & \hspace{10pt} \comp \text{jn}_{\typeD;\Delta_{1},\typeA,\typeB,  \Delta_{2}} \oplus \text{sp}_{\typeE;\Delta_{1}, \typeB, \typeA, \Delta_{2}} \comp  \text{exch}_{\typeE, \Delta_{1},\underline{\typeA,\typeB},  \Delta_{2}} \comp \text{jn}_{\typeE;\Delta_{1},\typeA,\typeB,  \Delta_{2}} )   \comp \dist \comp \sw \comp ([\![  v : \typeD \oplus \typeE  ]\!] & {\text{law of coproducts)}}  \\
%  & \hspace{10pt} \otimes \text{id})  \comp\text{sp}_{E; \Delta_{1},\typeA,\typeB,  \Delta_{2}} \comp \text{sh}_{\Gamma,\typeA, \typeB,\Delta} \\ 
\end{align*}
%The commutativity of the following diagram follows from the universal property of the coproduct and the naturality of $\alpha,$ $\lambda,$ $\rho,$ and $\sw$, their inverses, and their composition. Here $\phi$ corresponds to $\text{sp}_{\typeD \oplus \typeE;\Delta_{1}, \typeB, \typeA, \Delta_{2}} \comp  \text{exch}_{\typeD \oplus \typeE, \Delta_{1},\underline{\typeA,\typeB},  \Delta_{2}} \comp \text{jn}_{\typeD \oplus \typeE;\Delta_{1},\typeA,\typeB,  \Delta_{2}}$, $\phi_1$ to $\text{sp}_{\typeD;\Delta_{1}, \typeB, \typeA, \Delta_{2}} \comp  \text{exch}_{\typeD, \Delta_{1},\underline{\typeA,\typeB},  \Delta_{2}} \comp \text{jn}_{\typeE;\Delta_{1},\typeA,\typeB,  \Delta_{2}}$, and $\phi_2$ to $\text{sp}_{\typeE;\Delta_{1}, \typeB, \typeA, \Delta_{2}} \comp  \text{exch}_{\typeE, \Delta_{1},\underline{\typeA,\typeB},  \Delta_{2}} \comp \text{jn}_{\typeE;\Delta_{1},\typeA,\typeB,  \Delta_{2}}$.

%\hspace{-12pt} 
%\begin{tikzpicture} 
%  \matrix (m) [matrix of math nodes,row sep=4em,column sep=6em,minimum width=1em]
%  {
%    ([\![\typeD ]\!]\oplus [\![\typeE]\!]) \otimes \left([\![ \Delta_{1},\typeA,\typeB, \Delta_{2} ]\!]\right)   & ([\![\typeD ]\!]\oplus [\![\typeE]\!]) \otimes  \left([\![ \Delta_{1},\typeB,\typeA, \Delta_{2} ]\!]\right)      \\
%    \left(  [\![\typeD ]\!] \otimes [\![ \Delta_{1},\typeA,\typeB, \Delta_{2} ]\!]  \right) \oplus \left( [\![\typeE ]\!] \otimes [\![ \Delta_{1},\typeA,\typeB, \Delta_{2} ]\!]  \right)  &  \left( [\![\typeD ]\!] \otimes [\![ \Delta_{1},\typeB,\typeA, \Delta_{2} ]\!] \right) \oplus \left([\![\typeE ]\!] \otimes [\![ \Delta_{1},\typeB,\typeA, \Delta_{2} ]\!] \right) \\
%  };
%  \path[-stealth]
%    (m-1-1) edge node [above] {$ \phi$} (m-1-2)
%    (m-2-1)  edge[bend right=-10] node [pos=0.5, shift={(-1.4, 0)}] {$[\inl \otimes \text{id}, \inr \otimes\text{id}]$} (m-1-1)
%    (m-1-1) edge [bend left=10] node [pos=0.5, shift={(0.4,0)}] {$\dist$} (m-2-1)
%    (m-2-1) edge node [above] {$ \phi_1 \oplus \phi_2 $} (m-2-2)
%    (m-1-2) edge [bend left=10] node [pos=0.5, shift={(0.4,0)}] {$\dist$} (m-2-2)
%    (m-2-2)  edge[bend right=-10] node [pos=0.5, shift={(-1.4, 0)}] {$[\inl \otimes \text{id},\inr \otimes \text{id}]$} (m-1-2)
%    ;
%\end{tikzpicture}
%
%The commutativity of the diagram is established as follows:
%\begin{align*}
%  & [\inl \otimes \text{id},\inr \otimes \text{id}] \comp (\phi_1 \oplus \phi_2)\\  
%  & = [\inl \otimes \text{id},\inr \otimes \text{id}] \comp [\inl \comp \phi_1,\inr \comp \phi_2 ] \\
%  & = [(\inl \otimes \text{id}) \comp \phi_1,(\inr \otimes \text{id}) \comp \phi_2 ] & {\text{(law of coproducts)}}  \\
%  & = [\phi \comp (\inl \otimes \text{id}), \phi \comp (\inr \otimes \text{id})] & {\text{(naturality)}} \\
%  & = \phi \comp  [\inl \otimes \text{id},\inr \otimes \text{id}]  & {\text{(law of coproducts)}}
%\end{align*}
 
%As a result it holds that 
%\begin{align*}
%  & [[\![ w ]\!] ,  [\![u ]\!]] \comp  (\text{jn}_{\Delta_{1},\typeA,\typeB,  \Delta_{2};\typeD} \comp \sw \oplus \text{jn}_{\Delta_{1},\typeA,\typeB,  \Delta_{2};\typeE} \comp \sw ) \comp (\text{sp}_{\typeD;\Delta_{1}, \typeB, \typeA, \Delta_{2}} \comp  \text{exch}_{\typeD, \Delta_{1},\underline{\typeA,\typeB},  \Delta_{2}}   \\
%  & \hspace{10pt} \comp \text{jn}_{\typeD;\Delta_{1},\typeA,\typeB,  \Delta_{2}} \oplus \text{sp}_{\typeE;\Delta_{1}, \typeB, \typeA, \Delta_{2}} \comp  \text{exch}_{\typeE, \Delta_{1},\underline{\typeA,\typeB},  \Delta_{2}} \comp \text{jn}_{\typeE;\Delta_{1},\typeA,\typeB,  \Delta_{2}} )   \comp \dist \comp \sw \comp ([\![  v : \typeD \oplus \typeE  ]\!]  \\
%  & \hspace{10pt} \otimes \text{id})  \comp\text{sp}_{E; \Delta_{1},\typeA,\typeB,  \Delta_{2}} \comp \text{sh}_{\Gamma,\typeA, \typeB,\Delta} \\
%  & = [[\![ w ]\!] ,  [\![u ]\!]] \comp  (\text{jn}_{\Delta_{1},\typeA,\typeB,  \Delta_{2};\typeD} \comp \sw \oplus \text{jn}_{\Delta_{1},\typeA,\typeB,  \Delta_{2};\typeE} \comp \sw ) \comp \dist \comp \text{sp}_{\typeD \oplus \typeE;\Delta_{1}, \typeB, \typeA, \Delta_{2}} \comp  \text{exch}_{\typeD \oplus \typeE, \Delta_{1},\underline{\typeA,\typeB},  \Delta_{2}} \\
%  & \hspace{10pt} \comp \text{jn}_{\typeD \oplus \typeE;\Delta_{1},\typeA,\typeB,  \Delta_{2}} \comp ([\![  v ]\!] \otimes \text{id})  \comp\text{sp}_{E; \Delta_{1},\typeA,\typeB,  \Delta_{2}} \comp \text{sh}_{\Gamma,\typeA, \typeB,\Delta}\\
%  & = [[\![ w ]\!] ,  [\![u ]\!]] \comp  (\text{jn}_{\Delta_{1},\typeA,\typeB,  \Delta_{2};\typeD} \comp \sw \oplus \text{jn}_{\Delta_{1},\typeA,\typeB,  \Delta_{2};\typeE} \comp \sw ) \comp \dist  \comp ([\![  v  ]\!] \otimes \text{id}) \comp \text{sp}_{E;\Delta_{1}, \typeB, \typeA, \Delta_{2}} & {\text{(naturality)}} \\
%  & \hspace{10pt}  \comp  \text{exch}_{E, \Delta_{1},\underline{\typeA,\typeB},  \Delta_{2}} \comp  \text{jn}_{E ;\Delta_{1},\typeA,\typeB,  \Delta_{2}}   \comp\text{sp}_{E; \Delta_{1},\typeA,\typeB,  \Delta_{2}} \comp \text{sh}_{\Gamma,\typeA, \typeB,\Delta} \\
%  & = [[\![ w ]\!] ,  [\![u ]\!]] \comp  (\text{jn}_{\Delta_{1},\typeA,\typeB,  \Delta_{2};\typeD} \comp \sw \oplus \text{jn}_{\Delta_{1},\typeA,\typeB,  \Delta_{2};\typeE} \comp \sw ) \comp \dist  \comp ([\![  v  ]\!] \otimes \text{id}) \comp \text{sp}_{E; \Delta_{1}, \typeB,\typeA,  \Delta_{2}} & {\text{(coherence)}} \\
%  & \hspace{10pt} \comp  \text{sh}_{\Gamma; \typeB,\typeA, \Delta} \comp  \text{exch}_{E, \Delta_{1},\underline{\typeA,\typeB},  \Delta_{2}} \\
%  & \triangleq [\![\Gamma,y:\typeB, x:\typeA, \Delta \vljud \text{case } \,  \{\text{inl}_{\typeD} (a) \Rightarrow w ;\, \text{inr}_{\typeE} (b) \Rightarrow u\}: \typeF]\!] \comp \text{exch}_{\Gamma,\underline{\typeA,  \typeB}, \Delta}
%\end{align*}
%

The proof the for the third case follows directly from the coherence theorem
for symmetric monoidal categories.

Regarding the substitution rule, once again the cases involving the injections follow directly by induction on the derivation tree. For the rule (case), we distinguish between the scenarios where the variable $x$ is in $\Gamma$ or in $\Delta$. The first case follows from induction, the bifunctoriality of the tensor product, and the naturality of $\alpha$, $\lambda$, $\rho$, $\sw$, their inverses, and their respective compositions.

% \left[[\![ w ]\!] ,[\![ u ]\!]\right] \comp (\text{jn}_{\Delta;\typeD}\comp \sw \oplus \text{jn}_{\Delta;\typeE } \comp \sw)
\begin{align*}
  &[\![E, Z \vljud \text{case } v \,  \{\text{inl} (a) \Rightarrow w ;\, \text{inr} (b) \Rightarrow u\} [t/x]]\!] \\
  & \triangleq \left[[\![ w ]\!] ,[\![ u ]\!]\right] \comp (\text{jn}\comp \sw \oplus \text{jn} \comp \sw) \comp \dist \comp  ([\![ v [t/x] ]\!]   \otimes \text{id})  \comp \text{sp} \comp \text{sh} \\
  & = \left[[\![ w ]\!] ,[\![ u ]\!]\right] \comp (\text{jn} \comp \sw \oplus \text{jn} \comp \sw)  \comp \dist \comp (([\![ v]\!]  \comp \text{jn} \comp (\text{id} \otimes [\![  t ]\!] ) \comp \text{sp} )\otimes \text{id})  \comp \text{sp} \comp \text{sh} & {\text{(Induction)}} \\
  & =  \left[[\![ w ]\!] ,[\![ u ]\!]\right] \comp (\text{jn} \comp \sw \oplus \text{jn} \comp \sw)  \comp \dist  \comp ([\![ v]\!] \otimes \text{id}) \comp (\text{jn} \comp (\text{id} \otimes [\![  t ]\!] ) \comp \text{sp} \otimes \text{id})  \comp \text{sp}\comp \text{sh}\\
  & = \left[[\![ w ]\!] ,[\![ u ]\!]\right] \comp (\text{jn} \comp \sw \oplus \text{jn} \comp \sw)  \comp \dist  \comp ([\![ v]\!] \otimes \text{id})  \comp (\text{jn} \comp (\text{id} \otimes [\![  t ]\!] ) \comp \text{sp} \otimes \text{id})  \comp \text{sp} \comp \text{sh} \comp \text{jn} \comp \text{sp} & {(\text{Coherence})} \\
  & = \left[[\![ w ]\!] ,[\![ u ]\!]\right] \comp (\text{jn} \comp \sw \oplus \text{jn} \comp \sw)  \comp \dist  \comp ([\![ v]\!] \otimes \text{id}) \comp (\text{jn}\comp \text{sp} \otimes   \id) \comp \text{sp}   \comp \text{sh} \comp \text{jn}\comp (\text{id} \otimes [\![ t ]\!] ) \comp \text{sp}  & {(\text{Naturality})}   \\
  & = \left[[\![ w ]\!] ,[\![ u ]\!]\right] \comp (\text{jn} \comp \sw \oplus \text{jn}\comp \sw)  \comp \dist  \comp ([\![ v]\!] \otimes \text{id}) \comp \text{sp}  \comp \text{sh}  \comp  \text{jn} \comp (\text{id} \otimes [\![ t ]\!] ) \comp \text{sp}  & {(\text{Coherence})}   \\
  & \triangleq \, [\![E,  x \vljud \text{case } v\,  \{\text{inl} (x) \Rightarrow w ;\, \text{inr} (y) \Rightarrow u\}]\!]  \comp  \text{jn} \comp (\text{id} \otimes [\![ t ]\!] ) \comp \text{sp}
\end{align*}


The second case follows from induction, the exchange rule, the universal property of the coproduct,  the bifunctoriality of the tensor product, and the naturality of $\alpha$, $\lambda$, $\rho$, and $\sw$, along with their inverses and respective compositions.

%\left[[\![ w ]\!] ,[\![ u ]\!]\right] \comp (\text{jn}_{\Delta;\typeD}\comp \sw \oplus \text{jn}_{\Delta;\typeE } \comp \sw)  \comp \dist
%\left[[\![ \Delta  , Z ,  a:\typeD \vljud w[t/x] ]\!] \comp \text{jn}_{ \Delta;\typeD},[\![ \Delta, Z, b:\typeE \vljud u[t/x]  ]\!] \comp \text{jn}_{ \Delta;\typeE}\right]
 
%\left[[\![ \Delta  , Z ,  a:\typeD \vljud w[t/x] ]\!] ,[\![ \Delta, Z, b:\typeE \vljud u[t/x]  ]\!] \right] \comp (\text{jn}_{ \Delta;\typeD} \comp \sw \oplus \text{jn}_{ \Delta;\typeE} \comp \sw)

\begin{align*}
  &[\![E, Z \vljud \text{case } v \,  \{\text{inl} (a) \Rightarrow w ;\, \text{inr} (b) \Rightarrow u\} [t/x]]\!] \\
  & \triangleq \left[[\![ \Delta  , Z ,  a:\typeD \vljud w[t/x] ]\!] ,[\![ \Delta, Z, b:\typeE \vljud u[t/x]  ]\!] \right] \comp (\text{jn}\comp \sw \oplus \text{jn} \comp \sw) \comp \dist  \comp ([\![ v ]\!]   \otimes \text{id})    \comp \text{sp} \comp \text{sh} \hspace{10pt} \\
  & =  \left[[\![ \Delta  ,   a:\typeD, Z \vljud w[t/x] ]\!] ,[\![ \Delta, b:\typeE, Z \vljud u[t/x]  ]\!] \right] \comp ( \text{exch}_{\Delta,Z,\typeD} \comp \text{jn}\comp \sw \oplus  \text{exch} \comp \text{jn} \comp \sw)   \comp \dist   & {(\text{Exchange and}} \\
  &  \hspace{10pt} \comp \sw  \comp ([\![v]\!] \otimes \text{id})  \comp \text{sp} \comp \text{sh} & { \text{coproduct laws})}   \\
  & =   \left[[\![w ]\!] ,[\![ u]\!] \right] \comp ( \text{jn} \comp (\text{id} \otimes [\![t]\!] ) \comp \text{sp} \comp  \text{exch} \comp \text{jn} \comp \sw  \oplus  \text{jn} \comp (\text{id} \otimes [\![ t]\!] ) \comp \text{sp}  \comp \text{exch} \comp\text{jn} \comp \sw ) \comp \dist & {\text{(Induction)}}  \\
  & \hspace{10pt}     \comp ([\![v]\!] \otimes \text{id})  \comp \text{sp} \comp \text{sh} \\
  & =  \left[[\![w ]\!] ,[\![ u]\!] \right] \comp (\text{exch} \comp \text{jn} \comp \sw \comp (\text{id} \otimes  \text{jn} ) \comp (\text{id} \otimes [\![t]\!]) \comp  (\text{id} \otimes \text{sp} ) \oplus \text{exch} \comp \text{jn} \comp \sw \comp (\text{id} \otimes  \text{jn} )   & {(\text{Naturality and }} \\
  & \hspace{10pt} \comp (\text{id} \otimes [\![t]\!]) \comp  (\text{id} \otimes \text{sp} ) )\comp \dist \comp ([\![v]\!] \otimes \text{id})  \comp \text{sp} \comp \text{sh} & {\text{coproduct laws})} \\
  & =  \left[[\![w]\!] ,[\![u]\!] \right] \comp (\text{exch} \comp \text{jn} \comp \sw \comp (\text{id} \otimes  (\text{jn} \comp \text{id} \otimes [\![t]\!] \comp \text{sp}) ) \oplus  \text{exch} \comp \text{jn} \comp \sw  &  \\
  & \hspace{10pt}  \comp (\text{id} \otimes  (\text{jn}\comp \text{id} \otimes [\![t]\!] \comp \text{sp}) ))\comp \dist \comp ([\![v]\!] \otimes \text{id}) \comp \text{sp}\comp \text{sh}  \\
  & = [[\![ \Delta  , x:\typeA ,  a:\typeD \vljud w]\!] , [\![ \Delta  , x:\typeA ,  b:\typeE \vljud u]\!]]  \comp (  \text{jn} \comp \sw \comp (\text{id} \otimes  (\text{jn} \comp \id \otimes [\![t]\!]  \comp \text{sp})  \oplus \text{jn} \comp  \sw      & {(\text{Exchange and }}  \\
  & \hspace{10pt} \comp (\text{id} \otimes  (\text{jn} \comp \text{id} \otimes [\![t]\!] \comp \text{sp}) )  ) \comp \dist \comp ([\![v]\!] \otimes \text{id})   \comp \text{sp}\comp \text{sh}  & { \text{coproduct laws})}\\
  &= \left[[\![w ]\!] ,[\![ u]\!] \right] \comp  (\text{jn} \comp \sw \oplus \text{jn} \comp \sw)  \comp \dist \comp ( \text{id} \otimes (\text{jn} \cdot (\text{id} \otimes [\![t]\!]) \cdot \text{sp} ) ) \comp ([\![v]\!] \otimes \text{id}) \comp \text{sp} \comp \text{sh} & {(\text{Coproduct laws}}  \\
  & & {\text{and naturality}}) \\
  & =  \left[[\![w ]\!] ,[\![ u]\!] \right] \comp  (\text{jn} \comp \sw \oplus \text{jn}\comp \sw)  \comp \dist \comp  ([\![v]\!] \otimes \text{id}) \comp \text{sp} \comp ( \text{id} \otimes (\text{jn} \comp  (\text{id} \otimes [\![t]\!]) \cdot \text{sp} ) ) \comp \text{sp}\comp \text{sh}     & {(\text{Coherence})} \\
  &  \hspace{10pt}  \comp \text{jn}  \comp \text{sp} & \\
  & = \left[[\![w ]\!] ,[\![ u]\!] \right] \comp  (\text{jn} \comp \sw \oplus \text{jn} \comp \sw)  \comp \dist \comp  ([\![v]\!] \otimes \text{id})  \comp ( \id \otimes \text{jn} \comp \text{sp}) \comp \text{sp}  \comp \text{sh}    \comp \text{jn} \comp (\text{id} \otimes [\![ t ]\!] ) \comp \text{sp} & {(\text{Naturality})}   \\
  & =  [[\![w]\!], [\![u]\!]] \comp (\text{jn} \comp \sw \oplus \text{jn} \comp \sw)  \comp \dist   \comp ([\![v  ]\!] \otimes \text{id}) \comp \text{sp} \comp \text{sh} \comp \text{jn} \comp (\text{id} \otimes [\![ t ]\!] ) \comp \text{sp}  & {(\text{Coherence})}     \\ 
  & \triangleq  [\![E,  x\vljud \text{case } v\,  \{\text{inl} (a) \Rightarrow w ;\, \text{inr} (b) \Rightarrow u\}]\!] \comp \text{jn} \comp (\text{id} \otimes [\![ t ]\!] ) \comp \text{sp}
\end{align*}
\end{proof}

\begin{theorem} \label {theorem:eq_in_context}
  The equations presented in Figure \ref{fig:equations-in-context-cond} are sound w.r.t. judgement interpretation. More specifically if $ \Gamma \vljud v = w: \typeA$ is one of the equations in Figure \ref{fig:equations-in-context-cond} then $[\![ \Gamma \vljud v: \typeA ]\!] = [\![ \Gamma \vljud w: \typeA ]\!]$.
\end{theorem}

%[\llbracket w\rrbracket,\llbracket u \rrbracket] \comp (\text{jn}_{\Delta;\typeA} \comp \sw \oplus \text{jn}_{\Delta;\typeB} \comp \sw  )

\begin{proof}
  Follows from Lemma \autoref{lem_interpret_exch:sub}, the coherence theorem for symmetric monoidal categories, naturality,  the bifunctoriality of the tensor product, and the universal property of the coproduct.   
  We will provide a complete proof for the first and third equations, noting that the proof for the second equation follows analogously from the first.
  \begin{align*}
    &\llbracket \Delta,\Gamma \vljud  \text{case }  \text{inl}(v)\, \{\text{inl} (x) \Rightarrow w ;\, \text{inr}_{\typeA} (y) \Rightarrow u\} \rrbracket \\
    & \triangleq  [\llbracket w\rrbracket,\llbracket u \rrbracket] \comp (\text{jn} \comp \sw \oplus \text{jn} \comp \sw  ) \comp \dist \comp \sw \comp (\inl \comp \llbracket  v \rrbracket \otimes \text{id}) \comp \text{sp} \comp \text{sh} \\
    & =  [\llbracket w\rrbracket,\llbracket u \rrbracket] \comp (\text{jn} \comp \sw \oplus \text{jn} \comp \sw ) \comp \dist \comp (\inl \otimes \text{id}  ) \comp ( \llbracket  v \rrbracket \otimes \text{id}) \comp \text{sp} \comp \text{sh}  \\
    & =  [\llbracket w\rrbracket,\llbracket u \rrbracket] \comp (\text{jn} \comp \sw \oplus \text{jn} \comp \sw ) \comp \dist \comp [\inl \otimes \id, \inr \otimes \id] \comp \inl  \comp ( \llbracket  v \rrbracket \otimes \text{id}) \comp \text{sp} \comp \text{sh}  &(\text{Coproduct laws})\\
    & =  [\llbracket w\rrbracket,\llbracket u \rrbracket] \comp (\text{jn} \comp \sw \oplus \text{jn} \comp \sw )  \comp \inl  \comp ( \llbracket  v \rrbracket \otimes \text{id}) \comp \text{sp} \comp \text{sh} \\
    & = \llbracket  w \rrbracket\comp \text{jn} \comp   \sw \comp(\llbracket v \rrbracket \otimes  \text{id}) \comp \text{sp} \comp \text{sh} & {\text{(Coproduct laws)}} \\
    &=  \llbracket  w \rrbracket\comp \text{jn} \comp(  \text{id}\otimes \llbracket v \rrbracket ) \comp   \sw \comp \text{sp} \comp \text{sh} & {\text{(Naturality)}} \\
    &= \llbracket w \rrbracket \comp \text{jn} \comp( \text{id} \otimes \llbracket v \rrbracket) \comp \text{sp} & {\text{(Coherence)}}\\
    & = \llbracket w[v/x]  \rrbracket  & {\text{(Lemma \ref{lem_interpret_exch:sub})}}
\end{align*}

%\todo[inline,size=\normalsize]{Elitzur‑Vaidman Bomb Testing Problem -> Improve usando o efeito Zeno? -> Acho que não tem ifs} 

%%[\llbracket  w [ \text{inl}_{\typeB}(y)/x] \rrbracket, \llbracket  w [ \text{inr}_{\typeA}(z)/x] \rrbracket] \comp (\text{jn}_{\Delta;\typeA} \comp \sw \oplus \text{jn}_{\Delta;\typeB} \comp \sw  ) \comp \dist \comp

Regarding the third equation, we have that
\begin{align*}
  & \llbracket \Delta,\Gamma \vljud \text{case } v\, \{\text{inl}_{\typeB} (y) \Rightarrow w [ \text{inl}_{\typeB}(y)/x] ;\, \text{inr}_{\typeA} (z) \Rightarrow w [ \text{inr}_{\typeA}(z)/x]\}: \typeD\rrbracket \\
  & \triangleq  [\llbracket  w [ \text{inl}_{\typeB}(y)/x] \rrbracket, \llbracket  w [ \text{inr}_{\typeA}(z)/x] \rrbracket] \comp (\text{jn}_{\Delta;\typeA} \comp \sw \oplus \text{jn} \comp \sw  ) \comp \dist \comp (\llbracket v\rrbracket \otimes \text{id}) \comp  \text{sp} \comp \text{sh} \\
  & = \llbracket w \rrbracket \comp [\text{jn} \comp (\text{id} \otimes\inl \comp  \llbracket y:\typeA \vljud y:\typeA  \rrbracket) \comp \text{sp} \comp \text{jn} \comp \sw , 
   \text{jn}\comp (\text{id} \otimes\inr  \comp \llbracket z:\typeB \vljud z:\typeB  \rrbracket)   & {\text{(Lemma \ref{lem_interpret_exch:sub} and}} \\
  &  \hspace{10pt}\comp \text{sp} \comp \text{jn} \comp \sw  ] \comp \dist \comp (\llbracket v\rrbracket \otimes \text{id}) \comp  \text{sp} \comp \text{sh} & {\text{coproduct laws)}}  \\
  & =  \llbracket w \rrbracket \comp \text{jn} \comp [ (\text{id} \otimes\inl)  \comp \sw  ,     \comp (\text{id} \otimes\inr) \comp \sw  ] \comp \dist  \comp (\llbracket v \oplus \typeB\rrbracket \otimes \text{id})  \comp  \text{sp} \comp \text{sh}  & {\text{(Coherence and}}   \\
  & \hspace{10pt} & {\text{coproduct laws)}}   \\
  & = \llbracket w \rrbracket \comp \text{jn} \comp   \sw \comp  [\inl \otimes \text{id} , \inr \otimes \text{id}] \comp \dist   \comp (\llbracket v \oplus \typeB\rrbracket \otimes \text{id})  \comp  \text{sp}\comp \text{sh}  & {\text{(Naturality and}}  \\
  & \hspace{10pt} & {\text{coproduct laws})}   \\
  %& = \llbracket w \rrbracket \comp \text{jn}_{\Delta;\typeA \oplus \typeB} \comp \comp \sw \text{id}   \comp (\llbracket v \oplus \typeB\rrbracket \otimes \text{id})  \comp  \text{sp}_{\Gamma;\Delta} \comp \text{sh}_{\Delta;\Gamma}  \\
  & = \llbracket w \rrbracket \comp \text{jn} \comp ( \text{id} \otimes \llbracket v \oplus \typeB\rrbracket )  \comp  \sw  \comp  \text{sp} \comp \text{sh} & {\text{(Naturality)}}\\
  &  = \llbracket w \rrbracket \comp \text{jn} \comp ( \text{id} \otimes \llbracket v \oplus \typeB\rrbracket )  \comp  \text{sp} & {\text{(Coherence)}}\\
  & \triangleq \llbracket w[v/x] : \typeD \rrbracket & {\text{(Lemma \ref{lem_interpret_exch:sub})}}
\end{align*}
\end{proof}

\begin{definition}
  Consider a tuple $(G, \Sigma)$ consisting of a class $G$ of ground types and a class $\Sigma$ of sorted operation symbols. A \emph{linear} $\lambda$-\emph{theory} $((G, \Sigma), \textit{Ax})$ is a triple such that \emph{Ax} is a class of equations-in-context over linear $\lambda$-terms built from $(G, \Sigma)$.
\end{definition}

The elements of \emph{Ax} are called the axioms of the theory. Let \emph{Th(Ax)}  be the smallest congruence that contains \emph{Ax}, the equations-in-context, and that is closed under exchange
and substitution. We call the elements of  \emph{Th(Ax)} the \emph{theorems} of the theory.

\begin{definition}
  Consider a linear $\lambda$-theory $((\lambda, \Sigma), \emph{Ax})$ and
  also a symmetric monoidal cloded category with coproducts $\catC$. Suppose that for each $X \in G$ we have an interpretation $\llbracket X \rrbracket$
  that is a $\catC$-object and analogously for the operation symbols. This interpretation structure
  is a \emph{model} of the theory if all axioms are satisfied by the interpretation.
\end{definition}

\begin{theorem} \label {theorem:comp_eq_in_context}
  The equations presented in Figure \ref{fig:equations-in-context-cond} are complete w.r.t. judgment interpretation. More specifically, by combining these equations with the remaining equations from the linear lambda calculus, it becomes possible to derive the properties that must necessarily hold in every model.
\end{theorem}


\begin{proof}
  Completeness is based on the idea of a \textit{Lindenbaum-Tarski algebra} and arises from constructing the syntactic category Syn($\mathscr{T}$) of a $\lambda$-theory $\mathscr{T}$ (also known as term model). By employing the equations in Figure \ref{fig:equations-in-context-cond}, we show that both the universal property of the coproduct and the distributive property are satisfied in Syn($\mathscr{T}$). The syntactic category of $\mathscr{T}$ has as objects the types of $\mathscr{T}$ and as morphisms $A \rightarrow B$ the equivalence classes (w.r.t. provability) of terms $v$ for which we can derive $x : \typeA \vljud v : \typeB$.

  In the syntactic category, the coproduct $[ p ,  q]$ can be seen as the equivalence
  class 
  $$\left[z:\typeA \oplus\typeB \vljud \text{case } z\,\{\inl_{\typeB}(x) \Rightarrow p ; \, \inr_{\typeA}(y) \Rightarrow q\}: \typeD\right],$$ 
  the distributive property, $\dist$, corresponds to the class 
  \begin{align*}
    \big[z:(\typeA \otimes \mathbb{\typeB}) \otimes \mathbb{\typeD} \vljud \text{pm } z \text{ to } a \otimes b. \text{ case } a\,\{ &\inl_{\typeB}(x) \Rightarrow \inl_{\typeB \otimes \typeD}(x \otimes b); \\
    & \inr_{\typeA}(y) \Rightarrow \inr_{\typeA \otimes \typeD} (y \otimes b)\}: (\typeA \otimes \typeD) \oplus (\typeB \otimes \typeD)\big],
  \end{align*}
and its inverse, $[\inl \otimes \id, \inr \otimes \id]$, to the class
\begin{align*}
  \big[z: (\typeA \otimes \typeD) \oplus (\typeB \otimes \typeD) \vljud  \text{ case } z \,\{ &\inl_{\typeB}(x) \Rightarrow \text{pm } x \text{ to } a \otimes b. \, \inl_{\typeB}(a) \otimes b; \\
  & \inr_{\typeA}(y) \Rightarrow \text{pm } y \text{ to } a' \otimes b'. \, \inr_{\typeA}(a') \otimes b'\}: (\typeA \otimes \mathbb{\typeB}) \otimes \mathbb{\typeD}\big].
\end{align*}


The proof of the coproduct diagram comutes follow directly from the $\beta$-equations in Figure \ref{fig:equations-in-context-cond}, $\alpha$-equivalence, and Lemma \ref{lem:exh_and_sub}. Specifically, for the left triangle in the coproduct diagram, we have that:
  \begin{align*}
    & \left[z:\typeA \oplus \typeB  \vljud \text{case } v\,\{\inl_{\typeB}(x) \Rightarrow p ; \, \inr_{\typeA}(y) \Rightarrow q\}: \typeD\right] \comp \left[ x: \typeA\vljud \inl_{\typeB}(x): \typeA \oplus \typeB \right]  \\
    =& \left(z:\typeA \oplus \typeB  \vljud \text{case } v\,\{\inl_{\typeB}(x) \Rightarrow p ; \, \inr_{\typeA}(y) \Rightarrow q\}: \typeD\right) \comp \left( x: \typeA\vljud \inl_{\typeB}(x): \typeA \oplus \typeB \right) 
   \\
    =& z:\typeA \oplus \typeB  \vljud \text{case } v\,\{\inl_{\typeB}(x') \Rightarrow p[x'/ x] ; \, \inr_{\typeA}(y) \Rightarrow q\}: \typeD \comp  x: \typeA\vljud \inl_{\typeB}(x): \typeA \oplus \typeB & (\alpha)\\
    = & x:\typeA \vljud \text{case } \inl(x) \,\{\inl_{\typeB}(x') \Rightarrow p[x'/ x] ; \, \inr_{\typeA}(y) \Rightarrow q\}: \typeD & (\text{Lemma } \ref{lem:exh_and_sub})  \\
    = &  x:\typeA \vljud p[x'/x][x/x']: \typeD & (\beta_{\text{case}}^{\text{inl}}) \\
    = & x:\typeA \vljud p: \typeD \\
    = &  \left[x:\typeA \vljud p: \typeD\right]  \\
  \end{align*}
  The proof for the right triangle in the coproduct diagram is analogous.
 
  Regarding the unicity of the coproduct, the key aspect of the proof lies in proving that the following equality holds: 
  $$\left[z:\typeA \oplus \typeB  \vljud \text{case } z \,\{\inl_{\typeB}(x) \Rightarrow m[\inl_{\typeB}(x)/ z] ; \, \inr_{\typeA}(y) \Rightarrow m[\inr_{\typeA}(x)/ z]\}: \typeD\right] = [z:\typeA \oplus \typeB \vljud m: \typeD].$$ 
  This equality follows direct from the $\eta$-equation in Figure \ref{fig:equations-in-context-cond}. Now, considering any morphism $m'$ from $\typeA \oplus \typeB$ to $\typeD$ and the coproduct diagram, we have that 
  %$$\left[z:\typeA \oplus \typeB  \vljud m': \typeD\right] \comp \left[ x: \typeA\vljud \inl_{\typeB}(x): \typeA \oplus \typeB \right] = \left[x: \typeA  \vljud p: \typeD\right]  $$ 
  $$\left[ x: \typeA \vljud m'[ \inl_{\typeB}(x)/z]: \typeD\right]  = \left[x: \typeA  \vljud p: \typeD\right]  $$ 
  and
  $$\left[ y: \typeB  \vljud m'[\inr_{\typeA}(y)/z]: \typeD\right] = \left[y: \typeB  \vljud q: \typeD\right].$$
  As a result, if follows from the equalities above that 
  \begin{align*}
    \left[z:\typeA \oplus \typeB  \vljud m': \typeD\right]& =\left[z:\typeA \oplus \typeB  \vljud \text{case } z \,\{\inl_{\typeB}(x) \Rightarrow m'[\inl_{\typeB}(x)/ z] ; \, \inr_{\typeA}(y) \Rightarrow m'[\inr_{\typeA}(x)/ z]\}: \typeD\right]\\
    & = \left[z:\typeA \oplus \typeB  \vljud \text{case } z \,\{\inl_{\typeB}(x) \Rightarrow p ; \, \inr_{\typeA}(y) \Rightarrow q\}: \typeD\right]. 
  \end{align*}
 
 
  To prove that the distributive property is an isomorphism syntactically, we first establish that the following equality, known  as the \emph{syntactic fusion law}, holds:
  \begin{equation*}
    \left[v\left[ \left(\text{case } a \,\{\inl_{\typeB}(x) \Rightarrow w ; \, \inr_{\typeA}(y) \Rightarrow u\}\right)  / z \right]\right] =   \left[\text{case } a \,\{\inl_{\typeB}(x) \Rightarrow v[w/z] ; \, \inr_{\typeA}(y) \Rightarrow v[u/z]\} \right].
  \end{equation*}
It should be noted that this equality corresponds semantically to the property  $ \llbracket v \rrbracket \comp [ \llbracket w \rrbracket,  \llbracket u \rrbracket] = [ \llbracket v \rrbracket \comp \llbracket w \rrbracket,\llbracket v \rrbracket \comp \llbracket u \rrbracket ] $.
This equality follows from the $\alpha$-equivalence and the equations in Figure \ref{fig:equations-in-context-cond}. 

\begin{align*}
  &\left[v\left[ \left(\text{case } a \,\{\inl_{\typeB}(x) \Rightarrow w ; \, \inr_{\typeA}(y) \Rightarrow u\}\right)  / z \right]\right] & \\
  &  = v \left[ \left(\text{case } a \,\{\inl_{\typeB}(x) \Rightarrow w ; \, \inr_{\typeA}(y) \Rightarrow u\}\right)  / z \right] & \\
  & =v  \left[ \left(\text{case } a \,\{\inl_{\typeB}(x') \Rightarrow w[x'/x] ; \, \inr_{\typeA}(y') \Rightarrow u[y'/y]\}\right)  / z \right] & (\alpha) \\
  & = \big[ \text{case } a \,\{\inl_{\typeB}(x) \Rightarrow v[\text{case } \inl_{\typeB}(x) \,\{\inl_{\typeB}(x') \Rightarrow w[x'/x] ; \, \inr_{\typeA}(y) \Rightarrow u[y'/y]\}/z] ; \, & (\eta_{\text{case}}) \ \\
   & \hspace{50pt} \inr_{\typeA}(y) \Rightarrow  v[\text{case } \inr_{\typeA}(y) \,\{\inl_{\typeB}(x') \Rightarrow w[x'/x] ; \, \inr_{\typeA}(y) \Rightarrow u[y'/y]\}/z]\}\big]  \\
   & = \text{case } a \,\{\inl_{\typeB}(x) \Rightarrow v[w[x'/x][x/x']/z] ; \, \inr_{\typeA}(y) \Rightarrow v[u[y'/y][y/y']/z]\}   & (\beta_{\text{case}}^{\text{inl}} \text{ and } \beta_{\text{case}}^{\text{inr}}  ) \\
   & =  \text{case } a \,\{\inl_{\typeB}(x) \Rightarrow v[w/z] ; \, \inr_{\typeA}(y) \Rightarrow v[u/z]\}  \\
   & = \left[ \text{case } a \,\{\inl_{\typeB}(x) \Rightarrow v[w/z] ; \, \inr_{\typeA}(y) \Rightarrow v[u/z]\}\right] 
\end{align*}

The proof that the distributive property is an isomorphism follows from the syntactic fusion law, the equations in Figure \ref{fig:equations-in-context-cond}, the equations $\beta_{\otimes_{e}}$ and $\eta_{\otimes_{e}}$, the $\alpha$-equivalence, and Lemma \ref{lem:exh_and_sub}. 

\begin{align*}
  &\left[ \text{pm } z \text{ to } a \otimes b. \text{ case } a\, \left\{ \begin{aligned}
    &\inl_{\typeB}(x) \Rightarrow \inl_{\typeB \otimes \typeD}(x \otimes b);\\
    &\inr_{\typeA}(y) \Rightarrow \inr_{\typeA \otimes \typeD} (y \otimes b)
\end{aligned} \right\} \right] \\
 \cdot &   \left[ \text{case } z' \,  \left\{\begin{aligned} 
  &\inl_{\typeB}(x') \Rightarrow \text{pm } x' \text{ to } a' \otimes b'. \, \inl_{\typeB}(a') \otimes b';\\
  &\inr_{\typeA}(y') \Rightarrow \text{pm } y' \text{ to } a'' \otimes b''. \, \inr_{\typeA}(a'') \otimes b'' 
\end{aligned}  \right\}\right] \\
& =  \text{pm } z \text{ to } a \otimes b. \text{ case } a\, \left\{ \begin{aligned}
  &\inl_{\typeB}(x) \Rightarrow \inl_{\typeB \otimes \typeD}(x \otimes b);\\
  &\inr_{\typeA}(y) \Rightarrow \inr_{\typeA \otimes \typeD} (y \otimes b)
\end{aligned} \right\}  \\
& \hspace{10pt} \cdot    \text{case } z' \,  \left\{\begin{aligned} 
&\inl_{\typeB}(x') \Rightarrow \text{pm } x' \text{ to } a' \otimes b'. \, \inl_{\typeB}(a') \otimes b';\\
&\inr_{\typeA}(y') \Rightarrow \text{pm } y' \text{ to } a'' \otimes b''. \, \inr_{\typeA}(a'') \otimes b'' 
\end{aligned}  \right\} \\
& =   \text{case } z' \,  
\left\{
  \begin{aligned} 
  &\inl_{\typeB}(x') \Rightarrow \text{pm }  (\text{pm } x' \text{ to } a' \otimes b'. \, \inl_{\typeB}(a') \otimes b')  \text{ to } a \otimes b . \\  
  & \hspace{10pt}\text{ case } a\, \Bigg\{ 
    \begin{aligned}
    & \inl_{\typeB}(x) \Rightarrow \inl_{\typeB \otimes \typeD}(x \otimes b);\\
    & \inr_{\typeA}(y) \Rightarrow \inr_{\typeA \otimes \typeD} (y \otimes b)
    \end{aligned} \Bigg\} \\
  &\inr_{\typeA}(y') \Rightarrow \text{pm }  (\text{pm } y' \text{ to } a'' \otimes b''. \, \inl_{\typeB}(a'') \otimes b'')  \text{ to } a \otimes b . \\ 
  & \hspace{10pt}\text{ case } a\, \Bigg\{ 
    \begin{aligned}
    & \inl_{\typeB}(x) \Rightarrow \inl_{\typeB \otimes \typeD}(x \otimes b);\\
    & \inr_{\typeA}(y) \Rightarrow \inr_{\typeA \otimes \typeD} (y \otimes b)
    \end{aligned} \Bigg\} \\ 
\end{aligned}  
\right\} & (\text{fusion law}) \\
& =  \text{case } z' \,  
\left\{
  \begin{aligned} 
  &\inl_{\typeB}(x') \Rightarrow \text{pm }  \inl_{\typeB}(a') \otimes b' [x'/a' \otimes b']  \text{ to } a \otimes b . \\  
  & \hspace{10pt}\text{ case } a\, \Bigg\{ 
    \begin{aligned}
    & \inl_{\typeB}(x) \Rightarrow \inl_{\typeB \otimes \typeD}(x \otimes b);\\
    & \inr_{\typeA}(y) \Rightarrow \inr_{\typeA \otimes \typeD} (y \otimes b)
    \end{aligned} \Bigg\} \\
  &\inr_{\typeA}(y') \Rightarrow \text{pm }  \inl_{\typeB}(a'') \otimes b'' [y'/ a'' \otimes y'']  \text{ to } a \otimes b . \\ 
  & \hspace{10pt}\text{ case } a\, \Bigg\{ 
    \begin{aligned}
    & \inl_{\typeB}(x) \Rightarrow \inl_{\typeB \otimes \typeD}(x \otimes b);\\
    & \inr_{\typeA}(y) \Rightarrow \inr_{\typeA \otimes \typeD} (y \otimes b)
    \end{aligned} \Bigg\}  \\ 
\end{aligned}  
\right\}  & (\eta_{\otimes_{e}}) \\
& =   \text{case } z' \,  
\left\{
  \begin{aligned} 
  &\inl_{\typeB}(x') \Rightarrow \text{ case } \inl_{\typeB}(a')\, \Bigg\{ 
    \begin{aligned}
    & \inl_{\typeB}(x) \Rightarrow \inl_{\typeB \otimes \typeD}(x \otimes b');\\
    & \inr_{\typeA}(y) \Rightarrow \inr_{\typeA \otimes \typeD} (y \otimes b')
    \end{aligned} \Bigg\} [x'/a' \otimes b'] \\
  &\inr_{\typeA}(y') \Rightarrow \text{ case } \inl_{\typeA}(a'')\, \Bigg\{ 
    \begin{aligned}
    & \inl_{\typeB}(x) \Rightarrow \inl_{\typeB \otimes \typeD}(x \otimes b');\\
    & \inr_{\typeA}(y) \Rightarrow \inr_{\typeA \otimes \typeD} (y \otimes b')
    \end{aligned} \Bigg\} [y'/a'' \otimes b'']  \\ 
\end{aligned}  
\right\}  &  (\beta_{\otimes_{e}}) \\
& =  \text{case } z' \,  
\left\{
  \begin{aligned} 
  &\inl_{\typeB}(x') \Rightarrow \inl_{\typeB \otimes \typeD}(x \otimes b') [x'/a' \otimes b'] [a'/x]; \\
  &\inr_{\typeA}(y') \Rightarrow  \inl_{\typeB \otimes \typeD}(x \otimes b') [y'/a'' \otimes b''] [a''/y']  
  \end{aligned}  
\right\}  &  (\beta_{\text{case}}^{\text{inl}} \text{ and } \beta_{\text{case}}^{\text{inr}}  )  \\
& =  \text{case } z' \,
\left\{
  \begin{aligned} 
  &\inl_{\typeB}(x') \Rightarrow \inl_{\typeB \otimes \typeD}(x'); \\
  &\inr_{\typeA}(y') \Rightarrow  \inl_{\typeB \otimes \typeD}(y') 
  \end{aligned}
\right\}  & \\
& =  \text{case } z' \,
\left\{
  \begin{aligned} 
  &\inl_{\typeB}(x') \Rightarrow c[\inl_{\typeB \otimes \typeD}(x')/c]; \\
  &\inr_{\typeA}(y') \Rightarrow  c[\inl_{\typeB \otimes \typeD}(y')/c] 
  \end{aligned}
\right\}  & (\alpha) \\
& =  z' = [z'] & (\eta_{\text{case}}) 
\end{align*}

\begin{align*}
&   \left[ \text{case } z' \,  \left\{
  \begin{aligned} 
  &\inl_{\typeB}(x') \Rightarrow \text{pm } x' \text{ to } a' \otimes b'. \, \inl_{\typeB}(a') \otimes b';\\
  &\inr_{\typeA}(y') \Rightarrow \text{pm } y' \text{ to } a'' \otimes b''. \, \inr_{\typeA}(a'') \otimes b'' 
  \end{aligned}  \right\}\right] \\
\comp & \left[ \text{pm } z \text{ to } a \otimes b. \text{ case } a\, \left\{ 
  \begin{aligned}
    &\inl_{\typeB}(x) \Rightarrow \inl_{\typeB \otimes \typeD}(x \otimes b);\\
    &\inr_{\typeA}(y) \Rightarrow \inr_{\typeA \otimes \typeD} (y \otimes b)
  \end{aligned} \right\} \right] \\
& =  \text{case } z' \,  \left\{
  \begin{aligned} 
  &\inl_{\typeB}(x') \Rightarrow \text{pm } x' \text{ to } a' \otimes b'. \, \inl_{\typeB}(a') \otimes b';\\
  &\inr_{\typeA}(y') \Rightarrow \text{pm } y' \text{ to } a'' \otimes b''. \, \inr_{\typeA}(a'') \otimes b'' 
  \end{aligned}  \right\} \\
& \hspace{10pt}\comp   \text{pm } z \text{ to } a \otimes b. \text{ case } a\, \left\{ 
  \begin{aligned}
    &\inl_{\typeB}(x) \Rightarrow \inl_{\typeB \otimes \typeD}(x \otimes b);\\
    &\inr_{\typeA}(y) \Rightarrow \inr_{\typeA \otimes \typeD} (y \otimes b)
  \end{aligned} \right\} \\
& =  \text{case } 
  \left( \text{pm } z \text{ to } a \otimes b. \text{ case } a\, \left\{ 
  \begin{aligned}
    &\inl_{\typeB}(x) \Rightarrow \inl_{\typeB \otimes \typeD}(x \otimes b);\\
    &\inr_{\typeA}(y) \Rightarrow \inr_{\typeA \otimes \typeD} (y \otimes b)
  \end{aligned} \right\} \right) \\
   & \hspace{40pt} \left\{
  \begin{aligned} 
  &\inl_{\typeB}(x') \Rightarrow \text{pm } x' \text{ to } a' \otimes b'. \, \inl_{\typeB}(a') \otimes b';\\
  &\inr_{\typeA}(y') \Rightarrow \text{pm } y' \text{ to } a'' \otimes b''. \, \inr_{\typeA}(a'') \otimes b'' 
  \end{aligned}  \right\} & (\text{Lemma } \ref{lem:exh_and_sub})
\\
  & =    \text{case } 
    \left( \text{case } a\, \left\{ 
    \begin{aligned}
      &\inl_{\typeB}(x) \Rightarrow \inl_{\typeB \otimes \typeD}(x \otimes b);\\
      &\inr_{\typeA}(y) \Rightarrow \inr_{\typeA \otimes \typeD} (y \otimes b)
    \end{aligned} \right\} [z/ a \otimes b] \right) \\
    & \hspace{40pt}  \left\{
    \begin{aligned} 
    &\inl_{\typeB}(x') \Rightarrow  \inl_{\typeB}(a') \otimes b' \, [x'/a' \otimes b'];\\
    &\inr_{\typeA}(y') \Rightarrow  \inr_{\typeA}(a'') \otimes b''\, [y'/a'' \otimes b'']
    \end{aligned}  \right\} &  (\eta_{\otimes_{e}}) \\
  & =   \text{case } a\, \left\{ 
    \begin{aligned}
      &\inl_{\typeB}(x) \Rightarrow \text{case } \left(\inl_{\typeB \otimes \typeD}(x \otimes b)\right) \Bigg\{ 
        \begin{aligned} 
        &\inl_{\typeB}(x') \Rightarrow  \inl_{\typeB}(a') \otimes b';\\
        &\inr_{\typeA}(y') \Rightarrow  \inr_{\typeA}(a'') \otimes b'' 
        \end{aligned} \Bigg\} \\  & [z/ a \otimes b] [x'/a'\otimes b'];\\
      &\inr_{\typeA}(y) \Rightarrow \text{case } \left(\inr_{\typeA \otimes \typeD} (y \otimes b)\right) \Bigg\{ 
        \begin{aligned} 
        &\inl_{\typeB}(x') \Rightarrow \inl_{\typeB}(a') \otimes b';\\
        &\inr_{\typeA}(y') \Rightarrow  \inr_{\typeA}(a'') \otimes b'' 
        \end{aligned} \Bigg\} \\&[z/ a \otimes b] [y'/a''\otimes b'']
    \end{aligned}  \right\}  & (\text{fusion law})\\
  & = \text{ case } a\, \left\{ 
    \begin{aligned}
      &\inl_{\typeB}(x) \Rightarrow  \inl_{\typeB}(a') \otimes b' [z/ a \otimes b] [x'/a'\otimes b'] [x \otimes b/ x'];\\
      &\inr_{\typeA}(y) \Rightarrow  \inr_{\typeA}(a'') \otimes b'' [z/ a \otimes b] [y'/a''\otimes b''] [x \otimes b/ y']
    \end{aligned} \right\}  & (\beta_{\text{case}}^{\text{inl}} \text{ and } \beta_{\text{case}}^{\text{inr}}) \\
  & = \text{ case } a\, \left\{ 
    \begin{aligned}
        &\inl_{\typeB}(x) \Rightarrow  \inl_{\typeB}(a') \otimes b' [z/ a \otimes b] [x \otimes b/a'\otimes b'];\\
        &\inr_{\typeA}(y) \Rightarrow  \inr_{\typeA}(a'') \otimes b'' [z/ a \otimes b] [x \otimes b/a''\otimes b''] 
    \end{aligned} \right\}  &  \\
  & = \text{ case } a\, \left\{
    \begin{aligned}
      &\inl_{\typeB}(x) \Rightarrow  \inl_{\typeB}(x) \otimes b;\\
      &\inr_{\typeA}(y) \Rightarrow  \inr_{\typeA}(x) \otimes b
    \end{aligned} \right\}  [z/ a \otimes b]  & (\beta_{\otimes_{e}}) \\
  & = a \otimes b [z/ a \otimes b] = z = [z] & (\eta_{\text{case}})
\end{align*} 

\end{proof}

%$ &\cdot   \big[z: (\typeA \otimes \typeD) \oplus (\typeB \otimes \typeD) \vljud  \text{ case } z \,\{ \inl_{\typeB}(x) \Rightarrow \text{pm } x \text{ to } a \otimes b. \, \inl_{\typeB}(a) \otimes b; \\
  %& \inr_{\typeA}(y) \Rightarrow \text{pm } y \text{ to } a' \otimes b'. \, \inr_{\typeA}(a') \otimes b'\}: (\typeA \otimes \mathbb{\typeB}) \otimes \mathbb{\typeD}\big]$

\section{Metric equations}

A metric-equation-in-context is an expression $\Gamma \vljud v =_q w : \typeA$ with $q \in \mathbb{R}^+_0$, $\Gamma \vljud v : \typeA$
and $\Gamma \vljud w : \typeA$.  An equation-in-context $\Gamma \vljud v = w : \typeA$ now denotes the particular case in which both $\Gamma \vljud v =_0 w : \typeA$ and $\Gamma \vljud w =_0 v : \typeA$.

The metric equation for conditionals is presented in \autoref{fig:metric conditionals}. 

\begin{figure}[H]
  \begin{equation*}
  \begin{aligned}
  &
  &
  %
  \begin{prooftree}
      \hypo{ v =_{q} v' }
      \hypo{w=_{r} w'}
      \hypo{u=_{s}u'}
      \infer3[]{\text{ case } v \,   \{\text{inl} (x) \Rightarrow w ; \, \text{inr} (y) \Rightarrow u\} =_{q+\sup{\{ r, s \}}} \text{ case } v' \,  \{\text{inl} (x) \Rightarrow w' ; \,\text{inr} (y) \Rightarrow u'\} }
  \end{prooftree}
  %
  \\[10pt]
  \end{aligned}
  \end{equation*}
  \caption{Metric equation for condicionals}
  \label{fig:metric conditionals}
\end{figure}



  \begin{definition}
    A metric space a pair $(X, d)$ where $X$ is a set and $d: X \times X \to \mathbb{R}_0^+$ is a function satisfying:
    \begin{enumerate}
        \item $0 \leq d(x, y)$, with equality if and only if $x = y$,
        \item $d(x, y) = d(y, x)$,
        \item $d(x, z) \leq d(x, y) + d(y, z)$ for all $x, y, z \in X$.
    \end{enumerate}
    
    For two metric spaces $(X, d_X)$ and $(Y, d_Y)$, a morphism $f: (X, d_X) \to (Y, d_Y)$ is a function $f: X \to Y$ satisfying $d_Y(f(x), f(y)) \leq d_X(x, y)$ for all $x, y \in X$.
    \end{definition}


\begin{definition}
 A category $\catC$ is $\catMet$-enriched if for each pair of objects $X$ and $Y$ in $\catC$, the hom-set $\catC(X, Y)$ is a metric space and  if the composition of $\catC$-morphisms,
 $$(\comp): \catC(X, Y) \otimes \catC(Y, Z) \rightarrow \catC(X, Z)$$
 is a functor in the category of metric spaces.
\end{definition}

\todo[inline]{Which designation is more fitting functor in the category of metric spaces or non-expansive function?}

Note that if $\catC$ is a  $\catMet$-enriched category, then $\catC \otimes \catC$ is also a  $\catMet$-enriched category.


\begin{definition}
  A given category $\catC$ with coproducts is said to be $\catMet$-enriched if in addition to the properties of a  $\catMet$-enriched category, the following holds: for $f  \in \catC(X,Z)  $ and $g  \in \catC(Y,Z) $, $ [f,g]:\catC(X,Z)  \otimes \catC(Y,Z) \rightarrow \catC(X \oplus Y,Z) $ is a functor in the category of metric spaces.
 \end{definition}


  %Let $\catC$ be a category with coproducts $\catMet$-enriched, it holds that for $f, f'  \in \catC(X,Z)  $ and $g,g'  \in \catC(Y,Z) $, $d_{\catC(X,Z) \otimes \catC(Y,Z)}((f,f'),(g,g')) = \sup(d(f,f'),d(g,g'))$.



\todo[inline]{Present the interpretation of the equational system via monoidal closed categories with coproducts and $\catMet$-enriched -> ???}



Consider a symmetric monoidal closed category with coproducts $\catMet$-enriched $\catC$. A metric equation $\Gamma \vljud v =_{q} w : \typeA $ is satisfied by this interpretation if $q \leq d( \llbracket \Gamma  \vljud v : \typeA \rrbracket, \llbracket\Gamma \vljud w : \typeA \rrbracket)$ where $d : \catC(\llbracket \Gamma \rrbracket, \llbracket \typeA \rrbracket) \times \catC(\llbracket \Gamma \rrbracket, \llbracket \typeA \rrbracket) \rightarrow \mathbb{R}_0^+$ is the underlying function of the category  $\catMet$-enriched $\catC(\llbracket \Gamma \rrbracket, \llbracket \typeA \rrbracket)$.

\begin{theorem}
  The rules in Figures \ref{fig:equations-in-context-cond} and \ref{fig:metric conditionals} are sound for a symmetric monoidal closed category with coproducts $\catMet$-enriched $\catC$ over metric spaces. Specifically, if $\Gamma \vljud v =_{q} w : \typeA $ results from the rules in Figures \ref{fig:equations-in-context-cond} and \ref{fig:metric conditionals} then $q \geq d( \llbracket \Gamma  \vljud v : \typeA \rrbracket, \llbracket\Gamma \vljud w : \typeA \rrbracket)$.
\end{theorem}

\begin{proof}
  Regarding the rules in Figure \ref{fig:equations-in-context-cond}, attending to the fact that an equation $\Gamma \vljud v=w: \typeA$ abbreviates the metric equation $\Gamma \vljud v =_0 w: \typeA$, and given that the rules in Figure \ref{fig:equations-in-context-cond} are sound for symmetric monoidal closed categories with coproducts, we have that $0 \leq d( \llbracket \Gamma  \vljud v : \typeA \rrbracket, \llbracket\Gamma \vljud w : \typeA \rrbracket)$.  

 Concerning the rule in Figure \ref{fig:equations-in-context-cond}, it follows from the fact that $\catC$ is $\catMet$-enriched and has coproducts.

  \begin{align*}
    & d( \llbracket E  \vljud \text{ case } v \, \{\text{inl}_{\typeB}  (x) \Rightarrow w ; \, \text{inr}_{\typeA} (y) \Rightarrow u\} : \typeD \rrbracket, \llbracket E \vljud \text{ case } v' \, \{\text{inl}_{\typeB}  (x) \Rightarrow w' ; \, \text{inr}_{\typeA} (y) \Rightarrow u'\} : \typeD \rrbracket)  \\
    & = d( [\llbracket w\rrbracket ,\llbracket u\rrbracket] \comp (\text{jn}_{\Delta;\typeA}\comp \sw \oplus \text{jn}_{\Delta;\typeB}\comp \sw) \comp \dist \comp (\llbracket v\rrbracket \otimes \text{id}) \comp \text{sp}_{\Gamma;\Delta} \comp \text{sh}_{E}, \\
    & \hspace{10pt} [\llbracket w'\rrbracket ,\llbracket u'\rrbracket] \comp (\text{jn}_{\Delta;\typeA}\comp \sw \oplus \text{jn}_{\Delta;\typeB}\comp \sw) \comp \dist \comp (\llbracket v'\rrbracket \otimes \text{id}) \comp \text{sp}_{\Gamma;\Delta} \comp \text{sh}_{E})\\
    & \leq d( [\llbracket w\rrbracket ,\llbracket u\rrbracket] \comp (\text{jn}_{\Delta;\typeA}\comp \sw \oplus \text{jn}_{\Delta;\typeB}\comp \sw) \comp \dist \comp (\llbracket v\rrbracket \otimes \text{id}),  [\llbracket w'\rrbracket ,\llbracket u'\rrbracket] \comp (\text{jn}_{\Delta;\typeA}\comp \sw \oplus \text{jn}_{\Delta;\typeB}\comp \sw) \comp \dist \comp (\llbracket v'\rrbracket \otimes \text{id}) )\\
    & \leq d(\llbracket v\rrbracket \otimes \text{id}, \llbracket v'\rrbracket \otimes \text{id}) +  d( [\llbracket w\rrbracket ,\llbracket u\rrbracket] \comp (\text{jn}_{\Delta;\typeA}\comp \sw \oplus \text{jn}_{\Delta;\typeB}\comp \sw) \comp \dist,  [\llbracket w'\rrbracket ,\llbracket u'\rrbracket] \comp (\text{jn}_{\Delta;\typeA}\comp \sw \oplus \text{jn}_{\Delta;\typeB}\comp \sw) \comp \dist) \\
    & \leq q +  d( [\llbracket w\rrbracket ,\llbracket u\rrbracket] \comp (\text{jn}_{\Delta;\typeA}\comp \sw \oplus \text{jn}_{\Delta;\typeB}\comp \sw) \comp \dist,  [\llbracket w'\rrbracket ,\llbracket u'\rrbracket] \comp (\text{jn}_{\Delta;\typeA}\comp \sw \oplus \text{jn}_{\Delta;\typeB}\comp \sw) \comp \dist) \\
    & \leq q +  d( [\llbracket w\rrbracket ,\llbracket u\rrbracket],  [\llbracket w'\rrbracket ,\llbracket u'\rrbracket]) \\
    & \leq q + \sup(d( \llbracket w\rrbracket , \llbracket w' \rrbracket), d( \llbracket u\rrbracket , \llbracket u' \rrbracket)) \\
    & \leq q + \sup(r, s) \\
  \end{align*}
  
  The second step follows from the fact that $\text{sp}_{\Gamma;\Delta} \comp \text{sh}_{E}$  is a morphism in $\catC$  and that $\catC$ is $\catMet$-enriched.  The third and fifth step follow from an analogous reasoning. The fourth step follows from  the premises of the rule in question and from the metric equation ($\otimes_e$). The sixth step follows from the fact that $\catC$ is has coproducts and is $\catMet$-enriched. Finally, the last step follows from the premise of the rule in question.

\end{proof}

\begin{definition}
Consider a tuple $(G,\Sigma)$ consisting of a class $G$ of ground
 types and a class of sorted operation symbols $f : \typeA_1,...,\typeA_n \rightarrow \typeA$ with $n \geq 1$. A \emph{linear metric $\lambda$-theory} $((G,\Sigma),\textit{Ax})$ is a tuple such that \textit{Ax} is a class of metric equations-in-context over linear $\lambda$-terms built from $(G,\Sigma)$.
\end{definition}

\begin{definition}
  Consider a linear metric $\lambda$-theory $((G,\Sigma),\textit{Ax})$ and a symmetric monoidal closed category with coproducts $\catMet$-enriched $\catC$.  Suppose that for each $X \in G$ we have an interpretation $\llbracket X \rrbracket$ as a $\catC$-object and analogously for the operation symbols. This interpretation structure is a model of the theory if all axioms in \textit{Ax} are satisfied by the interpretation.
\end{definition}


For two types $\typeA$ and of a metric $\lambda$-theory $\mathscr{T}$ , consider the class \textbf{Values}$(\typeA,\typeB)$ of values $v$ such that $x : \typeA \vljud v : \typeB$. We equip $\textbf{Values}(\typeA,\typeB)$ with the function $a :\textbf{Values}(\typeA,\typeB) \times \textbf{Values}(\typeA,\typeB) \rightarrow \mathbb{R}^{+}_0$ defined by,

$$d(v,w)=\inf{\{q \, \vert \, v=_q w \text{ is a theorem } \mathscr{T} \}}$$


It is easy to see that \textbf{Values}$((\typeA,\typeB),d)$ is a (possibly large)  $\catMet$-enriched category. We then quotient this  $\catMet$-enriched category into a separated  $\catMet$-enriched category which we denote by (\textbf{Values}$(\typeA,\typeB),d)$/$\sim$. We call  $\mathscr{T} $\emph{varietal} if (\textbf{Values}$(\typeA,\typeB),d)$/$\sim$ is a small  $\catMet$-enriched category for all types $\typeA$ and $\typeB$. For the rest of this work, we will focus exclusively on varietal theories and locally small categories.

\begin{theorem} (Completeness)
  Consider a varietal metric $\lambda-theory$. A metric equation
in-context $\Gamma \vljud v =_q w : A$ is a theorem iff it holds in all models of the theory.
\end{theorem}
\begin{proof}
  We use a strategy similar to the proof of Theorem \ref{theorem:comp_eq_in_context} and take advantage of the quotienting of a  $\catMet$-enriched category into a separated  $\catMet$-enriched category. Analogously to Theorem \ref{theorem:comp_eq_in_context} we have a category Syn$(\mathscr{T})$ whose objects are the types of the language and whose hom-sets are the underlying sets of the  $\catMet$-enriched categories (\textbf{Values}$(\typeA,\typeB),d)$/$\sim$.

  We start by showing that the map $\text{Syn}(\mathscr{T})(\typeA,\typeC) \otimes \text{Syn}(\mathscr{T})(\typeB,\typeC) \rightarrow
  \text{Syn}(\mathscr{T})(\typeA \otimes \typeB ,\typeC)$ is a functor in the category of metric spaces:

  \begin{align*}
    & d(([w], [v]), ([w′], [v']))  \\
    & = \sup{\{d([v],[w]),d([v'],[w']) \}}  \\
    & = \sup{\{d(v,w),d(v',w') \}} \\
    & = \sup {\{ \inf{\{q \, \vert \, v=_q v'\}},\inf{\{r \, \vert \, w=_r w'\}}  \}} \\
    & = \inf{\{ \sup \{ q, r \} \vert \, v=_q v', w=_r w' \}} & \{\text{distributive law for lattices}\} \\
    & \geq  \inf{ \{ q  \,\vert \, \text{ case } z \,   \{\text{inl} (x) \Rightarrow v ; \, \text{inr} (y) \Rightarrow w\} =_{q} \text{ case } z \,  \{\text{inl} (x) \Rightarrow v' ; \,\text{inr} (y) \Rightarrow w'\} \} } & \{ A \subseteq  B  \Rightarrow \inf{\{A\}} \geq \inf{\{B\}}  \} \\ 
    & = d(\text{case } z \,   \{\text{inl} (x) \Rightarrow v ; \, \text{inr} (y) \Rightarrow w\}, \text{case } z \,  \{\text{inl} (x) \Rightarrow v' ; \,\text{inr} (y) \Rightarrow w'\}) \\
    & = d([\text{case } z \,   \{\text{inl} (x) \Rightarrow v ; \, \text{inr} (y) \Rightarrow w\}], [\text{case } z \,  \{\text{inl} (x) \Rightarrow v' ; \,\text{inr} (y) \Rightarrow w'\}]) \\
    & = d([[v],[v']],[[w],[w']])  
  \end{align*}

  The next step is to show that if an equation $\Gamma \vljud v =_q v' : \typeA$ with $q \in B$ is satisfied by Syn$(\mathscr{T})$ then it is a theorem of the linear metric $\lambda-theory$. By assumption $d([v],[v']) = d(v,v') =  \inf{ \{r \, \vert \, v =_r v'\}} \leq q$. It follows from the definition of the way-below relation that for all
  $x \in B$ with $x>q$ there exists a finite set $A \subseteq \{r \, \vert \, v =_r v'\}$ such that $x \geq \inf{A}$. Then by an
 application of rule (join) we obtain $v =_{\inf{A}} v'$, and consequently, rule (weak) provides $v =_x v'$ for all $x > q$. Finally, by an application of rule (arch) we deduce that $v =_q v'$ is part of the theory.

  Moreover, let us consider the following diagram:

  \vspace{10pt}

  \begin{tikzpicture}
    \matrix (m) [matrix of math nodes, row sep=4em, column sep=7em, minimum width=2em]
    {
      X \times X  &  X /{\sim} \times X /{\sim}  \\
      Y  \\
    };
    \path[-stealth]
      (m-1-1) edge node [left] {$f$} (m-2-1)
      (m-1-1) edge node [above] {} (m-1-2)
      (m-1-2) edge node [above] {$\hat{f}$} (m-2-1)
      ;
  \end{tikzpicture}


It is necessary to prove that when $\hat{f}$ is defined as $\hat{f}([x],[y]) = [f(x,y)]$, $\hat{f}$ is a well-defined function. This is the case because if $[x] = [x']$ and $[y] = [y']$ then $x =_0 x'$ and $y =_0 y'$, and consequently applying rule  (refl) we obtain that $f(x,y) =_0 f(x',y')$.
\end{proof} 


\section{Examples}

\subsection{Quantum computation}

The category $\catCPTP$ of completely positive trace-preserving maps is a symmetric monoidal category with coproducts enriched over metric spaces \cite{dahlqvist2023syntactic}. The objects are natural numbers $n \geq 1$ and morphisms $n \rightarrow m$ are quantum channels $C^{n \times n} \rightarrow C^{m\times m}$.  An obvious candidate for the interpretation of quantum programs with coproducts is the category obtained by the coproduct cocompletion of $\catCPTP$,  $\catCPTP^{+}$ . In this setting, the $L^{\infty}$-norm arises as the natural metric. 


However, coproducts alone are insufficient to express the measurement operation which maps a density matrix $ \rho \in \mathbb{C}^{2 \times 2}$ to a classical bit $b \in \mathbb{C} \oplus \mathbb{C}$. To properly capture such operations, the category must be equipped with biproducts, which can be constructed via the coproduct cocompletion of $(\catCPTP^{+})^{\cop}$ The dual of such category is denoted $\catCPTP^{\oplus}$. However, coproducts alone are insufficient to express the measurement operation which maps a density matrix $ \rho \in \mathbb{C}^{2 \times 2}$ to a classical bit $b \in \mathbb{C} \oplus \mathbb{C}$. To properly capture such operations, the category must be equipped with biproducts, which can be constructed via the coproduct cocompletion of $(\catCPTP^{+})^{\cop}$ The dual of such category is denoted $\catCPTP^{\oplus}$. Here, we may consider two natural candidates metrics for products: the $L^{\infty}$-norm and the $L^{1}$-norm. These correspond, respectively, to the following metrics: $d(\langle \phi, \psi \rangle, \langle \phi', \psi' \rangle ) = \sup \{ d(\phi, \phi' ), d(\psi, \psi') \}$ and $d(\langle \phi, \psi \rangle, \langle \phi', \psi' \rangle ) = d(\phi, \phi' ) +  d(\psi, \psi') $.

Let us start by verifying if the  $L^{\infty}$-norm is a suitable candidate for making $\catCPTP^{\oplus}$ a $\catMet$-enriched category. For instance, for CTPT maps $\phi_1, \phi_2,  \phi_1', \phi_2', \psi_1, \psi_2$ the following should hold:
\begin{align*}
  d([\psi_1, \psi_2] \cdot \langle \phi_1, \phi_2 \rangle, [\psi_1, \psi_2] \cdot \langle \phi_1', \phi_2' \rangle ) \leq d(\langle \phi_1, \phi_2 \rangle, \langle \phi_1', \phi_2' \rangle )
\end{align*}
Considering $\phi_1=\phi_2$, $\phi_1'=\phi_2'$, $\phi_1 \neq \phi_1'$ and $\psi_1= \psi_2 = \id$, we have
\begin{align*}
  & d([\psi_1, \psi_2] \cdot \langle \phi_1, \phi_2 \rangle, [\psi_1, \psi_2] \cdot \langle \phi_1', \phi_2' \rangle ) \\
  & = d(\psi_1 \cdot \phi_1 + \psi_2 \cdot \phi_2, \psi_1 \cdot \phi_1' + \psi_2 \cdot \phi_2') \\
  & = d(2 \phi_1, 2 \phi_1') 
\end{align*}

Futhermore, if the metric is induced by a norm, $\ie$ $d (\psi_1, \psi_2) = \lVert \psi_1 - \psi_2\lVert$ it follows that

\begin{align*}
  & d(2 \phi_1, 2 \phi_1') \\
  & = \lVert 2 \phi_1 - 2 \phi_1' \lVert \\
  & = 2 \cdot \lVert \phi_1 - \phi_1' \lVert \\
  & = 2 \cdot  d(\phi_1, \phi_1') > d(\phi_1, \phi_1') = \sup \{d(\phi_1, \phi_1'), d(\phi_2, \phi_2')\} = d(\langle \phi_1, \phi_2 \rangle, \langle \phi_1', \phi_2' \rangle )
\end{align*}

Thus, the $L^{\infty}$-norm is not a suitable candidate for making $\catCPTP^{\oplus}$ a $\catMet$-enriched category. Now let us consider the $L^{1}$-norm. For CTPT maps $ \phi, \phi', \phi_1, \phi_2$ the following should hold:
\begin{align*}
  d( \langle \phi_1, \phi_2 \rangle \cdot \phi, \langle \phi_1, \phi_2 \rangle \cdot \phi' ) \leq d(\phi, \phi')
\end{align*}

Considering $\phi_1=\phi_2 = \id$ and $\phi \neq \phi'$, we have
\begin{align*}
  & d( \langle \phi_1, \phi_2 \rangle \cdot \phi, \langle \phi_1, \phi_2 \rangle \cdot \phi' )  \\
  & = d(  \langle \phi_1 \cdot \phi, \phi_2 \cdot \phi \rangle \langle \phi_1 \cdot \phi', \phi_2 \cdot \phi' \rangle ) \\
  & = d(  \langle  \phi, \phi \rangle, \langle  \phi',  \phi' \rangle  )  \\
  & = d(  \phi,  \phi'  ) +  d(  \phi,  \phi'  ) \\
  & = 2 \cdot d(  \phi,  \phi'  ) > d(  \phi,  \phi'  )
\end{align*}

Given that none of the ``natural'' metrics are suitable for making $\catCPTP^{\oplus}$ a $\catMet$-enriched category, we must now consider a metric between the $L^{\infty}$-norm and the $L^{1}$-norm, \ie, $$\sup \{ d(\phi, \phi' ), d(\psi, \psi') \} \leq d(\langle \phi, \psi \rangle, \langle \phi', \psi' \rangle ) \leq d(\phi, \phi' ) +  d(\psi, \psi').$$

In order to verify if this metric is valid,  we must ensure that for CTPT maps $\phi_1, \phi_2,  \phi_1', \phi_2', \psi_1, \psi_2$ the following holds:
\begin{align*}
  d([\psi_1, \psi_2] \cdot \langle \phi_1, \phi_2 \rangle, [\psi_1, \psi_2] \cdot \langle \phi_1', \phi_2' \rangle ) \geq \sup \{ d(\phi, \phi' ), d(\psi, \psi') \}
\end{align*}

Considering $\phi_2=\phi_2'$, $\phi_1 \neq \phi_1'$, $\psi_1= \psi_2 = \id$, and that the metric is induced by a norm, we have
\begin{align*}
  & d([\psi_1, \psi_2] \cdot \langle \phi_1, \phi_2 \rangle, [\psi_1, \psi_2] \cdot \langle \phi_1', \phi_2' \rangle ) \\
  & = d(\psi_1 \cdot \phi_1 + \psi_2 \cdot \phi_2, \psi_1 \cdot \phi_1' + \psi_2 \cdot \phi_2') \\
  & = \lVert \psi_1 (\phi_1- \phi_1' ) \lVert 
\end{align*}
 
For instance, if the norm considered in the trace norm, let $\psi$ be the trace operator and $\phi_1 = \id $ and $\phi_1' = D_p $, where $D_p$ is the dephasing channel. Then, $\phi_1 - \psi_1'$ maps a density operator 
$$\rho=|\alpha|^{2} |0\rangle \langle 0 | + \alpha \beta^{\dag} |0\rangle \langle 1 | + \alpha^{\dag} \beta |1\rangle \langle 0 | + |\beta|^{2} |1\rangle \langle 1 |$$ 
to 
$$ p \cdot (\alpha \beta^{\dag} |0\rangle \langle 1 | + \alpha^{\dag} \beta |1\rangle \langle 0 |) $$. The trace norm of this operator is 
\begin{align*}
  & \left\lVert I - D_p\right\rVert_{1} \\
  & =  \max \limits_{\alpha, \beta} \left\lVert p \cdot  \left(\alpha \beta^{\dag}\ket{0}  \bra{1}+ \alpha^{\dag} \beta \ket{1} \bra{0}\right)\right\rVert_{1} \\
& = p \cdot \max \limits_{\alpha, \beta} \tr \left( \left(|\alpha|^2 |\beta|^2 \ket{0} \bra{0} + |\alpha|^2 |\beta|^2 \ket{1} \bra{1}\right)^{1/2} \right) \\
& =  p \cdot  \max \limits_{|\alpha|, |\beta| } 2 \cdot (|\alpha| |\beta|)  \\
& = p
\end{align*}
%Nota: Qualquer input poder ser escrito como a diferenca de estados puros com coeficientes, neste caso é muito claro que a norma é maximizada quando temos um estado puro.
On the other hand, it is evident that $\left\lVert \tr \left(  I - D_p \right) \right\rVert_{1}  =0$. Therefore, this metric is also not valid. As a result, we must consider a different approach.




\todo[inline]{Explicar melhor o op de Dephasing}

%is the category $\catCPS$ of completely positive trace-preserving short maps 

%\todo{parte 2}
In \cite{selinger04}, Selinger presents the category $\catQ$ as the model of the language QPL.  

\begin{definition}
  The category $\catQ$ is defined as the the finite biproduct completion of $\catCPS$ (which extends $\catCPTP$ to include trace-nonincreasing (or short) maps),  further restricted to trace-nonincreasing morphisms. Let  $\mathcal{M}_n$ denote the set of complex $n\times n$ matrices.
  \begin{itemize}
    \item An object is a signature $\sigma= n_1, \ldots, n_s$. We denote these signatures by the Greek letters $\sigma, \tau$ and $\mu$.
    \item A morphism $\phi \in \mathcal{M}_{\sigma \otimes \tau} $ is a matrix
    $$\begin{pmatrix}
      \phi_{11} & \ldots & \phi_{1t}, \\
      \vdots & \ddots  & \vdots \\
      \phi_{s1} & \ldots & \phi_{st} \\
    \end{pmatrix}$$
    of arrows $\phi_{ij}: \mathcal{M}_{n_i} \rightarrow \mathcal{M}_{m_j}$ in $\catCPS$ which is trace-nonincreasing, \ie, meaning that for every fixed index $i$, the following condition holds:
    $$ \sum_j \tr \left(\phi_{ij} (A_i)\right)   \leq \tr \left(A_i\right) .$$
    More concretely, $ij$-component of $\phi$ is given by the function $\phi_{ij} = \pi_{j} \comp \phi \comp \mathrm{in}_{i} : \mathcal{M}_{n_i} \rightarrow \mathcal{M}_{n_j} $, where $\mathrm{in}_{i}$ is the injection of  $\mathcal{M}_{n_i}$ into the input space of $\phi$ and  $\pi_{j}$ is the projection onto the $j$-th component.
  \end{itemize}
\end{definition}


 Trace-non increasing (or short) maps are used here instead of strictly trace-preserving maps to account for possible non-termination in programs, particularly since the language  QPL includes while loops.


Here, the concepts of trace and adjoints are extended to tuples of matrices $A=(A_1, \ldots, A_n) \in \mathcal{M}_{\sigma}$ as follows:
\begin{align*}
  &\tr(A) = \sum_{i} \tr(A_{i}) \\
  &(A)^{\dagger} = (A_{1}^{\dagger}, \ldots, A_{n}^{\dagger}) 
\end{align*}
Moreover, a matrix tuple $A \in \mathcal{M}_{\sigma} $ is said to be \emph{hermitian} (respectively, \emph{positive}) if each $A_i$ is hermitian
(respectively, positive) for all $i$. 



\begin{definition} \emph{Completely Positive Superoperator}
An operator between spaces of tuples of matrices $\phi :\mathcal{M}_{\sigma} \rightarrow \mathcal{M}_{\tau}$ is called a superoperator.  Let $\phi :\mathcal{M}_{\sigma} \rightarrow \mathcal{M}_{\tau}$ be a superoperator, $\phi$ is said to be \emph{positive}, if $\phi(A)$ is positive for all positive $A \in \mathcal{M}_{\sigma}$. $\phi$ is called completely positive if $ \phi \otimes id_{\mu}$ is positive for all signatures $\mu$.
\end{definition}

\begin{definition} \emph{Tensor Product }
  For signatures $\sigma = n_1, \ldots, n_s $ and $\tau= m_1, \ldots, m_t $, the tensor product of $\sigma$ and $\tau$ is defined as $\sigma \otimes \tau = n_1 m_1, \ldots ,n_1 m_t, \ldots, n_s m_1,...,n_s m_t$. 
  The morphism part of the tensor product follows the definition in the category of vector spaces. If $\phi: \sigma \rightarrow \tau$ and $\psi: \sigma' \rightarrow  \tau'$, then their tensor product $\psi \otimes \phi: \sigma \otimes \sigma' \rightarrow  \tau \otimes \tau' $ is defined on a basis element $A \otimes B$ by  
$$
(\phi \otimes \psi)(A \otimes B) = F(A) \otimes G(B),
$$
and extends to arbitrary elements by linearity.
\end{definition}

\begin{definition} \label{def:biproduct} \emph{Product and Coproduct}
  The biproduct is given by the direct sum $\oplus$. Consequently, $\sigma \oplus \sigma'$ represents the concatenation of signatures. The co-pairing map $[\phi, \psi]: \sigma \oplus \sigma' \to \tau$ is defined as  $[\phi, \psi](A, B) = \phi(A) + \psi(B)$, and the pairing map $\langle \phi, \psi \rangle: \sigma \to \tau \oplus \tau'$ is given by  $\langle \phi, \psi \rangle(A) = (\phi(A), \psi(A))$.
\end{definition}

The category $\catQ$ is a distributive symmetric monoidal category with (finite) biproducts. Now, we must prove that $\catQ$ is a $\catMet$-enriched category. For tuples of matrices $A = (A_1, \ldots, A_n) \in \mathcal{M}_{\sigma}$, we consider the $L^{1}$-norm, $\lVert A \lVert_{L^1} = \sum_i \lVert A_i \lVert_{V_i}$, where $\lVert \cdot \lVert_{1}$ is the trace norm. For tuples of tuples of matrices (which serve as inputs to the co-pairing map), we extend this norm recursively.

\begin{definition} \label{def:gen_1norm_prod} 
  Let $\phi \in \mathcal{M}_{n} \rightarrow \mathcal{M}_{\sigma}$ be a superoperator. The norm of $\phi$ is defined as
  $$\lVert \phi \lVert_{L^{1}} = \sup \left\{ \lVert \phi(A) \lVert_{L^1} \, \vert \, \lVert A \lVert_{1} = 1 \right\}.$$
\end{definition}

\begin{definition} 
  Let $\phi \in \mathcal{M}_{\sigma} \rightarrow \mathcal{M}_{n}$ be a superoperator. The norm of $\phi$ is defined as
  $$\lVert \phi \lVert_{L^{\infty}} = \sup \left\{ \lVert \phi_{11} \lVert_{1}, \ldots,  \lVert \phi_{1s} \lVert_{1} \right\}.$$
\end{definition}

\begin{definition}  \label{def:gen_1norm}  \emph{(Generalized) Trace norm of superoperators}
  Let $\phi \in \mathcal{M}_{\sigma}\rightarrow \mathcal{M}_{\tau}$ be a superoperator, where $\sigma =(n_1, \ldots, n_s)$ and $\tau =(m_1, \ldots, m_t)$.  Defining  $\phi_i= (\phi_{i1}, \ldots, \phi_{it})$ for $i \in \sigma$, the norm of $\phi$ is defined as
  $$\lVert \phi \lVert_{L^{\infty}} = \sup \left\{ \lVert \phi_1 \lVert_{L^{1}}, \ldots,  \lVert \phi_n \lVert_{L^{1}}  \right\}.$$
\end{definition}

\begin{definition} \label{def:gen_diamond_norm} \emph{(Generalized) Diamond norm of superoperators}
  The diamond norm of a superoperator $\phi: \sigma \rightarrow \mu$ is defined as
  $$\gendiamondnorm{\phi} = \lVert \phi \otimes \id_{\sigma}\lVert_{L^{\infty}}$$
\end{definition}

 
 We define the metric $d$ on on the hom-set $Q(\sigma,\tau)$ as follows
$$d(\phi,\psi) = \gendiamondnorm{\phi-\psi}.$$

\todo[inline]{Não se usa a igualdade entre as normas para nada, se calhar estar provas deveriam sair}

\begin{lemma} \label{lem_op_max_trace}
  Let $\phi \in \catQ(\sigma,\mu)  $ and $\psi \in \catQ(\tau,\mu) $ be superoperators. Then, it holds that 
  $$ \opnorm{[\phi, \psi]} = \gentracenorm{[\phi, \psi]}.$$
\end{lemma}

\begin{proof}

Considering $\sigma = n_1, \ldots, n_s$, $\tau = m_1, \ldots, m_t$, $\mu = o_1, \ldots, o_r$, we define $\phi_i= (\phi_{i1}, \ldots, \phi_{ir})$ for $i \in 1, \ldots, s$ and  $\psi_i= (\psi_{i1}, \ldots, \psi_{ir})$ for $i \in 1, \ldots, t$.

We start by proving the inequality $\opnorm{[\phi, \psi]} \leq \gentracenorm{[\phi, \psi]}$.


Attending to definitions \autoref{def:gen_1norm} and \autoref{def:gen_1norm_prod}, we have that,
\begin{align*} 
  & \opnorm{[\phi, \psi]} \leq \gentracenorm{[\phi, \psi]} \\
  &\Leftrightarrow \text{sup}{\{ \lVert [\phi, \psi] (A) \rVert_{L_1}  \hspace{2pt} |  \hspace{2pt}  \lVert A \rVert_{L^1} = 1  \}}  \leq \sup_{i,j} \{ \lonenorm{\phi_{i}},  \lonenorm{\psi_{j}}\} \\
  &\Leftrightarrow \text{sup}{\{ \lVert [\phi, \psi] (A_1, A_2 ) \rVert_{L_1}   \hspace{2pt} |  \hspace{2pt}  \lVert (A_1, A_2 )\rVert_{L^1} = 1  \}}   \\
  & \leq \sup_{i,j} \left\{  \text{sup} \left\{  \lVert \phi_{i} (A) \rVert_{L^1}  \, \vert \,  \lVert A \rVert = 1 \right\}, \text{sup} \left\{ \lVert \phi_{j} (B) \rVert_{L^1}  \, \vert \,  \lVert B \rVert = 1 \right\} \right\} \\
  & \Leftrightarrow \sup {\left\{ \left\lVert \sum_{i,j}\phi_{i} (A_{1i})  + \psi_{j}(A_{1j})  \right\rVert_{L^{1}}  \hspace{2pt} \Biggm|  \hspace{2pt}  \sum_{i,j} \lVert A_{1i} \rVert+ \lVert A_{1j} \rVert=1 \right\}}  \\ 
  & \leq \sup_{i,j} \left\{  \sup \left\{  \lVert \phi_{i} (A_i) \rVert_{L^1},   \lVert \phi_{j} (B_j) \rVert_{L^1}  \, \vert \, \lVert A_i \rVert= 1 ,  \lVert B_j \rVert = 1 \right\} \right\} \\
\end{align*}

By the triangle inequality, proving the inequality bellow suffices to establish the inequality at hand.
\begin{align*}
  &\text{sup}{\left\{ \sum_{i,j} \left\lVert \phi_{i} (A_{1i})  \right\rVert_{L^1} +\left\lVert  \psi_{j}(A_{1j})  \right\rVert_{L^1}   \hspace{2pt} \Biggm|  \hspace{2pt}  \sum_{i,j} \lVert A_{1i} \rVert+ \lVert A_{1j} \rVert=1 \right\}} \\
  &  \sup_{i,j} \left\{  \lVert \phi_{i} (A) \rVert_{L^1},   \lVert \phi_{j} (B) \rVert_{L^1}  \, \vert \, \lVert A_i \rVert= 1 ,  \lVert B_j \rVert = 1 \right\} \\
\end{align*}


Considering $A_{11}, \ldots, A_{1s}, A_{21}, \ldots, A_{2t} $ as the matrices that maximize the left-hand side of the inequality, the inequality above can be rewritten as:

\begin{align*}
  & \sum_{i,j} \left\lVert \phi_{i} (A_{1i})  \right\rVert_{L^1} \leq  \sup_{i,j} \left\{  \lVert \phi_{i} (A_{1i} / \lVert A_{1i} \rVert ) \rVert_{L^1},   \lVert \phi_{i} (A_{2j} / \lVert A_{2j} \rVert ) \rVert_{L^1}  \right\}  \wedge \sum_{i,j} \lVert A_{1i} \rVert+ \lVert A_{1j} \rVert=1 
\end{align*}


Given that the norm is continuos and compact, we can use the maximum instead of the supremum. As a result, proving the inequality above is equivalent to demonstrating that for all $a_1, \ldots, a_n, x_1, \ldots, x_n \in \mathbb{R}^{+}_{0}$ with $a_1+ \ldots + a_n=1$,
\begin{align*}
    x_1 + \ldots + x_n  \leq  \max \left\{   \dfrac{1}{a_1} x_1  , \ldots , \dfrac{1}{a_n} x_n   \right\} \\
\end{align*}

Designating $M = \max \left\{   \dfrac{1}{a_1} x_1  , \ldots , \dfrac{1}{a_n} x_n   \right\}$, from the definition of maximum it follows that, for all $1 \leq i \leq n$, $x_i \leq M \cdot a_i$, and consequently, $x_1 + \ldots + x_n \leq M \cdot (a_1 + \ldots + a_n) = M$. Therefore, it holds that:
\begin{align*}
  \opnorm{[\phi, \psi]} \leq \gentracenorm{[\phi, \psi]}
\end{align*} 

It remains to prove the reverse inequality. he validity of this inequality follows from the observation that
\begin{align*}
  &\left\{  \lVert \phi_{i} (A) \rVert_{L^1},   \lVert \phi_{j} (B) \rVert_{L^1}  \, \vert \, \lVert A_i \rVert= 1 ,  \lVert B_j \rVert = 1 \right\}  \subseteq\\
& {\left\{ \left\lVert \sum_{i,j} (\phi_{i} (A_{1i})  + \psi_{j}(A_{1j}))  \right\rVert_{L^{1}}  \hspace{2pt} \Biggm|  \hspace{2pt}  \sum_{i,j} \lVert A_{1i} \rVert+ \lVert A_{1j} \rVert=1 \right\}},
\end{align*}
This inclusion holds because the first set considers only the special case where one component of the sum has an input with norm equal to one, while the inputs of the remaining components have zero norm, which means meaning they act as null superoperators. Consequently,
\begin{align*}
  & \sup_{i,j} \left\{  \lVert \phi_{i} (A) \rVert_{L^1},   \lVert \phi_{j} (B) \rVert_{L^1}  \, \vert \, \lVert A_i \rVert= 1 ,  \lVert B_j \rVert = 1 \right\}  \leq\\
& \sup {\left\{ \left\lVert \sum_{i,j} (\phi_{i} (A_{1i})  + \psi_{j}(A_{1j}))  \right\rVert_{L^{1}}  \hspace{2pt} \Biggm|  \hspace{2pt}  \sum_{i,j} \lVert A_{1i} \rVert+ \lVert A_{1j} \rVert=1 \right\}},
\end{align*}
and the equality is proven.

\end{proof}

\begin{lemma} \label{lem_op_max_diamond}
  Let $\phi \in \catQ(\sigma,\mu)  $ and $\psi \in \catQ(\tau,\mu) $ be superoperators. Then, it holds that 
  $$ \gendiamondnorm{[\phi, \psi]} = \gendiamondnorm{[\phi, \psi]}.$$
\end{lemma}

\begin{proof}
  This equality follows from Lemma \ref{lem_op_max_trace} and the fact that the isomorphism $\dist$ is the identity in $\catQ$.
\end{proof}


\begin{proposition} \label{prop:met_cond}
  For all $\phi, \phi' \in \catQ(\sigma,\mu)  $ and $\psi, \psi' \in \catQ(\tau,\mu) $, $[\phi,\psi]:\catQ(\sigma,\mu)  \otimes \catQ(\tau,\mu) \rightarrow \catQ(\sigma \oplus \tau,\mu) $ is a functor in the category of metric spaces.
\end{proposition}



\begin{proof}
  We deduce by unfolding the respective definitions that we need to prove that for all short operators $\phi, \phi' \in \catQ(\sigma,\mu)  $ and $\psi, \psi' \in \catQ(\tau,\mu) $ the inequation $\gendiamondnorm{[\phi, \psi] - [\phi', \psi']} \leq  \sup \left\{ \gendiamondnorm{\phi-\phi'}, \gendiamondnorm{\psi-\psi'} \right\}$ holds.


    \begin{align*}
      & \gendiamondnorm{[\phi, \psi]} \\
      &= \gentracenorm{[\phi, \psi] \otimes \id_{\sigma\oplus\tau}} \\
      &= \gentracenorm{[\phi \otimes \id_\sigma, \psi \otimes \id_\tau]}& (\dist=\id) \\
      & =  \sup_{i,j} \left\{ \text{sup} \left\{  \lVert \phi_{i} \otimes \id_\sigma \, (A) \rVert_{L^1}  \, \vert \,  \lVert A \rVert_1 = 1 \right\}, \text{sup} \left\{ \lVert \phi_{j} \otimes \id_\tau \, (B) \rVert_{L^1}  \, \vert \,  \lVert B \rVert_1 = 1 \right\} \right\} \\
      & = \sup \left\{ \sup_{i} \left\{ \text{sup} \left\{  \lVert \phi_{i} \otimes \id_\sigma \, (A) \rVert_{L^1}  \, \vert \,  \lVert A \rVert_1 = 1 \right\} \right\} , \sup_{j} \left\{\text{sup} \left\{ \lVert \phi_{j} \otimes \id_\tau \, (B) \rVert_{L^1}  \, \vert \,  \lVert B \rVert_1 = 1 \right\} \right\} \right\} \\
      & =  \sup \left\{ \gentracenorm{\phi \otimes \id_{\sigma}}, \gentracenorm{\phi \otimes \id_{\tau}}\right\} \\
      & = \left\{ \gendiamondnorm{\phi}, \gendiamondnorm{\psi} \right\}
    \end{align*}

% The supremum of a set with two elements is always the maximum
  
The inequality in Proposition \ref{prop:met_cond} follows from the linearity of the co-pairing map.
\end{proof}


\begin{proposition} \label{prop:uv*}
  For all super-operators $\psi: \sigma \to \tau$, it holds that:
  \begin{align*}
    \gentracenorm{\phi} & =  \sup  \left\{ \sup_{i} \left\{ \sum_{j=1} \|\phi_{ij} (v_i w_i^\dag)\|_{1}  \mid  \|v_i|_{2} = 1,   \|w_i\|_{2} =1 \right\} \right\}
  \end{align*}
\end{proposition}

\begin{proof}
  The argument for this equality is similar to the one presented in \cite[Proof of Proposition 3.38]{watrous2018theory}.
  

  Every square matrix $A \in \mathbb{C}^{n \times n}$ that satisfies $ \tracenorm{A} \leq 1$ can be expressed as a convex combination of operators of the form  $uv*$ where $u,v  \in \mathbb{C}^{n \times n}$ are unit vectors. Consequently by  triangle inequality, one has that,

  \begin{align*}
    &\gentracenorm{\phi}\\
    & ...
  \end{align*}


\end{proof}



\newpage
\bibliographystyle{alpha} 
\bibliography{biblio}
\end{document}
